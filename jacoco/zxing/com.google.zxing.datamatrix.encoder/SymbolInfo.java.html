<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SymbolInfo.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">core$All_in_core.exec</a> &gt; <a href="index.source.html" class="el_package">com.google.zxing.datamatrix.encoder</a> &gt; <span class="el_source">SymbolInfo.java</span></div><h1>SymbolInfo.java</h1><pre class="source lang-java linenums">/*
 * Copyright 2006 Jeremias Maerki
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.google.zxing.datamatrix.encoder;

import com.google.zxing.Dimension;

/**
 * Symbol info table for DataMatrix.
 *
 * @version $Id$
 */
public class SymbolInfo {

<span class="fc" id="L28">  static final SymbolInfo[] PROD_SYMBOLS = {</span>
    new SymbolInfo(false, 3, 5, 8, 8, 1),
    new SymbolInfo(false, 5, 7, 10, 10, 1),
      /*rect*/new SymbolInfo(true, 5, 7, 16, 6, 1),
    new SymbolInfo(false, 8, 10, 12, 12, 1),
      /*rect*/new SymbolInfo(true, 10, 11, 14, 6, 2),
    new SymbolInfo(false, 12, 12, 14, 14, 1),
      /*rect*/new SymbolInfo(true, 16, 14, 24, 10, 1),

    new SymbolInfo(false, 18, 14, 16, 16, 1),
    new SymbolInfo(false, 22, 18, 18, 18, 1),
      /*rect*/new SymbolInfo(true, 22, 18, 16, 10, 2),
    new SymbolInfo(false, 30, 20, 20, 20, 1),
      /*rect*/new SymbolInfo(true, 32, 24, 16, 14, 2),
    new SymbolInfo(false, 36, 24, 22, 22, 1),
    new SymbolInfo(false, 44, 28, 24, 24, 1),
      /*rect*/new SymbolInfo(true, 49, 28, 22, 14, 2),

    new SymbolInfo(false, 62, 36, 14, 14, 4),
    new SymbolInfo(false, 86, 42, 16, 16, 4),
    new SymbolInfo(false, 114, 48, 18, 18, 4),
    new SymbolInfo(false, 144, 56, 20, 20, 4),
    new SymbolInfo(false, 174, 68, 22, 22, 4),

    new SymbolInfo(false, 204, 84, 24, 24, 4, 102, 42),
    new SymbolInfo(false, 280, 112, 14, 14, 16, 140, 56),
    new SymbolInfo(false, 368, 144, 16, 16, 16, 92, 36),
    new SymbolInfo(false, 456, 192, 18, 18, 16, 114, 48),
    new SymbolInfo(false, 576, 224, 20, 20, 16, 144, 56),
    new SymbolInfo(false, 696, 272, 22, 22, 16, 174, 68),
    new SymbolInfo(false, 816, 336, 24, 24, 16, 136, 56),
    new SymbolInfo(false, 1050, 408, 18, 18, 36, 175, 68),
    new SymbolInfo(false, 1304, 496, 20, 20, 36, 163, 62),
    new DataMatrixSymbolInfo144(),
  };

<span class="fc" id="L64">  private static SymbolInfo[] symbols = PROD_SYMBOLS;</span>

  private final boolean rectangular;
  private final int dataCapacity;
  private final int errorCodewords;
  public final int matrixWidth;
  public final int matrixHeight;
  private final int dataRegions;
  private final int rsBlockData;
  private final int rsBlockError;

  /**
   * Overrides the symbol info set used by this class. Used for testing purposes.
   *
   * @param override the symbol info set to use
   */
  public static void overrideSymbolSet(SymbolInfo[] override) {
<span class="fc" id="L81">    symbols = override;</span>
<span class="fc" id="L82">  }</span>

  public SymbolInfo(boolean rectangular, int dataCapacity, int errorCodewords,
                    int matrixWidth, int matrixHeight, int dataRegions) {
<span class="fc" id="L86">    this(rectangular, dataCapacity, errorCodewords, matrixWidth, matrixHeight, dataRegions,</span>
         dataCapacity, errorCodewords);
<span class="fc" id="L88">  }</span>

  SymbolInfo(boolean rectangular, int dataCapacity, int errorCodewords,
             int matrixWidth, int matrixHeight, int dataRegions,
<span class="fc" id="L92">             int rsBlockData, int rsBlockError) {</span>
<span class="fc" id="L93">    this.rectangular = rectangular;</span>
<span class="fc" id="L94">    this.dataCapacity = dataCapacity;</span>
<span class="fc" id="L95">    this.errorCodewords = errorCodewords;</span>
<span class="fc" id="L96">    this.matrixWidth = matrixWidth;</span>
<span class="fc" id="L97">    this.matrixHeight = matrixHeight;</span>
<span class="fc" id="L98">    this.dataRegions = dataRegions;</span>
<span class="fc" id="L99">    this.rsBlockData = rsBlockData;</span>
<span class="fc" id="L100">    this.rsBlockError = rsBlockError;</span>
<span class="fc" id="L101">  }</span>

  public static SymbolInfo lookup(int dataCodewords) {
<span class="fc" id="L104">    return lookup(dataCodewords, SymbolShapeHint.FORCE_NONE, true);</span>
  }

  public static SymbolInfo lookup(int dataCodewords, SymbolShapeHint shape) {
<span class="fc" id="L108">    return lookup(dataCodewords, shape, true);</span>
  }

  public static SymbolInfo lookup(int dataCodewords, boolean allowRectangular, boolean fail) {
<span class="nc bnc" id="L112" title="All 2 branches missed.">    SymbolShapeHint shape = allowRectangular</span>
        ? SymbolShapeHint.FORCE_NONE : SymbolShapeHint.FORCE_SQUARE;
<span class="nc" id="L114">    return lookup(dataCodewords, shape, fail);</span>
  }

  private static SymbolInfo lookup(int dataCodewords, SymbolShapeHint shape, boolean fail) {
<span class="fc" id="L118">    return lookup(dataCodewords, shape, null, null, fail);</span>
  }

  public static SymbolInfo lookup(int dataCodewords,
                                  SymbolShapeHint shape,
                                  Dimension minSize,
                                  Dimension maxSize,
                                  boolean fail) {
<span class="fc bfc" id="L126" title="All 2 branches covered.">    for (SymbolInfo symbol : symbols) {</span>
<span class="fc bfc" id="L127" title="All 4 branches covered.">      if (shape == SymbolShapeHint.FORCE_SQUARE &amp;&amp; symbol.rectangular) {</span>
<span class="fc" id="L128">        continue;</span>
      }
<span class="fc bfc" id="L130" title="All 4 branches covered.">      if (shape == SymbolShapeHint.FORCE_RECTANGLE &amp;&amp; !symbol.rectangular) {</span>
<span class="fc" id="L131">        continue;</span>
      }
<span class="fc bfc" id="L133" title="All 2 branches covered.">      if (minSize != null</span>
<span class="fc bfc" id="L134" title="All 2 branches covered.">          &amp;&amp; (symbol.getSymbolWidth() &lt; minSize.getWidth()</span>
<span class="fc bfc" id="L135" title="All 2 branches covered.">          || symbol.getSymbolHeight() &lt; minSize.getHeight())) {</span>
<span class="fc" id="L136">        continue;</span>
      }
<span class="fc bfc" id="L138" title="All 2 branches covered.">      if (maxSize != null</span>
<span class="fc bfc" id="L139" title="All 2 branches covered.">          &amp;&amp; (symbol.getSymbolWidth() &gt; maxSize.getWidth()</span>
<span class="pc bpc" id="L140" title="1 of 2 branches missed.">          || symbol.getSymbolHeight() &gt; maxSize.getHeight())) {</span>
<span class="nc" id="L141">        continue;</span>
      }
<span class="fc bfc" id="L143" title="All 2 branches covered.">      if (dataCodewords &lt;= symbol.dataCapacity) {</span>
<span class="fc" id="L144">        return symbol;</span>
      }
    }
<span class="fc bfc" id="L147" title="All 2 branches covered.">    if (fail) {</span>
<span class="fc" id="L148">      throw new IllegalArgumentException(</span>
          &quot;Can't find a symbol arrangement that matches the message. Data codewords: &quot;
              + dataCodewords);
    }
<span class="fc" id="L152">    return null;</span>
  }

  private int getHorizontalDataRegions() {
<span class="pc bpc" id="L156" title="1 of 5 branches missed.">    switch (dataRegions) {</span>
      case 1:
<span class="fc" id="L158">        return 1;</span>
      case 2:
      case 4:
<span class="fc" id="L161">        return 2;</span>
      case 16:
<span class="fc" id="L163">        return 4;</span>
      case 36:
<span class="fc" id="L165">        return 6;</span>
      default:
<span class="nc" id="L167">        throw new IllegalStateException(&quot;Cannot handle this number of data regions&quot;);</span>
    }
  }

  private int getVerticalDataRegions() {
<span class="pc bpc" id="L172" title="1 of 5 branches missed.">    switch (dataRegions) {</span>
      case 1:
      case 2:
<span class="fc" id="L175">        return 1;</span>
      case 4:
<span class="fc" id="L177">        return 2;</span>
      case 16:
<span class="fc" id="L179">        return 4;</span>
      case 36:
<span class="fc" id="L181">        return 6;</span>
      default:
<span class="nc" id="L183">        throw new IllegalStateException(&quot;Cannot handle this number of data regions&quot;);</span>
    }
  }

  public final int getSymbolDataWidth() {
<span class="fc" id="L188">    return getHorizontalDataRegions() * matrixWidth;</span>
  }

  public final int getSymbolDataHeight() {
<span class="fc" id="L192">    return getVerticalDataRegions() * matrixHeight;</span>
  }

  public final int getSymbolWidth() {
<span class="fc" id="L196">    return getSymbolDataWidth() + (getHorizontalDataRegions() * 2);</span>
  }

  public final int getSymbolHeight() {
<span class="fc" id="L200">    return getSymbolDataHeight() + (getVerticalDataRegions() * 2);</span>
  }

  public int getCodewordCount() {
<span class="nc" id="L204">    return dataCapacity + errorCodewords;</span>
  }

  public int getInterleavedBlockCount() {
<span class="fc" id="L208">    return dataCapacity / rsBlockData;</span>
  }

  public final int getDataCapacity() {
<span class="fc" id="L212">    return dataCapacity;</span>
  }

  public final int getErrorCodewords() {
<span class="fc" id="L216">    return errorCodewords;</span>
  }

  public int getDataLengthForInterleavedBlock(int index) {
<span class="nc" id="L220">    return rsBlockData;</span>
  }

  public final int getErrorLengthForInterleavedBlock(int index) {
<span class="nc" id="L224">    return rsBlockError;</span>
  }

  @Override
  public final String toString() {
<span class="nc bnc" id="L229" title="All 2 branches missed.">    return (rectangular ? &quot;Rectangular Symbol:&quot; : &quot;Square Symbol:&quot;) +</span>
        &quot; data region &quot; + matrixWidth + 'x' + matrixHeight +
<span class="nc" id="L231">        &quot;, symbol size &quot; + getSymbolWidth() + 'x' + getSymbolHeight() +</span>
<span class="nc" id="L232">        &quot;, symbol data size &quot; + getSymbolDataWidth() + 'x' + getSymbolDataHeight() +</span>
        &quot;, codewords &quot; + dataCapacity + '+' + errorCodewords;
  }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>