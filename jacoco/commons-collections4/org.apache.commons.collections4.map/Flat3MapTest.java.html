<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Flat3MapTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_collections4$All_in_commons_collections4.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.collections4.map</a> &gt; <span class="el_source">Flat3MapTest.java</span></div><h1>Flat3MapTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.collections4.map;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.HashMap;
import java.util.Iterator;
import java.util.Map;

import junit.framework.Test;

import org.apache.commons.collections4.BulkTest;
import org.apache.commons.collections4.IterableMap;
import org.apache.commons.collections4.MapIterator;
import org.apache.commons.collections4.iterators.AbstractMapIteratorTest;

/**
 * JUnit tests.
 *
 */
public class Flat3MapTest&lt;K, V&gt; extends AbstractIterableMapTest&lt;K, V&gt; {

<span class="fc" id="L40">    private static final Integer ONE = Integer.valueOf(1);</span>
<span class="fc" id="L41">    private static final Integer TWO = Integer.valueOf(2);</span>
<span class="fc" id="L42">    private static final Integer THREE = Integer.valueOf(3);</span>
    private static final String TEN = &quot;10&quot;;
    private static final String TWENTY = &quot;20&quot;;
    private static final String THIRTY = &quot;30&quot;;

    public Flat3MapTest(final String testName) {
<span class="fc" id="L48">        super(testName);</span>
<span class="fc" id="L49">    }</span>

    public static Test suite() {
<span class="fc" id="L52">        return BulkTest.makeSuite(Flat3MapTest.class);</span>
    }

    @Override
    public Flat3Map&lt;K, V&gt; makeObject() {
<span class="fc" id="L57">        return new Flat3Map&lt;&gt;();</span>
    }

    //-----------------------------------------------------------------------
    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEquals1() {
<span class="fc" id="L63">        final Flat3Map&lt;K, V&gt; map1 = makeObject();</span>
<span class="fc" id="L64">        map1.put((K) &quot;a&quot;, (V) &quot;testA&quot;);</span>
<span class="fc" id="L65">        map1.put((K) &quot;b&quot;, (V) &quot;testB&quot;);</span>
<span class="fc" id="L66">        final Flat3Map&lt;K, V&gt; map2 = makeObject();</span>
<span class="fc" id="L67">        map2.put((K) &quot;a&quot;, (V) &quot;testB&quot;);</span>
<span class="fc" id="L68">        map2.put((K) &quot;b&quot;, (V) &quot;testA&quot;);</span>
<span class="fc" id="L69">        assertEquals(false, map1.equals(map2));</span>
<span class="fc" id="L70">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEquals2() {
<span class="fc" id="L74">        final Flat3Map&lt;K, V&gt; map1 = makeObject();</span>
<span class="fc" id="L75">        map1.put((K) &quot;a&quot;, (V) &quot;testA&quot;);</span>
<span class="fc" id="L76">        map1.put((K) &quot;b&quot;, (V) &quot;testB&quot;);</span>
<span class="fc" id="L77">        final Flat3Map&lt;K, V&gt; map2 = makeObject();</span>
<span class="fc" id="L78">        map2.put((K) &quot;a&quot;, (V) &quot;testB&quot;);</span>
<span class="fc" id="L79">        map2.put((K) &quot;c&quot;, (V) &quot;testA&quot;);</span>
<span class="fc" id="L80">        assertEquals(false, map1.equals(map2));</span>
<span class="fc" id="L81">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testClone2() {
<span class="fc" id="L85">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L86">        assertEquals(0, map.size());</span>
<span class="fc" id="L87">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L88">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L89">        assertEquals(2, map.size());</span>
<span class="fc" id="L90">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L91">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L92">        assertSame(TEN, map.get(ONE));</span>
<span class="fc" id="L93">        assertSame(TWENTY, map.get(TWO));</span>

        // clone works (size = 2)
<span class="fc" id="L96">        final Flat3Map&lt;K, V&gt; cloned = map.clone();</span>
<span class="fc" id="L97">        assertEquals(2, cloned.size());</span>
<span class="fc" id="L98">        assertEquals(true, cloned.containsKey(ONE));</span>
<span class="fc" id="L99">        assertEquals(true, cloned.containsKey(TWO));</span>
<span class="fc" id="L100">        assertSame(TEN, cloned.get(ONE));</span>
<span class="fc" id="L101">        assertSame(TWENTY, cloned.get(TWO));</span>

        // change original doesn't change clone
<span class="fc" id="L104">        map.put((K) TEN, (V) ONE);</span>
<span class="fc" id="L105">        map.put((K) TWENTY, (V) TWO);</span>
<span class="fc" id="L106">        assertEquals(4, map.size());</span>
<span class="fc" id="L107">        assertEquals(2, cloned.size());</span>
<span class="fc" id="L108">        assertEquals(true, cloned.containsKey(ONE));</span>
<span class="fc" id="L109">        assertEquals(true, cloned.containsKey(TWO));</span>
<span class="fc" id="L110">        assertSame(TEN, cloned.get(ONE));</span>
<span class="fc" id="L111">        assertSame(TWENTY, cloned.get(TWO));</span>
<span class="fc" id="L112">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testClone4() {
<span class="fc" id="L116">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L117">        assertEquals(0, map.size());</span>
<span class="fc" id="L118">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L119">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L120">        map.put((K) TEN, (V) ONE);</span>
<span class="fc" id="L121">        map.put((K) TWENTY, (V) TWO);</span>

        // clone works (size = 4)
<span class="fc" id="L124">        final Flat3Map&lt;K, V&gt; cloned = map.clone();</span>
<span class="fc" id="L125">        assertEquals(4, map.size());</span>
<span class="fc" id="L126">        assertEquals(4, cloned.size());</span>
<span class="fc" id="L127">        assertEquals(true, cloned.containsKey(ONE));</span>
<span class="fc" id="L128">        assertEquals(true, cloned.containsKey(TWO));</span>
<span class="fc" id="L129">        assertEquals(true, cloned.containsKey(TEN));</span>
<span class="fc" id="L130">        assertEquals(true, cloned.containsKey(TWENTY));</span>
<span class="fc" id="L131">        assertSame(TEN, cloned.get(ONE));</span>
<span class="fc" id="L132">        assertSame(TWENTY, cloned.get(TWO));</span>
<span class="fc" id="L133">        assertSame(ONE, cloned.get(TEN));</span>
<span class="fc" id="L134">        assertSame(TWO, cloned.get(TWENTY));</span>

        // change original doesn't change clone
<span class="fc" id="L137">        map.clear();</span>
<span class="fc" id="L138">        assertEquals(0, map.size());</span>
<span class="fc" id="L139">        assertEquals(4, cloned.size());</span>
<span class="fc" id="L140">        assertEquals(true, cloned.containsKey(ONE));</span>
<span class="fc" id="L141">        assertEquals(true, cloned.containsKey(TWO));</span>
<span class="fc" id="L142">        assertEquals(true, cloned.containsKey(TEN));</span>
<span class="fc" id="L143">        assertEquals(true, cloned.containsKey(TWENTY));</span>
<span class="fc" id="L144">        assertSame(TEN, cloned.get(ONE));</span>
<span class="fc" id="L145">        assertSame(TWENTY, cloned.get(TWO));</span>
<span class="fc" id="L146">        assertSame(ONE, cloned.get(TEN));</span>
<span class="fc" id="L147">        assertSame(TWO, cloned.get(TWENTY));</span>
<span class="fc" id="L148">    }</span>

    public void testSerialisation0() throws Exception {
<span class="fc" id="L151">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L152">        final ByteArrayOutputStream bout = new ByteArrayOutputStream();</span>
<span class="fc" id="L153">        final ObjectOutputStream out = new ObjectOutputStream(bout);</span>
<span class="fc" id="L154">        out.writeObject(map);</span>
<span class="fc" id="L155">        final byte[] bytes = bout.toByteArray();</span>
<span class="fc" id="L156">        out.close();</span>
<span class="fc" id="L157">        final ByteArrayInputStream bin = new ByteArrayInputStream(bytes);</span>
<span class="fc" id="L158">        final ObjectInputStream in = new ObjectInputStream(bin);</span>
<span class="fc" id="L159">        final Flat3Map&lt;?, ?&gt; ser = (Flat3Map&lt;?, ?&gt;) in.readObject();</span>
<span class="fc" id="L160">        in.close();</span>
<span class="fc" id="L161">        assertEquals(0, map.size());</span>
<span class="fc" id="L162">        assertEquals(0, ser.size());</span>
<span class="fc" id="L163">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testSerialisation2() throws Exception {
<span class="fc" id="L167">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L168">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L169">        map.put((K) TWO, (V) TWENTY);</span>

<span class="fc" id="L171">        final ByteArrayOutputStream bout = new ByteArrayOutputStream();</span>
<span class="fc" id="L172">        final ObjectOutputStream out = new ObjectOutputStream(bout);</span>
<span class="fc" id="L173">        out.writeObject(map);</span>
<span class="fc" id="L174">        final byte[] bytes = bout.toByteArray();</span>
<span class="fc" id="L175">        out.close();</span>
<span class="fc" id="L176">        final ByteArrayInputStream bin = new ByteArrayInputStream(bytes);</span>
<span class="fc" id="L177">        final ObjectInputStream in = new ObjectInputStream(bin);</span>
<span class="fc" id="L178">        final Flat3Map&lt;?, ?&gt; ser = (Flat3Map&lt;?, ?&gt;) in.readObject();</span>
<span class="fc" id="L179">        in.close();</span>
<span class="fc" id="L180">        assertEquals(2, map.size());</span>
<span class="fc" id="L181">        assertEquals(2, ser.size());</span>
<span class="fc" id="L182">        assertEquals(true, ser.containsKey(ONE));</span>
<span class="fc" id="L183">        assertEquals(true, ser.containsKey(TWO));</span>
<span class="fc" id="L184">        assertEquals(TEN, ser.get(ONE));</span>
<span class="fc" id="L185">        assertEquals(TWENTY, ser.get(TWO));</span>
<span class="fc" id="L186">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testSerialisation4() throws Exception {
<span class="fc" id="L190">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L191">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L192">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L193">        map.put((K) TEN, (V) ONE);</span>
<span class="fc" id="L194">        map.put((K) TWENTY, (V) TWO);</span>

<span class="fc" id="L196">        final ByteArrayOutputStream bout = new ByteArrayOutputStream();</span>
<span class="fc" id="L197">        final ObjectOutputStream out = new ObjectOutputStream(bout);</span>
<span class="fc" id="L198">        out.writeObject(map);</span>
<span class="fc" id="L199">        final byte[] bytes = bout.toByteArray();</span>
<span class="fc" id="L200">        out.close();</span>
<span class="fc" id="L201">        final ByteArrayInputStream bin = new ByteArrayInputStream(bytes);</span>
<span class="fc" id="L202">        final ObjectInputStream in = new ObjectInputStream(bin);</span>
<span class="fc" id="L203">        final Flat3Map&lt;?, ?&gt; ser = (Flat3Map&lt;?, ?&gt;) in.readObject();</span>
<span class="fc" id="L204">        in.close();</span>
<span class="fc" id="L205">        assertEquals(4, map.size());</span>
<span class="fc" id="L206">        assertEquals(4, ser.size());</span>
<span class="fc" id="L207">        assertEquals(true, ser.containsKey(ONE));</span>
<span class="fc" id="L208">        assertEquals(true, ser.containsKey(TWO));</span>
<span class="fc" id="L209">        assertEquals(true, ser.containsKey(TEN));</span>
<span class="fc" id="L210">        assertEquals(true, ser.containsKey(TWENTY));</span>
<span class="fc" id="L211">        assertEquals(TEN, ser.get(ONE));</span>
<span class="fc" id="L212">        assertEquals(TWENTY, ser.get(TWO));</span>
<span class="fc" id="L213">        assertEquals(ONE, ser.get(TEN));</span>
<span class="fc" id="L214">        assertEquals(TWO, ser.get(TWENTY));</span>
<span class="fc" id="L215">    }</span>

    //-----------------------------------------------------------------------
    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEntryIteratorSetValue1() throws Exception {
<span class="fc" id="L220">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L221">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L222">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L223">        map.put((K) THREE, (V) THIRTY);</span>

<span class="fc" id="L225">        final Iterator&lt;Map.Entry&lt;K, V&gt;&gt; it = map.entrySet().iterator();</span>
<span class="fc" id="L226">        final Map.Entry&lt;K, V&gt; entry = it.next();</span>
<span class="fc" id="L227">        entry.setValue((V) &quot;NewValue&quot;);</span>
<span class="fc" id="L228">        assertEquals(3, map.size());</span>
<span class="fc" id="L229">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L230">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L231">        assertEquals(true, map.containsKey(THREE));</span>
<span class="fc" id="L232">        assertEquals(&quot;NewValue&quot;, map.get(ONE));</span>
<span class="fc" id="L233">        assertEquals(TWENTY, map.get(TWO));</span>
<span class="fc" id="L234">        assertEquals(THIRTY, map.get(THREE));</span>
<span class="fc" id="L235">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEntryIteratorSetValue2() throws Exception {
<span class="fc" id="L239">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L240">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L241">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L242">        map.put((K) THREE, (V) THIRTY);</span>

<span class="fc" id="L244">        final Iterator&lt;Map.Entry&lt;K, V&gt;&gt; it = map.entrySet().iterator();</span>
<span class="fc" id="L245">        it.next();</span>
<span class="fc" id="L246">        final Map.Entry&lt;K, V&gt; entry = it.next();</span>
<span class="fc" id="L247">        entry.setValue((V) &quot;NewValue&quot;);</span>
<span class="fc" id="L248">        assertEquals(3, map.size());</span>
<span class="fc" id="L249">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L250">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L251">        assertEquals(true, map.containsKey(THREE));</span>
<span class="fc" id="L252">        assertEquals(TEN, map.get(ONE));</span>
<span class="fc" id="L253">        assertEquals(&quot;NewValue&quot;, map.get(TWO));</span>
<span class="fc" id="L254">        assertEquals(THIRTY, map.get(THREE));</span>
<span class="fc" id="L255">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testEntryIteratorSetValue3() throws Exception {
<span class="fc" id="L259">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L260">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L261">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L262">        map.put((K) THREE, (V) THIRTY);</span>

<span class="fc" id="L264">        final Iterator&lt;Map.Entry&lt;K, V&gt;&gt; it = map.entrySet().iterator();</span>
<span class="fc" id="L265">        it.next();</span>
<span class="fc" id="L266">        it.next();</span>
<span class="fc" id="L267">        final Map.Entry&lt;K, V&gt; entry = it.next();</span>
<span class="fc" id="L268">        entry.setValue((V) &quot;NewValue&quot;);</span>
<span class="fc" id="L269">        assertEquals(3, map.size());</span>
<span class="fc" id="L270">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L271">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L272">        assertEquals(true, map.containsKey(THREE));</span>
<span class="fc" id="L273">        assertEquals(TEN, map.get(ONE));</span>
<span class="fc" id="L274">        assertEquals(TWENTY, map.get(TWO));</span>
<span class="fc" id="L275">        assertEquals(&quot;NewValue&quot;, map.get(THREE));</span>
<span class="fc" id="L276">    }</span>

    //-----------------------------------------------------------------------
    @SuppressWarnings(&quot;unchecked&quot;)
    public void testMapIteratorSetValue1() throws Exception {
<span class="fc" id="L281">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L282">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L283">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L284">        map.put((K) THREE, (V) THIRTY);</span>

<span class="fc" id="L286">        final MapIterator&lt;K, V&gt; it = map.mapIterator();</span>
<span class="fc" id="L287">        it.next();</span>
<span class="fc" id="L288">        it.setValue((V) &quot;NewValue&quot;);</span>
<span class="fc" id="L289">        assertEquals(3, map.size());</span>
<span class="fc" id="L290">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L291">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L292">        assertEquals(true, map.containsKey(THREE));</span>
<span class="fc" id="L293">        assertEquals(&quot;NewValue&quot;, map.get(ONE));</span>
<span class="fc" id="L294">        assertEquals(TWENTY, map.get(TWO));</span>
<span class="fc" id="L295">        assertEquals(THIRTY, map.get(THREE));</span>
<span class="fc" id="L296">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testMapIteratorSetValue2() throws Exception {
<span class="fc" id="L300">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L301">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L302">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L303">        map.put((K) THREE, (V) THIRTY);</span>

<span class="fc" id="L305">        final MapIterator&lt;K, V&gt; it = map.mapIterator();</span>
<span class="fc" id="L306">        it.next();</span>
<span class="fc" id="L307">        it.next();</span>
<span class="fc" id="L308">        it.setValue((V) &quot;NewValue&quot;);</span>
<span class="fc" id="L309">        assertEquals(3, map.size());</span>
<span class="fc" id="L310">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L311">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L312">        assertEquals(true, map.containsKey(THREE));</span>
<span class="fc" id="L313">        assertEquals(TEN, map.get(ONE));</span>
<span class="fc" id="L314">        assertEquals(&quot;NewValue&quot;, map.get(TWO));</span>
<span class="fc" id="L315">        assertEquals(THIRTY, map.get(THREE));</span>
<span class="fc" id="L316">    }</span>

    @SuppressWarnings(&quot;unchecked&quot;)
    public void testMapIteratorSetValue3() throws Exception {
<span class="fc" id="L320">        final Flat3Map&lt;K, V&gt; map = makeObject();</span>
<span class="fc" id="L321">        map.put((K) ONE, (V) TEN);</span>
<span class="fc" id="L322">        map.put((K) TWO, (V) TWENTY);</span>
<span class="fc" id="L323">        map.put((K) THREE, (V) THIRTY);</span>

<span class="fc" id="L325">        final MapIterator&lt;K, V&gt; it = map.mapIterator();</span>
<span class="fc" id="L326">        it.next();</span>
<span class="fc" id="L327">        it.next();</span>
<span class="fc" id="L328">        it.next();</span>
<span class="fc" id="L329">        it.setValue((V) &quot;NewValue&quot;);</span>
<span class="fc" id="L330">        assertEquals(3, map.size());</span>
<span class="fc" id="L331">        assertEquals(true, map.containsKey(ONE));</span>
<span class="fc" id="L332">        assertEquals(true, map.containsKey(TWO));</span>
<span class="fc" id="L333">        assertEquals(true, map.containsKey(THREE));</span>
<span class="fc" id="L334">        assertEquals(TEN, map.get(ONE));</span>
<span class="fc" id="L335">        assertEquals(TWENTY, map.get(TWO));</span>
<span class="fc" id="L336">        assertEquals(&quot;NewValue&quot;, map.get(THREE));</span>
<span class="fc" id="L337">    }</span>

    //-----------------------------------------------------------------------
    @Override
    public BulkTest bulkTestMapIterator() {
<span class="fc" id="L342">        return new TestFlatMapIterator();</span>
    }

    public class TestFlatMapIterator extends AbstractMapIteratorTest&lt;K, V&gt; {
<span class="fc" id="L346">        public TestFlatMapIterator() {</span>
<span class="fc" id="L347">            super(&quot;TestFlatMapIterator&quot;);</span>
<span class="fc" id="L348">        }</span>

        @Override
        public V[] addSetValues() {
<span class="fc" id="L352">            return Flat3MapTest.this.getNewSampleValues();</span>
        }

        @Override
        public boolean supportsRemove() {
<span class="fc" id="L357">            return Flat3MapTest.this.isRemoveSupported();</span>
        }

        @Override
        public boolean supportsSetValue() {
<span class="fc" id="L362">            return Flat3MapTest.this.isSetValueSupported();</span>
        }

        @Override
        public MapIterator&lt;K, V&gt; makeEmptyIterator() {
<span class="fc" id="L367">            resetEmpty();</span>
<span class="fc" id="L368">            return Flat3MapTest.this.getMap().mapIterator();</span>
        }

        @Override
        public MapIterator&lt;K, V&gt; makeObject() {
<span class="fc" id="L373">            resetFull();</span>
<span class="fc" id="L374">            return Flat3MapTest.this.getMap().mapIterator();</span>
        }

        @Override
        public IterableMap&lt;K, V&gt; getMap() {
            // assumes makeFullMapIterator() called first
<span class="fc" id="L380">            return Flat3MapTest.this.getMap();</span>
        }

        @Override
        public Map&lt;K, V&gt; getConfirmedMap() {
            // assumes makeFullMapIterator() called first
<span class="fc" id="L386">            return Flat3MapTest.this.getConfirmed();</span>
        }

        @Override
        public void verify() {
<span class="fc" id="L391">            super.verify();</span>
<span class="fc" id="L392">            Flat3MapTest.this.verify();</span>
<span class="fc" id="L393">        }</span>
    }

    @Override
    public String getCompatibilityVersion() {
<span class="fc" id="L398">        return &quot;4&quot;;</span>
    }

//    public void testCreate() throws Exception {
//        resetEmpty();
//        writeExternalFormToDisk(
//            (java.io.Serializable) map,
//            &quot;src/test/resources/data/test/Flat3Map.emptyCollection.version4.obj&quot;);
//        resetFull();
//        writeExternalFormToDisk(
//            (java.io.Serializable) map,
//            &quot;src/test/resources/data/test/Flat3Map.fullCollection.version4.obj&quot;);
//    }

    public void testCollections261() {
<span class="fc" id="L413">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
<span class="fc" id="L414">        m.put( Integer.valueOf(1), Integer.valueOf(1) );</span>
<span class="fc" id="L415">        m.put( Integer.valueOf(0), Integer.valueOf(0) );</span>
<span class="fc" id="L416">        assertEquals( Integer.valueOf(1), m.remove( Integer.valueOf(1) ) );</span>
<span class="fc" id="L417">        assertEquals( Integer.valueOf(0), m.remove( Integer.valueOf(0) ) );</span>

<span class="fc" id="L419">        m.put( Integer.valueOf(2), Integer.valueOf(2) );</span>
<span class="fc" id="L420">        m.put( Integer.valueOf(1), Integer.valueOf(1) );</span>
<span class="fc" id="L421">        m.put( Integer.valueOf(0), Integer.valueOf(0) );</span>
<span class="fc" id="L422">        assertEquals( Integer.valueOf(2), m.remove( Integer.valueOf(2) ) );</span>
<span class="fc" id="L423">        assertEquals( Integer.valueOf(1), m.remove( Integer.valueOf(1) ) );</span>
<span class="fc" id="L424">        assertEquals( Integer.valueOf(0), m.remove( Integer.valueOf(0) ) );</span>
<span class="fc" id="L425">    }</span>

    public void testToString() {
<span class="fc" id="L428">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
<span class="fc" id="L429">        final String string0 = m.toString();</span>
<span class="fc" id="L430">        assertNotNull(string0);</span>
<span class="fc" id="L431">        m.put( Integer.valueOf(1), Integer.valueOf(1) );</span>
<span class="fc" id="L432">        final String string1 = m.toString();</span>
<span class="fc" id="L433">        assertNotNull(string1);</span>
<span class="fc" id="L434">        assertNotSame(string0, string1);</span>
<span class="fc" id="L435">        m.put( Integer.valueOf(0), Integer.valueOf(0) );</span>
<span class="fc" id="L436">        final String string2 = m.toString();</span>
<span class="fc" id="L437">        assertNotNull(string2);</span>
<span class="fc" id="L438">        assertNotSame(string0, string2);</span>
<span class="fc" id="L439">        assertNotSame(string1, string2);</span>
<span class="fc" id="L440">        m.put( Integer.valueOf(2), Integer.valueOf(2) );</span>
<span class="fc" id="L441">        final String string3 = m.toString();</span>
<span class="fc" id="L442">        assertNotNull(string3);</span>
<span class="fc" id="L443">        assertNotSame(string0, string3);</span>
<span class="fc" id="L444">        assertNotSame(string1, string3);</span>
<span class="fc" id="L445">        assertNotSame(string2, string3);</span>
<span class="fc" id="L446">    }</span>

    public void testRemove1() {
<span class="fc" id="L449">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

        // object is not existing
<span class="fc" id="L452">        Object obj = m.remove(44);</span>
<span class="fc" id="L453">        assertNull(obj);</span>

<span class="fc" id="L455">        m.put(ONE, ONE);</span>
<span class="fc" id="L456">        obj = m.remove(ONE);</span>
<span class="fc" id="L457">        assertSame(ONE, obj);</span>
<span class="fc" id="L458">        assertEquals(0, m.size());</span>

        // after removal, be no longer there
<span class="fc" id="L461">        obj = m.get(ONE);</span>
<span class="fc" id="L462">        assertNull(obj);</span>

<span class="fc" id="L464">        m.put(ONE, ONE);</span>
<span class="fc" id="L465">        m.put(TWO, TWO);</span>
<span class="fc" id="L466">        m.put(THREE, THREE);</span>

<span class="fc" id="L468">        obj = m.remove(ONE);</span>
<span class="fc" id="L469">        assertSame(ONE, obj);</span>

<span class="fc" id="L471">        obj = m.get(ONE);</span>
<span class="fc" id="L472">        assertNull(obj);</span>
<span class="fc" id="L473">        obj = m.get(TWO);</span>
<span class="fc" id="L474">        assertSame(TWO, obj);</span>
<span class="fc" id="L475">    }</span>

    public void testRemove2() {
<span class="fc" id="L478">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L481">        m.put(ONE, ONE);</span>
<span class="fc" id="L482">        m.put(TWO, TWO);</span>
<span class="fc" id="L483">        m.put(THREE, THREE);</span>

<span class="fc" id="L485">        obj = m.remove(ONE);</span>
<span class="fc" id="L486">        assertSame(ONE, obj);</span>

<span class="fc" id="L488">        obj = m.get(ONE);</span>
<span class="fc" id="L489">        assertNull(obj);</span>
<span class="fc" id="L490">        obj = m.get(TWO);</span>
<span class="fc" id="L491">        assertSame(TWO, obj);</span>
<span class="fc" id="L492">        obj = m.get(THREE);</span>
<span class="fc" id="L493">        assertSame(THREE, obj);</span>
<span class="fc" id="L494">    }</span>

    public void testRemove3() {
<span class="fc" id="L497">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L500">        m.put(ONE, ONE);</span>
<span class="fc" id="L501">        m.put(TWO, TWO);</span>
<span class="fc" id="L502">        m.put(THREE, THREE);</span>

<span class="fc" id="L504">        obj = m.remove(TWO);</span>
<span class="fc" id="L505">        assertSame(TWO, obj);</span>

<span class="fc" id="L507">        obj = m.get(ONE);</span>
<span class="fc" id="L508">        assertSame(ONE, obj);</span>
<span class="fc" id="L509">        obj = m.get(TWO);</span>
<span class="fc" id="L510">        assertNull(obj);</span>
<span class="fc" id="L511">        obj = m.get(THREE);</span>
<span class="fc" id="L512">        assertSame(THREE, obj);</span>
<span class="fc" id="L513">    }</span>

    public void testRemove4() {
<span class="fc" id="L516">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L519">        m.put(ONE, ONE);</span>
<span class="fc" id="L520">        m.put(TWO, TWO);</span>
<span class="fc" id="L521">        m.put(THREE, THREE);</span>

<span class="fc" id="L523">        obj = m.remove(THREE);</span>
<span class="fc" id="L524">        assertSame(THREE, obj);</span>

<span class="fc" id="L526">        obj = m.get(ONE);</span>
<span class="fc" id="L527">        assertSame(ONE, obj);</span>
<span class="fc" id="L528">        obj = m.get(TWO);</span>
<span class="fc" id="L529">        assertSame(TWO, obj);</span>
<span class="fc" id="L530">        obj = m.get(THREE);</span>
<span class="fc" id="L531">        assertNull(obj);</span>
<span class="fc" id="L532">    }</span>

    public void testRemove5() {
<span class="fc" id="L535">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L538">        m.put(null, ONE);</span>

<span class="fc" id="L540">        obj = m.remove(null);</span>
<span class="fc" id="L541">        assertSame(ONE, obj);</span>

<span class="fc" id="L543">        obj = m.get(null);</span>
<span class="fc" id="L544">        assertNull(obj);</span>
<span class="fc" id="L545">    }</span>

    public void testRemove6() {
<span class="fc" id="L548">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L551">        m.put(ONE, ONE);</span>
<span class="fc" id="L552">        m.put(null, TWO);</span>

<span class="fc" id="L554">        obj = m.remove(null);</span>
<span class="fc" id="L555">        assertSame(TWO, obj);</span>

<span class="fc" id="L557">        obj = m.get(ONE);</span>
<span class="fc" id="L558">        assertSame(ONE, obj);</span>
<span class="fc" id="L559">        obj = m.get(null);</span>
<span class="fc" id="L560">        assertNull(obj);</span>
<span class="fc" id="L561">    }</span>

    public void testRemove7() {
<span class="fc" id="L564">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L567">        m.put(null, ONE);</span>
<span class="fc" id="L568">        m.put(TWO, TWO);</span>

<span class="fc" id="L570">        obj = m.remove(null);</span>
<span class="fc" id="L571">        assertSame(ONE, obj);</span>

<span class="fc" id="L573">        obj = m.get(null);</span>
<span class="fc" id="L574">        assertNull(obj);</span>
<span class="fc" id="L575">        obj = m.get(TWO);</span>
<span class="fc" id="L576">        assertSame(TWO, obj);</span>
<span class="fc" id="L577">    }</span>

    public void testRemove8() {
<span class="fc" id="L580">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L583">        m.put(ONE, ONE);</span>
<span class="fc" id="L584">        m.put(TWO, TWO);</span>
<span class="fc" id="L585">        m.put(null, THREE);</span>

<span class="fc" id="L587">        obj = m.remove(null);</span>
<span class="fc" id="L588">        assertSame(THREE, obj);</span>

<span class="fc" id="L590">        obj = m.get(ONE);</span>
<span class="fc" id="L591">        assertSame(ONE, obj);</span>
<span class="fc" id="L592">        obj = m.get(TWO);</span>
<span class="fc" id="L593">        assertSame(TWO, obj);</span>
<span class="fc" id="L594">        obj = m.get(null);</span>
<span class="fc" id="L595">        assertNull(obj);</span>
<span class="fc" id="L596">    }</span>

    public void testRemove9() {
<span class="fc" id="L599">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L602">        m.put(ONE, ONE);</span>

<span class="fc" id="L604">        obj = m.remove(null);</span>
<span class="fc" id="L605">        assertNull(obj);</span>
<span class="fc" id="L606">    }</span>

    public void testRemove10() {
<span class="fc" id="L609">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L612">        m.put(ONE, ONE);</span>
<span class="fc" id="L613">        m.put(TWO, TWO);</span>

<span class="fc" id="L615">        obj = m.remove(null);</span>
<span class="fc" id="L616">        assertNull(obj);</span>
<span class="fc" id="L617">    }</span>

    public void testRemove11() {
<span class="fc" id="L620">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L623">        m.put(ONE, ONE);</span>
<span class="fc" id="L624">        m.put(TWO, TWO);</span>
<span class="fc" id="L625">        m.put(THREE, THREE);</span>

<span class="fc" id="L627">        obj = m.remove(null);</span>
<span class="fc" id="L628">        assertNull(obj);</span>
<span class="fc" id="L629">    }</span>

    public void testRemove12() {
<span class="fc" id="L632">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L635">        m.put(ONE, ONE);</span>
<span class="fc" id="L636">        m.put(TWO, TWO);</span>
<span class="fc" id="L637">        m.put(THREE, THREE);</span>

<span class="fc" id="L639">        obj = m.remove(42);</span>
<span class="fc" id="L640">        assertNull(obj);</span>
<span class="fc" id="L641">    }</span>

    public void testRemove13() {
<span class="fc" id="L644">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L647">        m.put(ONE, ONE);</span>
<span class="fc" id="L648">        m.put(TWO, TWO);</span>

<span class="fc" id="L650">        obj = m.remove(42);</span>
<span class="fc" id="L651">        assertNull(obj);</span>
<span class="fc" id="L652">    }</span>

    public void testNewInstance1() {
<span class="fc" id="L655">        final Map&lt;Integer, Integer&gt; orig = new HashMap&lt;&gt;();</span>
<span class="fc" id="L656">        orig.put(ONE, ONE);</span>
<span class="fc" id="L657">        orig.put(TWO, TWO);</span>

<span class="fc" id="L659">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;(orig);</span>

<span class="fc" id="L661">        assertEquals(orig, m);</span>
<span class="fc" id="L662">        assertEquals(2, m.size());</span>
<span class="fc" id="L663">    }</span>

    public void testGet1() {
<span class="fc" id="L666">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L669">        m.put(null, ONE);</span>
<span class="fc" id="L670">        obj = m.get(null);</span>
<span class="fc" id="L671">        assertSame(ONE, obj);</span>
<span class="fc" id="L672">    }</span>

    public void testGet2() {
<span class="fc" id="L675">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L678">        m.put(ONE, ONE);</span>
<span class="fc" id="L679">        m.put(null, TWO);</span>
<span class="fc" id="L680">        obj = m.get(null);</span>
<span class="fc" id="L681">        assertSame(TWO, obj);</span>
<span class="fc" id="L682">    }</span>

    public void testGet3() {
<span class="fc" id="L685">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>
        Object obj;

<span class="fc" id="L688">        m.put(ONE, ONE);</span>
<span class="fc" id="L689">        m.put(TWO, TWO);</span>
<span class="fc" id="L690">        m.put(null, THREE);</span>
<span class="fc" id="L691">        obj = m.get(null);</span>
<span class="fc" id="L692">        assertSame(THREE, obj);</span>
<span class="fc" id="L693">    }</span>

    public void testContainsKey1() {
<span class="fc" id="L696">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L698">        m.put(ONE, ONE);</span>
<span class="fc" id="L699">        m.put(TWO, TWO);</span>
<span class="fc" id="L700">        m.put(null, THREE);</span>
<span class="fc" id="L701">        final boolean contains = m.containsKey(null);</span>
<span class="fc" id="L702">        assertEquals(true, contains);</span>
<span class="fc" id="L703">    }</span>

    public void testContainsKey2() {
<span class="fc" id="L706">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L708">        m.put(ONE, ONE);</span>
<span class="fc" id="L709">        m.put(null, TWO);</span>
<span class="fc" id="L710">        final boolean contains = m.containsKey(null);</span>
<span class="fc" id="L711">        assertEquals(true, contains);</span>
<span class="fc" id="L712">    }</span>

    public void testContainsKey3() {
<span class="fc" id="L715">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L717">        m.put(null, ONE);</span>
<span class="fc" id="L718">        final boolean contains = m.containsKey(null);</span>
<span class="fc" id="L719">        assertEquals(true, contains);</span>
<span class="fc" id="L720">    }</span>

    public void testContainsValue1() {
<span class="fc" id="L723">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L725">        m.put(ONE, ONE);</span>
<span class="fc" id="L726">        m.put(TWO, TWO);</span>
<span class="fc" id="L727">        m.put(THREE, null);</span>
<span class="fc" id="L728">        final boolean contains = m.containsValue(null);</span>
<span class="fc" id="L729">        assertEquals(true, contains);</span>
<span class="fc" id="L730">    }</span>

    public void testContainsValue2() {
<span class="fc" id="L733">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L735">        m.put(ONE, ONE);</span>
<span class="fc" id="L736">        m.put(TWO, null);</span>
<span class="fc" id="L737">        final boolean contains = m.containsValue(null);</span>
<span class="fc" id="L738">        assertEquals(true, contains);</span>
<span class="fc" id="L739">    }</span>

    public void testContainsValue3() {
<span class="fc" id="L742">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L744">        m.put(ONE, null);</span>
<span class="fc" id="L745">        final boolean contains = m.containsValue(null);</span>
<span class="fc" id="L746">        assertEquals(true, contains);</span>
<span class="fc" id="L747">    }</span>

    public void testPut1() {
<span class="fc" id="L750">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L752">        m.put(ONE, ONE);</span>
<span class="fc" id="L753">        m.put(TWO, TWO);</span>
<span class="fc" id="L754">        m.put(null, THREE);</span>
<span class="fc" id="L755">        final Object old = m.put(null, ONE);</span>
<span class="fc" id="L756">        assertEquals(THREE, old);</span>
<span class="fc" id="L757">        assertEquals(ONE, m.get(null));</span>
<span class="fc" id="L758">    }</span>

    public void testPut2() {
<span class="fc" id="L761">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L763">        m.put(ONE, ONE);</span>
<span class="fc" id="L764">        m.put(null, THREE);</span>
<span class="fc" id="L765">        final Object old = m.put(null, ONE);</span>
<span class="fc" id="L766">        assertEquals(THREE, old);</span>
<span class="fc" id="L767">        assertEquals(ONE, m.get(null));</span>
<span class="fc" id="L768">    }</span>

    public void testPut3() {
<span class="fc" id="L771">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L773">        m.put(null, THREE);</span>
<span class="fc" id="L774">        final Object old = m.put(null, ONE);</span>
<span class="fc" id="L775">        assertEquals(THREE, old);</span>
<span class="fc" id="L776">        assertEquals(null, m.get(ONE));</span>
<span class="fc" id="L777">    }</span>

    public void testPut4() {
<span class="fc" id="L780">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L782">        m.put(ONE, ONE);</span>
<span class="fc" id="L783">        m.put(TWO, TWO);</span>
<span class="fc" id="L784">        m.put(THREE, THREE);</span>
<span class="fc" id="L785">        final Object old = m.put(THREE, ONE);</span>
<span class="fc" id="L786">        assertEquals(THREE, old);</span>
<span class="fc" id="L787">        assertEquals(ONE, m.get(THREE));</span>
<span class="fc" id="L788">    }</span>

    public void testPut5() {
<span class="fc" id="L791">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L793">        m.put(ONE, ONE);</span>
<span class="fc" id="L794">        m.put(TWO, THREE);</span>
<span class="fc" id="L795">        final Object old = m.put(TWO, ONE);</span>
<span class="fc" id="L796">        assertEquals(THREE, old);</span>
<span class="fc" id="L797">        assertEquals(ONE, m.get(TWO));</span>
<span class="fc" id="L798">    }</span>

    public void testPut6() {
<span class="fc" id="L801">        final Flat3Map&lt;Integer, Integer&gt; m = new Flat3Map&lt;&gt;();</span>

<span class="fc" id="L803">        m.put(ONE, THREE);</span>
<span class="fc" id="L804">        final Object old = m.put(ONE, ONE);</span>
<span class="fc" id="L805">        assertEquals(THREE, old);</span>
<span class="fc" id="L806">        assertEquals(ONE, m.get(ONE));</span>
<span class="fc" id="L807">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>