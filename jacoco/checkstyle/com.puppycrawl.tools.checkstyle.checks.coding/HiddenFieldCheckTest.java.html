<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>HiddenFieldCheckTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">checkstyle$java_in_checkstyle.exec</a> &gt; <a href="index.source.html" class="el_package">com.puppycrawl.tools.checkstyle.checks.coding</a> &gt; <span class="el_source">HiddenFieldCheckTest.java</span></div><h1>HiddenFieldCheckTest.java</h1><pre class="source lang-java linenums">////////////////////////////////////////////////////////////////////////////////
// checkstyle: Checks Java source code for adherence to a set of rules.
// Copyright (C) 2001-2019 the original author or authors.
//
// This library is free software; you can redistribute it and/or
// modify it under the terms of the GNU Lesser General Public
// License as published by the Free Software Foundation; either
// version 2.1 of the License, or (at your option) any later version.
//
// This library is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
// Lesser General Public License for more details.
//
// You should have received a copy of the GNU Lesser General Public
// License along with this library; if not, write to the Free Software
// Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA
////////////////////////////////////////////////////////////////////////////////

package com.puppycrawl.tools.checkstyle.checks.coding;

import static com.puppycrawl.tools.checkstyle.checks.coding.HiddenFieldCheck.MSG_KEY;
import static org.junit.Assert.assertTrue;

import java.io.File;
import java.util.Optional;
import java.util.function.Predicate;

import org.junit.Assert;
import org.junit.Test;

import com.puppycrawl.tools.checkstyle.AbstractModuleTestSupport;
import com.puppycrawl.tools.checkstyle.DefaultConfiguration;
import com.puppycrawl.tools.checkstyle.JavaParser;
import com.puppycrawl.tools.checkstyle.api.DetailAST;
import com.puppycrawl.tools.checkstyle.api.TokenTypes;
import com.puppycrawl.tools.checkstyle.internal.utils.TestUtil;
import com.puppycrawl.tools.checkstyle.utils.CommonUtil;

<span class="fc" id="L40">public class HiddenFieldCheckTest</span>
    extends AbstractModuleTestSupport {

    @Override
    protected String getPackageLocation() {
<span class="fc" id="L45">        return &quot;com/puppycrawl/tools/checkstyle/checks/coding/hiddenfield&quot;;</span>
    }

    @Test
    public void testStaticVisibilityFromLambdas() throws Exception {
<span class="fc" id="L50">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L51">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L52">        final String[] expected = {</span>
<span class="fc" id="L53">            &quot;19:34: &quot; + getCheckMessage(MSG_KEY, &quot;value&quot;),</span>
<span class="fc" id="L54">            &quot;51:31: &quot; + getCheckMessage(MSG_KEY, &quot;languageCode&quot;),</span>
<span class="fc" id="L55">            &quot;60:35: &quot; + getCheckMessage(MSG_KEY, &quot;number&quot;),</span>
<span class="fc" id="L56">            &quot;73:35: &quot; + getCheckMessage(MSG_KEY, &quot;id&quot;),</span>
<span class="fc" id="L57">            &quot;101:33: &quot; + getCheckMessage(MSG_KEY, &quot;note&quot;),</span>
<span class="fc" id="L58">            &quot;126:48: &quot; + getCheckMessage(MSG_KEY, &quot;stringValue&quot;),</span>
<span class="fc" id="L59">            &quot;126:69: &quot; + getCheckMessage(MSG_KEY, &quot;intValue&quot;),</span>
<span class="fc" id="L60">            &quot;137:69: &quot; + getCheckMessage(MSG_KEY, &quot;doubleValue&quot;),</span>
<span class="fc" id="L61">            &quot;149:51: &quot; + getCheckMessage(MSG_KEY, &quot;firstString&quot;),</span>
<span class="fc" id="L62">            &quot;149:64: &quot; + getCheckMessage(MSG_KEY, &quot;secondString&quot;),</span>
<span class="fc" id="L63">            &quot;165:49: &quot; + getCheckMessage(MSG_KEY, &quot;first&quot;),</span>
<span class="fc" id="L64">            &quot;191:62: &quot; + getCheckMessage(MSG_KEY, &quot;mPi&quot;),</span>
<span class="fc" id="L65">            &quot;207:27: &quot; + getCheckMessage(MSG_KEY, &quot;justSomeList&quot;),</span>
<span class="fc" id="L66">            &quot;207:61: &quot; + getCheckMessage(MSG_KEY, &quot;justSomeMap&quot;),</span>
<span class="fc" id="L67">            &quot;219:55: &quot; + getCheckMessage(MSG_KEY, &quot;someObject&quot;),</span>
<span class="fc" id="L68">            &quot;227:52: &quot; + getCheckMessage(MSG_KEY, &quot;someObject&quot;),</span>
        };
<span class="fc" id="L70">        verify(checkConfig, getPath(&quot;InputHiddenFieldLambdas.java&quot;), expected);</span>
<span class="fc" id="L71">    }</span>

    @Test
    public void testStaticVisibilityFromAnonymousClasses() throws Exception {
<span class="fc" id="L75">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L76">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L77">        final String[] expected = {</span>
<span class="fc" id="L78">            &quot;10:45: &quot; + getCheckMessage(MSG_KEY, &quot;other&quot;),</span>
<span class="fc" id="L79">            &quot;16:42: &quot; + getCheckMessage(MSG_KEY, &quot;other&quot;),</span>
<span class="fc" id="L80">            &quot;24:49: &quot; + getCheckMessage(MSG_KEY, &quot;other&quot;),</span>
<span class="fc" id="L81">            &quot;34:53: &quot; + getCheckMessage(MSG_KEY, &quot;other&quot;),</span>
<span class="fc" id="L82">            &quot;46:26: &quot; + getCheckMessage(MSG_KEY, &quot;someField&quot;),</span>
        };
<span class="fc" id="L84">        verify(checkConfig, getPath(&quot;InputHiddenFieldStaticVisibility.java&quot;), expected);</span>
<span class="fc" id="L85">    }</span>

    @Test
    public void testNoParameters()
            throws Exception {
<span class="fc" id="L90">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L91">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L92">        checkConfig.addAttribute(&quot;tokens&quot;, &quot;VARIABLE_DEF&quot;);</span>
<span class="fc" id="L93">        final String[] expected = {</span>
<span class="fc" id="L94">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L95">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L96">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L97">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L98">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L99">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L100">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L101">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L102">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L103">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L104">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L105">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L106">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L107">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L108">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L109">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L110">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L111">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
        };
<span class="fc" id="L113">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L114">    }</span>

    @Test
    public void testDefault()
            throws Exception {
<span class="fc" id="L119">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L120">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L121">        final String[] expected = {</span>
<span class="fc" id="L122">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L123">            &quot;21:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L124">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L125">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L126">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L127">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L128">            &quot;49:26: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L129">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L130">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L131">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L132">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L133">            &quot;69:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L134">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L135">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L136">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L137">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L138">            &quot;100:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L139">            &quot;106:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L140">            &quot;112:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L141">            &quot;124:28: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L142">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L143">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L144">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L145">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L146">            &quot;179:23: &quot; + getCheckMessage(MSG_KEY, &quot;y&quot;),</span>
<span class="fc" id="L147">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L148">            &quot;210:20: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L149">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L150">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
<span class="fc" id="L151">            &quot;230:41: &quot; + getCheckMessage(MSG_KEY, &quot;x&quot;),</span>
<span class="fc" id="L152">            &quot;236:30: &quot; + getCheckMessage(MSG_KEY, &quot;xAxis&quot;),</span>
<span class="fc" id="L153">            &quot;253:40: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L154">            &quot;267:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L155">            &quot;278:41: &quot; + getCheckMessage(MSG_KEY, &quot;prop2&quot;),</span>
<span class="fc" id="L156">            &quot;290:19: &quot; + getCheckMessage(MSG_KEY, &quot;i&quot;),</span>
        };
<span class="fc" id="L158">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L159">    }</span>

    /** Tests ignoreFormat property. */
    @Test
    public void testIgnoreFormat()
            throws Exception {
<span class="fc" id="L165">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L166">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L167">        checkConfig.addAttribute(&quot;ignoreFormat&quot;, &quot;^i.*$&quot;);</span>
<span class="fc" id="L168">        Assert.assertNotNull(&quot;Ignore format should not be null&quot;,</span>
<span class="fc" id="L169">                checkConfig.getAttribute(&quot;ignoreFormat&quot;));</span>
<span class="fc" id="L170">        final String[] expected = {</span>
<span class="fc" id="L171">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L172">            &quot;21:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L173">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L174">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L175">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L176">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L177">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L178">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L179">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L180">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L181">            &quot;100:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L182">            &quot;106:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L183">            &quot;112:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L184">            &quot;124:28: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L185">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L186">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L187">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L188">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L189">            &quot;179:23: &quot; + getCheckMessage(MSG_KEY, &quot;y&quot;),</span>
<span class="fc" id="L190">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L191">            &quot;210:20: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L192">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L193">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
<span class="fc" id="L194">            &quot;230:41: &quot; + getCheckMessage(MSG_KEY, &quot;x&quot;),</span>
<span class="fc" id="L195">            &quot;236:30: &quot; + getCheckMessage(MSG_KEY, &quot;xAxis&quot;),</span>
<span class="fc" id="L196">            &quot;253:40: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L197">            &quot;267:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L198">            &quot;278:41: &quot; + getCheckMessage(MSG_KEY, &quot;prop2&quot;),</span>
        };
<span class="fc" id="L200">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L201">    }</span>

    /** Tests ignoreSetter property. */
    @Test
    public void testIgnoreSetter()
            throws Exception {
<span class="fc" id="L207">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L208">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L209">        checkConfig.addAttribute(&quot;ignoreSetter&quot;, &quot;true&quot;);</span>
<span class="fc" id="L210">        final String[] expected = {</span>
<span class="fc" id="L211">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L212">            &quot;21:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L213">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L214">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L215">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L216">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L217">            &quot;49:26: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L218">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L219">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L220">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L221">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L222">            &quot;69:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L223">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L224">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L225">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L226">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L227">            &quot;106:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L228">            &quot;112:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L229">            &quot;124:28: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L230">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L231">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L232">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L233">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L234">            &quot;179:23: &quot; + getCheckMessage(MSG_KEY, &quot;y&quot;),</span>
<span class="fc" id="L235">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L236">            &quot;210:20: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L237">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L238">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
<span class="fc" id="L239">            &quot;230:41: &quot; + getCheckMessage(MSG_KEY, &quot;x&quot;),</span>
<span class="fc" id="L240">            &quot;253:40: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L241">            &quot;278:41: &quot; + getCheckMessage(MSG_KEY, &quot;prop2&quot;),</span>
        };
<span class="fc" id="L243">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L244">    }</span>

    /** Tests ignoreSetter and setterCanReturnItsClass properties. */
    @Test
    public void testIgnoreChainSetter()
            throws Exception {
<span class="fc" id="L250">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L251">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L252">        checkConfig.addAttribute(&quot;ignoreSetter&quot;, &quot;true&quot;);</span>
<span class="fc" id="L253">        checkConfig.addAttribute(&quot;setterCanReturnItsClass&quot;, &quot;true&quot;);</span>
<span class="fc" id="L254">        final String[] expected = {</span>
<span class="fc" id="L255">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L256">            &quot;21:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L257">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L258">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L259">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L260">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L261">            &quot;49:26: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L262">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L263">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L264">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L265">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L266">            &quot;69:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L267">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L268">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L269">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L270">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L271">            &quot;106:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L272">            &quot;112:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L273">            &quot;124:28: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L274">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L275">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L276">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L277">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L278">            &quot;179:23: &quot; + getCheckMessage(MSG_KEY, &quot;y&quot;),</span>
<span class="fc" id="L279">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L280">            &quot;210:20: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L281">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L282">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
<span class="fc" id="L283">            &quot;230:41: &quot; + getCheckMessage(MSG_KEY, &quot;x&quot;),</span>
        };
<span class="fc" id="L285">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L286">    }</span>

    /** Tests ignoreConstructorParameter property. */
    @Test
    public void testIgnoreConstructorParameter()
            throws Exception {
<span class="fc" id="L292">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L293">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L294">        checkConfig.addAttribute(&quot;ignoreConstructorParameter&quot;, &quot;true&quot;);</span>
<span class="fc" id="L295">        final String[] expected = {</span>
<span class="fc" id="L296">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L297">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L298">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L299">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L300">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L301">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L302">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L303">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L304">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L305">            &quot;69:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L306">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L307">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L308">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L309">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L310">            &quot;100:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L311">            &quot;106:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L312">            &quot;112:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L313">            &quot;124:28: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L314">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L315">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L316">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L317">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L318">            &quot;179:23: &quot; + getCheckMessage(MSG_KEY, &quot;y&quot;),</span>
<span class="fc" id="L319">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L320">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L321">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
<span class="fc" id="L322">            &quot;230:41: &quot; + getCheckMessage(MSG_KEY, &quot;x&quot;),</span>
<span class="fc" id="L323">            &quot;236:30: &quot; + getCheckMessage(MSG_KEY, &quot;xAxis&quot;),</span>
<span class="fc" id="L324">            &quot;253:40: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L325">            &quot;267:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L326">            &quot;278:41: &quot; + getCheckMessage(MSG_KEY, &quot;prop2&quot;),</span>
<span class="fc" id="L327">            &quot;290:19: &quot; + getCheckMessage(MSG_KEY, &quot;i&quot;),</span>
        };
<span class="fc" id="L329">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L330">    }</span>

    /** Test against a class with field declarations in different order. */
    @Test
    public void testReordered()
            throws Exception {
<span class="fc" id="L336">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L337">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L338">        final String[] expected = {</span>
<span class="fc" id="L339">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L340">            &quot;21:40: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L341">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L342">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L343">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L344">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L345">            &quot;49:26: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L346">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L347">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L348">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L349">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L350">            &quot;69:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L351">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L352">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L353">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L354">            &quot;83:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L355">            &quot;105:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L356">            &quot;118:21: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L357">            &quot;125:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L358">            &quot;131:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
        };
<span class="fc" id="L360">        verify(checkConfig, getPath(&quot;InputHiddenFieldReorder.java&quot;), expected);</span>
<span class="fc" id="L361">    }</span>

    @Test
    public void testIgnoreAbstractMethods() throws Exception {
<span class="fc" id="L365">        final DefaultConfiguration checkConfig =</span>
<span class="fc" id="L366">            createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L367">        checkConfig.addAttribute(&quot;ignoreAbstractMethods&quot;, &quot;true&quot;);</span>

<span class="fc" id="L369">        final String[] expected = {</span>
<span class="fc" id="L370">            &quot;18:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L371">            &quot;21:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L372">            &quot;27:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L373">            &quot;32:18: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L374">            &quot;36:33: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L375">            &quot;46:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L376">            &quot;49:26: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L377">            &quot;55:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L378">            &quot;56:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L379">            &quot;61:22: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L380">            &quot;64:22: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L381">            &quot;69:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L382">            &quot;70:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L383">            &quot;76:17: &quot; + getCheckMessage(MSG_KEY, &quot;innerHidden&quot;),</span>
<span class="fc" id="L384">            &quot;77:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L385">            &quot;82:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L386">            &quot;100:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L387">            &quot;106:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L388">            &quot;112:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L389">            &quot;124:28: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L390">            &quot;138:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L391">            &quot;143:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L392">            &quot;148:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L393">            &quot;152:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L394">            &quot;179:23: &quot; + getCheckMessage(MSG_KEY, &quot;y&quot;),</span>
<span class="fc" id="L395">            &quot;200:17: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L396">            &quot;210:20: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L397">            &quot;217:13: &quot; + getCheckMessage(MSG_KEY, &quot;hidden&quot;),</span>
<span class="fc" id="L398">            &quot;223:13: &quot; + getCheckMessage(MSG_KEY, &quot;hiddenStatic&quot;),</span>
<span class="fc" id="L399">            &quot;236:30: &quot; + getCheckMessage(MSG_KEY, &quot;xAxis&quot;),</span>
<span class="fc" id="L400">            &quot;253:40: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L401">            &quot;267:29: &quot; + getCheckMessage(MSG_KEY, &quot;prop&quot;),</span>
<span class="fc" id="L402">            &quot;278:41: &quot; + getCheckMessage(MSG_KEY, &quot;prop2&quot;),</span>
<span class="fc" id="L403">            &quot;290:19: &quot; + getCheckMessage(MSG_KEY, &quot;i&quot;),</span>
        };
<span class="fc" id="L405">        verify(checkConfig, getPath(&quot;InputHiddenField.java&quot;), expected);</span>
<span class="fc" id="L406">    }</span>

    @Test
    public void testReceiverParameter() throws Exception {
<span class="fc" id="L410">        final DefaultConfiguration checkConfig = createModuleConfig(HiddenFieldCheck.class);</span>
<span class="fc" id="L411">        final String[] expected = CommonUtil.EMPTY_STRING_ARRAY;</span>
<span class="fc" id="L412">        verify(checkConfig, getPath(&quot;InputHiddenFieldReceiver.java&quot;), expected);</span>
<span class="fc" id="L413">    }</span>

    /**
     * We cannot reproduce situation when visitToken is called and leaveToken is not.
     * So, we have to use reflection to be sure that even in such situation
     * state of the field will be cleared.
     *
     * @throws Exception when code tested throws exception
     */
    @Test
    public void testClearState() throws Exception {
<span class="fc" id="L424">        final HiddenFieldCheck check = new HiddenFieldCheck();</span>
<span class="fc" id="L425">        final DetailAST root = JavaParser.parseFile(new File(getPath(&quot;InputHiddenField.java&quot;)),</span>
                JavaParser.Options.WITHOUT_COMMENTS);
<span class="fc" id="L427">        final Optional&lt;DetailAST&gt; classDef = TestUtil.findTokenInAstByPredicate(root,</span>
<span class="fc bfc" id="L428" title="All 2 branches covered.">            ast -&gt; ast.getType() == TokenTypes.CLASS_DEF);</span>

<span class="fc" id="L430">        assertTrue(&quot;Ast should contain CLASS_DEF&quot;, classDef.isPresent());</span>
<span class="fc" id="L431">        assertTrue(&quot;State is not cleared on beginTree&quot;,</span>
<span class="fc" id="L432">                TestUtil.isStatefulFieldClearedDuringBeginTree(check, classDef.get(), &quot;frame&quot;,</span>
                        new CheckIfStatefulFieldCleared()));
<span class="fc" id="L434">    }</span>

    private static class CheckIfStatefulFieldCleared implements Predicate&lt;Object&gt; {

        @Override
        public boolean test(Object frame) {
<span class="pc bpc" id="L440" title="1 of 2 branches missed.">            boolean result = frame != null;</span>

            // verify object is cleared
<span class="pc bpc" id="L443" title="1 of 2 branches missed.">            if (result) {</span>
<span class="fc" id="L444">                final Class&lt;?&gt; frameClass = frame.getClass();</span>

                try {
<span class="pc bpc" id="L447" title="1 of 2 branches missed.">                    if (TestUtil.getClassDeclaredField(frameClass, &quot;parent&quot;).get(frame) != null</span>
<span class="pc bpc" id="L448" title="1 of 2 branches missed.">                            || !((Boolean) TestUtil.getClassDeclaredField(frameClass, &quot;staticType&quot;)</span>
<span class="fc" id="L449">                                    .get(frame))</span>
<span class="fc" id="L450">                            || TestUtil.getClassDeclaredField(frameClass, &quot;frameName&quot;)</span>
<span class="pc bpc" id="L451" title="1 of 2 branches missed.">                                    .get(frame) != null) {</span>
<span class="nc" id="L452">                        result = false;</span>
                    }
                }
<span class="nc" id="L455">                catch (NoSuchFieldException | IllegalArgumentException</span>
                        | IllegalAccessException ex) {
<span class="nc" id="L457">                    throw new IllegalStateException(ex);</span>
<span class="fc" id="L458">                }</span>
            }

<span class="fc" id="L461">            return result;</span>
        }

    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>