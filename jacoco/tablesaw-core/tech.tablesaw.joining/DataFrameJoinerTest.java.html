<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>DataFrameJoinerTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tablesaw_core$All_in_tablesaw_core.exec</a> &gt; <a href="index.source.html" class="el_package">tech.tablesaw.joining</a> &gt; <span class="el_source">DataFrameJoinerTest.java</span></div><h1>DataFrameJoinerTest.java</h1><pre class="source lang-java linenums">package tech.tablesaw.joining;

import static org.junit.jupiter.api.Assertions.assertEquals;

import com.google.common.base.Joiner;
import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;
import org.junit.jupiter.api.Test;
import tech.tablesaw.api.Table;
import tech.tablesaw.api.TextColumn;
import tech.tablesaw.columns.Column;
import tech.tablesaw.selection.Selection;

<span class="pc bpc" id="L15" title="1 of 2 branches missed.">public class DataFrameJoinerTest {</span>

  private static final Table ONE_YEAR =
<span class="fc" id="L18">      Table.read()</span>
<span class="fc" id="L19">          .csv(</span>
<span class="fc" id="L20">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L21">                  .join(</span>
                      &quot;Date,1 Yr Treasury Rate&quot;,
                      &quot;\&quot;Dec 1, 2017\&quot;,1.65%&quot;,
                      &quot;\&quot;Nov 1, 2017\&quot;,1.56%&quot;,
                      &quot;\&quot;Oct 1, 2017\&quot;,1.40%&quot;,
                      &quot;\&quot;Sep 1, 2017\&quot;,1.28%&quot;,
                      &quot;\&quot;Aug 1, 2017\&quot;,1.23%&quot;,
                      &quot;\&quot;Jul 1, 2017\&quot;,1.22%&quot;),
              &quot;1 Yr Treasury Rate&quot;);

  private static final Table SP500 =
<span class="fc" id="L32">      Table.read()</span>
<span class="fc" id="L33">          .csv(</span>
<span class="fc" id="L34">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L35">                  .join(</span>
                      &quot;Date,S&amp;P 500&quot;,
                      &quot;\&quot;Nov 1, 2017\&quot;,2579.36&quot;,
                      &quot;\&quot;Oct 1, 2017\&quot;,2521.20&quot;,
                      &quot;\&quot;Sep 1, 2017\&quot;,2474.42&quot;,
                      &quot;\&quot;Aug 1, 2017\&quot;,2477.10&quot;,
                      &quot;\&quot;Jul 1, 2017\&quot;,2431.39&quot;,
                      &quot;\&quot;Jun 1, 2017\&quot;,2430.06&quot;),
              &quot;S&amp;P 500&quot;);

  private static final Table ANIMAL_NAMES =
<span class="fc" id="L46">      Table.read()</span>
<span class="fc" id="L47">          .csv(</span>
<span class="fc" id="L48">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L49">                  .join(</span>
                      &quot;Animal,Name&quot;,
                      &quot;Pig,Bob&quot;,
                      &quot;Pig,James&quot;,
                      &quot;Horse,David&quot;,
                      &quot;Goat,Samantha&quot;,
                      &quot;Tigon,Rudhrani&quot;,
                      &quot;Rabbit,Taylor&quot;),
              &quot;Animal Names&quot;);

  private static final Table ANIMAL_FEED =
<span class="fc" id="L60">      Table.read()</span>
<span class="fc" id="L61">          .csv(</span>
<span class="fc" id="L62">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L63">                  .join(</span>
                      &quot;Animal,Feed&quot;,
                      &quot;Pig,Mush&quot;,
                      &quot;Horse,Hay&quot;,
                      &quot;Goat,Anything&quot;,
                      &quot;Guanaco,Grass&quot;,
                      &quot;Monkey,Banana&quot;),
              &quot;Animal Feed&quot;);

  private static final Table DOUBLE_INDEXED_PEOPLE =
<span class="fc" id="L73">      Table.read()</span>
<span class="fc" id="L74">          .csv(</span>
<span class="fc" id="L75">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L76">                  .join(&quot;ID,Name&quot;, &quot;1.1,Bob&quot;, &quot;2.1,James&quot;, &quot;3.0,David&quot;, &quot;4.0,Samantha&quot;),</span>
              &quot;People&quot;);

  private static final Table DOUBLE_INDEXED_DOGS =
<span class="fc" id="L80">      Table.read()</span>
<span class="fc" id="L81">          .csv(</span>
<span class="fc" id="L82">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L83">                  .join(&quot;ID,Dog Name&quot;, &quot;1.1,Spot&quot;, &quot;3.0,Fido&quot;, &quot;4.0,Sasha&quot;, &quot;5.0,King&quot;),</span>
              &quot;Dogs&quot;);

  private static final Table DOUBLE_INDEXED_CATS =
<span class="fc" id="L87">      Table.read()</span>
<span class="fc" id="L88">          .csv(</span>
<span class="fc" id="L89">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L90">                  .join(&quot;ID,Cat Name&quot;, &quot;1.1,Spot2&quot;, &quot;2.1,Fido&quot;, &quot;6.0,Sasha&quot;, &quot;8.0,King2&quot;),</span>
              &quot;Cats&quot;);

  private static final Table DOUBLE_INDEXED_FISH =
<span class="fc" id="L94">      Table.read()</span>
<span class="fc" id="L95">          .csv(</span>
<span class="fc" id="L96">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L97">                  .join(&quot;ID,Fish Name&quot;, &quot;11.1,Spot3&quot;, &quot;2.1,Fido&quot;, &quot;4.0,Sasha&quot;, &quot;6.0,King2&quot;),</span>
              &quot;Fish&quot;);

  private static final Table DOUBLE_INDEXED_MICE =
<span class="fc" id="L101">      Table.read()</span>
<span class="fc" id="L102">          .csv(</span>
<span class="fc" id="L103">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L104">                  .join(&quot;ID,Mice_Name&quot;, &quot;2.1,Jerry&quot;, &quot;3.0,Fido&quot;, &quot;6.0,Sasha&quot;, &quot;9.0,Market&quot;),</span>
              &quot;Mice&quot;);

  private static final Table DOUBLE_INDEXED_BIRDS =
<span class="fc" id="L108">      Table.read()</span>
<span class="fc" id="L109">          .csv(</span>
<span class="fc" id="L110">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L111">                  .join(&quot;ID,Bird_Name&quot;, &quot;2.1,JerryB&quot;, &quot;3.0,FidoB&quot;, &quot;6.25,SashaB&quot;, &quot;9.0,Market&quot;),</span>
              &quot;Birds&quot;);

<span class="fc" id="L114">  private static final Table DUPLICATE_COL_NAME_DOGS =</span>
<span class="fc" id="L115">      Table.read()</span>
<span class="fc" id="L116">          .csv(</span>
<span class="fc" id="L117">              Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L118">                  .join(</span>
                      &quot;ID,Dog Name, Good&quot;,
                      &quot;1.1,Spot,true&quot;,
                      &quot;3.0,Fido,true&quot;,
                      &quot;4.0,Sasha,true&quot;,
                      &quot;5.0,King,true&quot;,
                      &quot;1.1,Spot,false&quot;,
                      &quot;3.0,Fido,false&quot;,
                      &quot;4.0,Sasha,false&quot;,
                      &quot;5.0,King,false&quot;),
              &quot;Dogs&quot;);

  private static Table createHOUSE() {
<span class="fc" id="L131">    return Table.read()</span>
<span class="fc" id="L132">        .csv(</span>
<span class="fc" id="L133">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L134">                .join(</span>
                    &quot;Style,Bedrooms,BuildDate,Owner&quot;,
                    &quot;Colonial,3,1976-06-02,Smith&quot;,
                    &quot;Gambrel,4,1982-11-18,Jones&quot;,
                    &quot;Contemporary,5,1980-03-24,White&quot;,
                    &quot;Split,2,1970-09-30,Brown&quot;),
            &quot;House&quot;);
  }

  private static Table createBOAT() {
<span class="fc" id="L144">    return Table.read()</span>
<span class="fc" id="L145">        .csv(</span>
<span class="fc" id="L146">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L147">                .join(</span>
                    &quot;Type,Bedrooms,SoldDate,Owner&quot;,
                    &quot;Yacht,2,1970-02-03,Jones&quot;,
                    &quot;Dinghy,0,1988-12-12,Trump&quot;,
                    &quot;HouseBoat,3,1981-04-21,Smith&quot;,
                    &quot;Contemporary,5,1980-05-17,White&quot;,
                    &quot;Cruise,200,1989-01-23,Brown&quot;),
            &quot;Boat&quot;);
  }

  private static Table createHOUSE10() {
<span class="fc" id="L158">    return Table.read()</span>
<span class="fc" id="L159">        .csv(</span>
<span class="fc" id="L160">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L161">                .join(</span>
                    &quot;Style,Bedrooms,BuildDate,Owner&quot;,
                    &quot;Colonial,3,1976-06-02,Smith&quot;,
                    &quot;Gambrel,4,1982-11-18,Jones&quot;,
                    &quot;Contemporary,5,1980-03-24,White&quot;,
                    &quot;Ranch,4,1982-11-18,Black&quot;,
                    &quot;Victorian,5,1980-03-24,Red&quot;,
                    &quot;Split,2,1970-09-30,Brown&quot;),
            &quot;House10&quot;);
  }

  private static Table createBOAT10() {
<span class="fc" id="L173">    return Table.read()</span>
<span class="fc" id="L174">        .csv(</span>
<span class="fc" id="L175">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L176">                .join(</span>
                    &quot;Type,Bedrooms,SoldDate,Owner&quot;,
                    &quot;Yacht,2,1970-02-03,Jones&quot;,
                    &quot;Dinghy,0,1988-12-12,White&quot;,
                    &quot;HouseBoat,3,1981-04-21,Smith&quot;,
                    &quot;Contemporary,5,1980-05-17,White&quot;,
                    &quot;Paddleboat,3,1981-04-21,Smith&quot;,
                    &quot;Rowboat,5,1980-05-17,White&quot;,
                    &quot;Sailboat,4,1980-05-17,Black&quot;,
                    &quot;Cruise,200,1989-01-23,Brown&quot;),
            &quot;Boat10&quot;);
  }

  private static Table createBEDANDBREAKFAST() {
<span class="fc" id="L190">    return Table.read()</span>
<span class="fc" id="L191">        .csv(</span>
<span class="fc" id="L192">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L193">                .join(</span>
                    &quot;Design,Bedrooms,SoldDate,Owner&quot;,
                    &quot;Colonial,5,1980-05-17,Smith&quot;,
                    &quot;Gambrel,4,1982-11-18,Jones&quot;,
                    &quot;Contemporary,5,1980-03-24,White&quot;,
                    &quot;Split,2,1970-09-30,Brown&quot;),
            &quot;BedAndBreakfast&quot;);
  }

  private static Table createSTUDENT() {
<span class="fc" id="L203">    return Table.read()</span>
<span class="fc" id="L204">        .csv(</span>
<span class="fc" id="L205">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L206">                .join(</span>
                    &quot;ID,FirstName,LastName,City,State,Age,USID,GradYear&quot;,
                    &quot;1,Bob,Barney,Burke,VA,20,11122,2019&quot;,
                    &quot;2,Chris,Cabello,Canyonville,OR,20,22224,2019&quot;,
                    &quot;3,Dan,Dirble,Denver,CO,21,33335,2020&quot;,
                    &quot;4,Edward,Earhardt,Easterly,WA,21,44339,2021&quot;,
                    &quot;5,Frank,Farnsworth,Fredriksburg,VA,22,55338,2019&quot;,
                    &quot;6,George,Gabral,Garrisburg,MD,22,66337,2020&quot;,
                    &quot;7,Michael,Marbury,Milton,NH,23,77330,2020&quot;,
                    &quot;8,Robert,Riley,Roseburg,OR,23,88836,2020&quot;,
                    &quot;9,Bob,Earhardt,Milton,NH,24,93333,2019&quot;,
                    &quot;10,Dan,Gabral,Easterly,WA,24,13333,2020&quot;),
            &quot;Student&quot;);
  }

  private static Table createINSTRUCTOR() {
<span class="fc" id="L222">    return Table.read()</span>
<span class="fc" id="L223">        .csv(</span>
<span class="fc" id="L224">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L225">                .join(</span>
                    &quot;ID,First,Last,Title,City,State,Age,USID,GradYear&quot;,
                    &quot;1,Bob,Cabello,Prof,Burke,VA,20,11333,2019&quot;,
                    &quot;2,Chris,Barney,TA,Canyonville,OR,20,22334,2019&quot;,
                    &quot;3,Dan,Earhardt,Instructor,Denver,CO,19,33335,2020&quot;,
                    &quot;4,Edward,Dirble,Prof,Easterly,WA,22,43339,2020&quot;,
                    &quot;5,Farnsworth,Frank,Prof,Fredriksburg,VA,18,55338,2019&quot;,
                    &quot;6,Gabral,George,TA,Garrisburg,MD,20,66337,2019&quot;,
                    &quot;7,Robert,Marbury,TA,Msilton,NH,22,73330,2020&quot;,
                    &quot;8,Michael,Riley,TA,Roseburg,OR,22,88336,2020&quot;,
                    &quot;9,Bob,Riley,Prof,Milton,NH,19,99933,2020&quot;,
                    &quot;10,Earhardt,Gabral,Prof,Easterly,WA,21,13333,2019&quot;),
            &quot;Instructor&quot;);
  }

  private static Table createDEPTHEAD() {
<span class="fc" id="L241">    return Table.read()</span>
<span class="fc" id="L242">        .csv(</span>
<span class="fc" id="L243">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L244">                .join(</span>
                    &quot;ID,First,Last,Dept,City,State,Age&quot;,
                    &quot;1,John,Cabello,ComputerScience,Burke,VA,20&quot;,
                    &quot;2,Samantha,Barney,Writing,Canyonville,OR,21&quot;,
                    &quot;3,Mark,Earhardt,Mathematics,Denver,CO,22&quot;,
                    &quot;4,Christie,Dirble,Architecture,Easterly,WA,23&quot;,
                    &quot;5,Bhawesh,Frank,Psychology,Fredriksburg,VA,24&quot;,
                    &quot;6,Robert,George,Sociology,Garrisburg,MD,25&quot;,
                    &quot;7,George,Marbury,Physics,Msilton,NH,26&quot;,
                    &quot;8,Zhongyu,Riley,Chemistry,Roseburg,OR,27&quot;,
                    &quot;9,Laura,Riley,Economics,Milton,NH,28&quot;,
                    &quot;10,Sally,Gabral,Marketing,Easterly,WA,29&quot;),
            &quot;DepartmentHead&quot;);
  }

  private static Table createCLASS() {
<span class="fc" id="L260">    return Table.read()</span>
<span class="fc" id="L261">        .csv(</span>
<span class="fc" id="L262">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L263">                .join(</span>
                    &quot;ID,ClassType,Name,Level,Description,StartDate,EndDate,Completed,Age&quot;,
                    &quot;1001,Math,Calculus,101,Newton math,2018-09-20,2018-12-17,false,16&quot;,
                    &quot;1002,Math,Calculus,102,Newton math,2019-01-06,2019-03-06,false,17&quot;,
                    &quot;1003,Math,Calculus,103,Newton math,2019-03-10,2019-06-17,false,18&quot;,
                    &quot;1004,Writing,Composition,101,Writing papers,2018-09-20,2018-12-17,false,19&quot;,
                    &quot;1005,Writing,Composition,102,Writing papers,2019-01-06,2019-03-07,false,20&quot;,
                    &quot;1006,Software,Programming,101,Programming basics,2018-09-22,2018-12-15,false,21&quot;,
                    &quot;1007,Software,Programming,102,Programming basics,2019-01-05,2019-03-07,false,22&quot;,
                    &quot;1008,Economics,Microeconomics,101,Basic micro economics,2018-09-20,2018-12-17,false,23&quot;,
                    &quot;1009,Economics,Microeconomics,102,Basic micro economics,2018-01-05,2019-03-07,false,24&quot;,
                    &quot;1010,Literature,Shakespeare,101,Understanding Shakespeare,2018-09-20,2018-12-17,false,25&quot;),
            &quot;Class&quot;);
  }

  private static Table createANIMALHOMES() {
<span class="fc" id="L279">    return Table.read()</span>
<span class="fc" id="L280">        .csv(</span>
<span class="fc" id="L281">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L282">                .join(</span>
                    &quot;Animal,Name,Home,Age,MoveInDate&quot;,
                    &quot;Pig,Bob,Sty,5,5/5/2018&quot;,
                    &quot;Horse,James,Field,5,6/6/2018&quot;,
                    &quot;Goat,Samantha,Tree,10,7/7/2018&quot;,
                    &quot;Tigon,Rudhrani,Jungle,2,2/2/2018&quot;,
                    &quot;Chicken,Chuck,Pen,2,1/1/2018&quot;,
                    &quot;Squirrel,Sidney,Tree,10,3/3/2018&quot;,
                    &quot;Fox,Frankie,Forest,10,9/19/2018&quot;,
                    &quot;Rabbit,Taylor,Forest,10,4/4/2018&quot;),
            &quot;Animal Homes&quot;);
  }

  private static Table createTREE() {
<span class="fc" id="L296">    return Table.read()</span>
<span class="fc" id="L297">        .csv(</span>
<span class="fc" id="L298">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L299">                .join(</span>
                    &quot;Name,Home,Age&quot;,
                    &quot;Cherry,Frontyard,2&quot;,
                    &quot;Walnut,Field,3&quot;,
                    &quot;Birch,Forest,4&quot;,
                    &quot;Tallgreen,Jungle,5&quot;,
                    &quot;Apple,Orchard,6&quot;,
                    &quot;Orange,Orchard,9&quot;,
                    &quot;Hemlock,Forest,10&quot;),
            &quot;Tree&quot;);
  }

  private static Table createFLOWER() {
<span class="fc" id="L312">    return Table.read()</span>
<span class="fc" id="L313">        .csv(</span>
<span class="fc" id="L314">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L315">                .join(</span>
                    &quot;Name,Home,Age,Color&quot;,
                    &quot;Lily,Backyard,2,White&quot;,
                    &quot;VenusFlyTrap,Swamp,2,White&quot;,
                    &quot;Rose,Frontyard,4,Red&quot;,
                    &quot;Pansie,Meadow,5,Blue&quot;,
                    &quot;Daisy,Meadow,6,Yellow&quot;,
                    &quot;Dandelion,Field,7,Yellow&quot;,
                    &quot;Violet,Forest,10,Blue&quot;),
            &quot;Flower&quot;);
  }

  private static Table createDOUBLEINDEXEDPEOPLENicknameDwellingYearsMoveInDate() {
<span class="fc" id="L328">    return Table.read()</span>
<span class="fc" id="L329">        .csv(</span>
<span class="fc" id="L330">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L331">                .join(</span>
                    &quot;ID,Nickname,Dwelling,Years,MoveInDate&quot;,
                    &quot;1.1,Bob,Jungle,5,2/2/2018&quot;,
                    &quot;2.1,James,Field,5,6/6/2018&quot;,
                    &quot;3.0,David,Jungle,5,6/6/2018&quot;,
                    &quot;4.0,Marty,Forest,10,2/2/2018&quot;,
                    &quot;5.0,Tarzan,Jungle,10,7/7/2018&quot;,
                    &quot;6.0,Samantha,Tree,10,5/5/2018&quot;),
            &quot;People - Nickname Dwelling Years MoveInDate&quot;);
  }

  private static Table createDOUBLEINDEXEDPEOPLENameDwellingYearsMoveInDate() {
<span class="fc" id="L343">    return Table.read()</span>
<span class="fc" id="L344">        .csv(</span>
<span class="fc" id="L345">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L346">                .join(</span>
                    &quot;ID,Name,Dwelling,Years,MoveInDate&quot;,
                    &quot;1.1,Bob,Jungle,5,2/2/2018&quot;,
                    &quot;2.1,James,Field,5,6/6/2018&quot;,
                    &quot;3.0,David,Jungle,5,6/6/2018&quot;,
                    &quot;4.0,Marty,Jungle,10,2/2/2018&quot;,
                    &quot;5.0,Tarzan,Jungle,10,7/7/2018&quot;,
                    &quot;6.0,Samantha,Tree,10,5/5/2018&quot;),
            &quot;People - Name Dwelling Years MoveInDate&quot;);
  }

  private static Table createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate() {
<span class="fc" id="L358">    return Table.read()</span>
<span class="fc" id="L359">        .csv(</span>
<span class="fc" id="L360">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L361">                .join(</span>
                    &quot;ID,Name,HOME,Age,MoveInDate&quot;,
                    &quot;1.1,Bob,Jungle,5,2/2/2018&quot;,
                    &quot;2.1,James,Field,5,6/6/2018&quot;,
                    &quot;3.0,David,Jungle,5,6/6/2018&quot;,
                    &quot;4.0,Marty,Jungle,10,2/2/2018&quot;,
                    &quot;5.0,Tarzan,Jungle,10,7/7/2018&quot;,
                    &quot;6.0,Samantha,Forest,10,5/5/2018&quot;),
            &quot;People - Name Home Age MoveInDate&quot;);
  }

  private static Table createFOOTBALLSCHEDULE() {
<span class="fc" id="L373">    return Table.read()</span>
<span class="fc" id="L374">        .csv(</span>
<span class="fc" id="L375">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L376">                .join(</span>
                    &quot;TeamName,PlayDate,PlayTime,Location,HomeGame&quot;,
                    &quot;Lancers,2018-09-10,15:30,Springfield,true&quot;,
                    &quot;Tigers,2018-09-12,15:00,Detroit,false&quot;,
                    &quot;Patriots,2018-09-14,14:30,Boston,true&quot;,
                    &quot;Ravens,2018-09-10,12:30,Baltimore,true&quot;),
            &quot;FootballSchedule&quot;);
  }

  private static Table createSOCCERSCHEDULE() {
<span class="fc" id="L386">    return Table.read()</span>
<span class="fc" id="L387">        .csv(</span>
<span class="fc" id="L388">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L389">                .join(</span>
                    &quot;Mascot,PlayDate,PlayTime,Place&quot;,
                    &quot;Steelers,2018-09-10,15:30,Pittsburgh&quot;,
                    &quot;Dolphins,2018-09-12,15:00,Miami&quot;,
                    &quot;Patriots,2018-09-13,14:30,Boston&quot;,
                    &quot;Yankees,2018-09-10,12:00,NewYorkCity&quot;),
            &quot;SoccerSchedule&quot;);
  }

  private static Table createFOOTBALLSCHEDULEDateTime() {
<span class="fc" id="L399">    return Table.read()</span>
<span class="fc" id="L400">        .csv(</span>
<span class="fc" id="L401">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L402">                .join(</span>
                    &quot;TeamName,PlayDateTime,Location,HomeGame,SeasonRevenue,AllTimeRevenue&quot;,
                    &quot;Lancers,2018-09-10T15:30,Springfield,true,2000000000,8500000000000&quot;,
                    &quot;Tigers,2018-09-12T15:00,Detroit,false,1500000000,9000000000000&quot;,
                    &quot;Patriots,2018-09-14T14:30,Boston,true,1400000000,8200000000000&quot;,
                    &quot;Ravens,2018-09-10T12:30,Baltimore,true,2000000000,7000000000000&quot;),
            &quot;FootballSchedule2&quot;);
  }

  private static Table createBASEBALLSCHEDULEDateTime() {
<span class="fc" id="L412">    return Table.read()</span>
<span class="fc" id="L413">        .csv(</span>
<span class="fc" id="L414">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L415">                .join(</span>
                    &quot;TeamName,PlayDateTime,Location,HomeGame,SeasonRevenue,AllTimeRevenue&quot;,
                    &quot;RedSox,2018-09-10T15:30,Springfield,false,2000000000,7000000000000&quot;,
                    &quot;Marlins,2018-09-12T15:00,Detroit,true,1500000000,8500000000000&quot;,
                    &quot;Mariners,2018-09-14T14:30,Boston,true,1400000000,9000000000000&quot;,
                    &quot;Ravens,2018-09-10T12:30,Baltimore,false,2000000000,7000000000000&quot;),
            &quot;FootballSchedule2&quot;);
  }

  private static Table createSOCCERSCHEDULEDateTime() {
<span class="fc" id="L425">    return Table.read()</span>
<span class="fc" id="L426">        .csv(</span>
<span class="fc" id="L427">            Joiner.on(System.lineSeparator())</span>
<span class="fc" id="L428">                .join(</span>
                    &quot;Mascot,PlayDateTime,Place,SeasonRevenue,AllTimeRevenue&quot;,
                    &quot;Steelers,2018-09-10T15:30,Pittsburgh,2000000000,7500000000000&quot;,
                    &quot;Dolphins,2018-09-12T15:00,Miami,1500000000,8200000000000&quot;,
                    &quot;Patriots,2018-09-13T14:30,Boston,1500000000,9000000000000&quot;,
                    &quot;Yankees,2018-09-10T12:00,NewYorkCity,1300000000,7000000000000&quot;),
            &quot;SoccerSchedule2&quot;);
  }

  @Test
  public void innerJoinWithDoubleBirdsCatsFishDouble() {
<span class="fc" id="L439">    Table joined =</span>
<span class="fc" id="L440">        DOUBLE_INDEXED_BIRDS.joinOn(&quot;ID&quot;).inner(DOUBLE_INDEXED_CATS, DOUBLE_INDEXED_FISH);</span>
<span class="fc" id="L441">    assertEquals(4, joined.columnCount());</span>
<span class="fc" id="L442">    assertEquals(1, joined.rowCount());</span>
<span class="fc" id="L443">  }</span>

  @Test
  public void innerJoinWithDoubleDogsCatsBirdsDouble() {
<span class="fc" id="L447">    Table joined =</span>
<span class="fc" id="L448">        DOUBLE_INDEXED_FISH.joinOn(&quot;ID&quot;).inner(DOUBLE_INDEXED_CATS, DOUBLE_INDEXED_BIRDS);</span>
<span class="fc" id="L449">    assertEquals(4, joined.columnCount());</span>
<span class="fc" id="L450">    assertEquals(1, joined.rowCount());</span>
<span class="fc" id="L451">  }</span>

  @Test
  public void innerJoinWithDoubleDogsCatsFishVarargs() {
<span class="fc" id="L455">    Table joined = DOUBLE_INDEXED_MICE.joinOn(&quot;ID&quot;).inner(DOUBLE_INDEXED_CATS, DOUBLE_INDEXED_FISH);</span>
<span class="fc" id="L456">    assertEquals(4, joined.columnCount());</span>
<span class="fc" id="L457">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L458">  }</span>

  @Test
  public void innerJoinWithDoublesSimple() {
<span class="fc" id="L462">    Table joined = DOUBLE_INDEXED_PEOPLE.joinOn(&quot;ID&quot;).inner(DOUBLE_INDEXED_DOGS);</span>
<span class="fc" id="L463">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L464">    assertEquals(3, joined.rowCount());</span>
<span class="fc" id="L465">    assertEquals(3, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L466">  }</span>

  @Test
  public void innerJoinWithDoubles() {
<span class="fc" id="L470">    Table joined = DOUBLE_INDEXED_PEOPLE.joinOn(&quot;ID&quot;).inner(DOUBLE_INDEXED_DOGS, &quot;ID&quot;);</span>
<span class="fc" id="L471">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L472">    assertEquals(3, joined.rowCount());</span>
<span class="fc" id="L473">  }</span>

  @Test
  public void innerJoinWithDuplicateColumnNames() {
<span class="fc" id="L477">    Table table1 =</span>
<span class="fc" id="L478">        DUPLICATE_COL_NAME_DOGS.where(DUPLICATE_COL_NAME_DOGS.booleanColumn(&quot;Good&quot;).isTrue());</span>
<span class="fc" id="L479">    Table table2 =</span>
<span class="fc" id="L480">        DUPLICATE_COL_NAME_DOGS.where(DUPLICATE_COL_NAME_DOGS.booleanColumn(&quot;Good&quot;).isFalse());</span>

<span class="fc" id="L482">    Table joined = table1.joinOn(&quot;ID&quot;).inner(table2, &quot;ID&quot;, true);</span>
<span class="fc" id="L483">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L484">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L485">  }</span>

  @Test
  public void rightOuterJoinWithDuplicateColumnNames() {
<span class="fc" id="L489">    Table table1 =</span>
<span class="fc" id="L490">        DUPLICATE_COL_NAME_DOGS.where(DUPLICATE_COL_NAME_DOGS.booleanColumn(&quot;Good&quot;).isTrue());</span>
<span class="fc" id="L491">    Table table2 =</span>
<span class="fc" id="L492">        DUPLICATE_COL_NAME_DOGS.where(DUPLICATE_COL_NAME_DOGS.booleanColumn(&quot;Good&quot;).isFalse());</span>

<span class="fc" id="L494">    Table joined = table1.joinOn(&quot;ID&quot;).rightOuter(table2, true, &quot;ID&quot;);</span>
<span class="fc" id="L495">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L496">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L497">  }</span>

  @Test
  public void leftOuterJoinWithDuplicateColumnNames() {
<span class="fc" id="L501">    Table table1 =</span>
<span class="fc" id="L502">        DUPLICATE_COL_NAME_DOGS.where(DUPLICATE_COL_NAME_DOGS.booleanColumn(&quot;Good&quot;).isTrue());</span>
<span class="fc" id="L503">    Table table2 =</span>
<span class="fc" id="L504">        DUPLICATE_COL_NAME_DOGS.where(DUPLICATE_COL_NAME_DOGS.booleanColumn(&quot;Good&quot;).isFalse());</span>

<span class="fc" id="L506">    Table joined = table1.joinOn(&quot;ID&quot;).leftOuter(table2, true, &quot;ID&quot;);</span>
<span class="fc" id="L507">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L508">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L509">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L510">  }</span>

  @Test
  public void leftOuterJoinWithDoubles() {
<span class="fc" id="L514">    Table joined = DOUBLE_INDEXED_PEOPLE.joinOn(&quot;ID&quot;).leftOuter(DOUBLE_INDEXED_DOGS, &quot;ID&quot;);</span>
<span class="fc" id="L515">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L516">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L517">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L518">  }</span>

  @Test
  public void rightOuterJoinWithDoubles() {
<span class="fc" id="L522">    Table joined = DOUBLE_INDEXED_PEOPLE.joinOn(&quot;ID&quot;).rightOuter(DOUBLE_INDEXED_DOGS, &quot;ID&quot;);</span>
<span class="fc" id="L523">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L524">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L525">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L526">  }</span>

  @Test
  public void rightOuterJoinWithDoubles2() {
<span class="fc" id="L530">    Table joined = DOUBLE_INDEXED_PEOPLE.joinOn(&quot;ID&quot;).rightOuter(DOUBLE_INDEXED_DOGS);</span>
<span class="fc" id="L531">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L532">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L533">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L534">  }</span>

  @Test
  public void rightOuterJoinWithDoubles3() {
<span class="fc" id="L538">    Table joined =</span>
<span class="fc" id="L539">        DOUBLE_INDEXED_PEOPLE.joinOn(&quot;ID&quot;).rightOuter(DOUBLE_INDEXED_DOGS, DOUBLE_INDEXED_CATS);</span>
<span class="fc" id="L540">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L541">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L542">  }</span>

  @Test
  public void leftOuterJoinWithDoubles2() {
<span class="fc" id="L546">    Table joined = DOUBLE_INDEXED_DOGS.joinOn(&quot;ID&quot;).leftOuter(DOUBLE_INDEXED_PEOPLE, &quot;ID&quot;);</span>
<span class="fc" id="L547">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L548">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L549">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L550">  }</span>

  @Test
  public void leftOuterJoinWithDoubles3() {
<span class="fc" id="L554">    Table joined = DOUBLE_INDEXED_DOGS.joinOn(&quot;ID&quot;).leftOuter(DOUBLE_INDEXED_PEOPLE);</span>
<span class="fc" id="L555">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L556">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L557">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L558">  }</span>

  @Test
  public void leftOuterJoinWithDoubles4() {
<span class="fc" id="L562">    Table joined =</span>
<span class="fc" id="L563">        DOUBLE_INDEXED_DOGS.joinOn(&quot;ID&quot;).leftOuter(DOUBLE_INDEXED_PEOPLE, DOUBLE_INDEXED_CATS);</span>
<span class="fc" id="L564">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L565">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L566">    assertEquals(4, joined.column(&quot;ID&quot;).size());</span>
<span class="fc" id="L567">  }</span>

  @Test
  public void innerJoin() {
<span class="fc" id="L571">    Table joined = SP500.joinOn(&quot;Date&quot;).inner(ONE_YEAR, &quot;Date&quot;);</span>
<span class="fc" id="L572">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L573">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L574">  }</span>

  @Test
  public void innerJoinSingleColumn() {
<span class="fc" id="L578">    Table joined = SP500.select(&quot;Date&quot;).joinOn(&quot;Date&quot;).inner(ONE_YEAR.select(&quot;Date&quot;));</span>
<span class="fc" id="L579">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L580">    assertEquals(1, joined.columnCount());</span>
<span class="fc" id="L581">  }</span>

  @Test
  public void innerJoinSingleColumnOnRight() {
<span class="fc" id="L585">    Table joined = SP500.joinOn(&quot;Date&quot;).inner(ONE_YEAR.select(&quot;Date&quot;));</span>
<span class="fc" id="L586">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L587">    assertEquals(2, joined.columnCount());</span>
<span class="fc" id="L588">  }</span>

  @Test
  public void innerJoinMultipleColumnsAllColumnsInJoinKey() {
<span class="fc" id="L592">    Table table1 =</span>
<span class="fc" id="L593">        Table.create(SP500.dateColumn(&quot;Date&quot;), SP500.dateColumn(&quot;Date&quot;).copy().setName(&quot;Date2&quot;));</span>
<span class="fc" id="L594">    Table table2 =</span>
<span class="fc" id="L595">        Table.create(</span>
<span class="fc" id="L596">            ONE_YEAR.dateColumn(&quot;Date&quot;), ONE_YEAR.dateColumn(&quot;Date&quot;).copy().setName(&quot;Date2&quot;));</span>

<span class="fc" id="L598">    Table joined = table1.joinOn(&quot;Date&quot;, &quot;Date2&quot;).inner(table2);</span>
<span class="fc" id="L599">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L600">    assertEquals(2, joined.columnCount());</span>
<span class="fc" id="L601">  }</span>

  @Test
  public void innerJoinWithBoolean() {
<span class="fc" id="L605">    Table joined =</span>
<span class="fc" id="L606">        DUPLICATE_COL_NAME_DOGS.joinOn(&quot;Good&quot;).inner(true, DUPLICATE_COL_NAME_DOGS.copy());</span>
<span class="fc" id="L607">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L608">    assertEquals(32, joined.rowCount());</span>
<span class="fc" id="L609">  }</span>

  @Test
  public void leftOuterJoin() {
<span class="fc" id="L613">    Table joined = SP500.joinOn(&quot;Date&quot;).leftOuter(ONE_YEAR, &quot;Date&quot;);</span>
<span class="fc" id="L614">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L615">    assertEquals(6, joined.rowCount());</span>
<span class="fc" id="L616">    assertEquals(6, joined.column(&quot;Date&quot;).size());</span>
<span class="fc" id="L617">  }</span>

  @Test
  public void innerJoinDuplicateKeysFirstTable() {
<span class="fc" id="L621">    Table joined = ANIMAL_NAMES.joinOn(&quot;Animal&quot;).inner(ANIMAL_FEED, &quot;Animal&quot;);</span>
<span class="fc" id="L622">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L623">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L624">  }</span>

  @Test
  public void leftOuterJoinDuplicateKeysFirstTable() {
<span class="fc" id="L628">    Table joined = ANIMAL_NAMES.joinOn(&quot;Animal&quot;).leftOuter(ANIMAL_FEED, &quot;Animal&quot;);</span>
<span class="fc" id="L629">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L630">    assertEquals(6, joined.rowCount());</span>
<span class="fc" id="L631">    assertEquals(6, joined.column(&quot;Animal&quot;).size());</span>
<span class="fc" id="L632">  }</span>

  @Test
  public void innerJoinDuplicateKeysSecondTable() {
<span class="fc" id="L636">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).inner(ANIMAL_NAMES, &quot;Animal&quot;);</span>
<span class="fc" id="L637">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L638">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L639">  }</span>

  @Test
  public void innerJoinDuplicateKeysSecondTableWithTextColumn() {
<span class="fc" id="L643">    Table feed = ANIMAL_FEED.copy();</span>
<span class="fc" id="L644">    Table names = ANIMAL_NAMES.copy();</span>
<span class="fc" id="L645">    feed.replaceColumn(&quot;Animal&quot;, feed.stringColumn(&quot;Animal&quot;).asTextColumn());</span>
<span class="fc" id="L646">    TextColumn nameCol = names.stringColumn(&quot;Animal&quot;).asTextColumn();</span>
<span class="fc" id="L647">    nameCol = nameCol.where(Selection.withRange(0, feed.rowCount()));</span>
<span class="fc" id="L648">    feed.replaceColumn(&quot;Animal&quot;, nameCol);</span>
<span class="fc" id="L649">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).inner(ANIMAL_NAMES, &quot;Animal&quot;);</span>
<span class="fc" id="L650">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L651">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L652">  }</span>

  @Test
  public void leftOuterJoinDuplicateKeysSecondTable() {
<span class="fc" id="L656">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).leftOuter(ANIMAL_NAMES, &quot;Animal&quot;);</span>
<span class="fc" id="L657">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L658">    assertEquals(6, joined.rowCount());</span>
<span class="fc" id="L659">    assertEquals(6, joined.column(&quot;Animal&quot;).size());</span>
<span class="fc" id="L660">  }</span>

  @Test
  public void fullOuterJoinJustTable() {
<span class="fc" id="L664">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).fullOuter(ANIMAL_NAMES);</span>
<span class="fc" id="L665">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L666">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L667">    assertEquals(8, joined.column(&quot;Animal&quot;).size());</span>
<span class="fc" id="L668">    assertEquals(0, joined.column(&quot;Animal&quot;).countMissing());</span>
<span class="fc" id="L669">    assertEquals(8, joined.column(&quot;Name&quot;).size());</span>
<span class="fc" id="L670">    assertEquals(2, joined.column(&quot;Name&quot;).countMissing());</span>
<span class="fc" id="L671">    assertEquals(8, joined.column(&quot;Feed&quot;).size());</span>
<span class="fc" id="L672">    assertEquals(2, joined.column(&quot;Feed&quot;).countMissing());</span>
<span class="fc" id="L673">  }</span>

  @Test
  public void fullOuterJoin() {
<span class="fc" id="L677">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).fullOuter(ANIMAL_NAMES, &quot;Animal&quot;);</span>
<span class="fc" id="L678">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L679">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L680">    assertEquals(8, joined.column(&quot;Animal&quot;).size());</span>
<span class="fc" id="L681">    assertEquals(0, joined.column(&quot;Animal&quot;).countMissing());</span>
<span class="fc" id="L682">    assertEquals(8, joined.column(&quot;Name&quot;).size());</span>
<span class="fc" id="L683">    assertEquals(2, joined.column(&quot;Name&quot;).countMissing());</span>
<span class="fc" id="L684">    assertEquals(8, joined.column(&quot;Feed&quot;).size());</span>
<span class="fc" id="L685">    assertEquals(2, joined.column(&quot;Feed&quot;).countMissing());</span>
<span class="fc" id="L686">  }</span>

  @Test
  public void fullOuterJoinColTwoOnlyJoinKeys() {
<span class="fc" id="L690">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).fullOuter(ANIMAL_NAMES.select(&quot;Animal&quot;));</span>
<span class="fc" id="L691">    assertEquals(2, joined.columnCount());</span>
<span class="fc" id="L692">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L693">  }</span>

  @Test
  public void fullOuterJoinNew() {
<span class="fc" id="L697">    Table joined = ANIMAL_FEED.joinOn(&quot;Animal&quot;).fullOuter(true, ANIMAL_NAMES);</span>
<span class="fc" id="L698">    assertEquals(3, joined.columnCount());</span>
<span class="fc" id="L699">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L700">    assertEquals(8, joined.column(&quot;Animal&quot;).size());</span>
<span class="fc" id="L701">    assertEquals(0, joined.column(&quot;Animal&quot;).countMissing());</span>
<span class="fc" id="L702">    assertEquals(8, joined.column(&quot;Name&quot;).size());</span>
<span class="fc" id="L703">    assertEquals(2, joined.column(&quot;Name&quot;).countMissing());</span>
<span class="fc" id="L704">    assertEquals(8, joined.column(&quot;Feed&quot;).size());</span>
<span class="fc" id="L705">    assertEquals(2, joined.column(&quot;Feed&quot;).countMissing());</span>
<span class="fc" id="L706">  }</span>

  @Test
  public void innerJoinStudentInstructorOnAge() {
<span class="fc" id="L710">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L711">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L712">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2);</span>
<span class="pc bpc" id="L713" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L714">        .columnNames()</span>
<span class="pc bpc" id="L715" title="1 of 2 branches missed.">        .containsAll(Arrays.asList(&quot;T2.ID&quot;, &quot;T2.City&quot;, &quot;T2.State&quot;, &quot;T2.USID&quot;, &quot;T2.GradYear&quot;)));</span>
<span class="fc" id="L716">    assertEquals(16, joined.columnCount());</span>
<span class="fc" id="L717">    assertEquals(14, joined.rowCount());</span>
<span class="fc" id="L718">  }</span>

  @Test
  public void joiningShouldNotMutateColNamesOnOriginalTable() {
<span class="fc" id="L722">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L723">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L724">    List&lt;String&gt; originalColumns =</span>
<span class="fc" id="L725">        table2.columns().stream().map(Column::name).collect(Collectors.toList());</span>

<span class="fc" id="L727">    table1.joinOn(&quot;Age&quot;).inner(true, table2);</span>

<span class="fc" id="L729">    List&lt;String&gt; newColumns =</span>
<span class="fc" id="L730">        table2.columns().stream().map(Column::name).collect(Collectors.toList());</span>
<span class="fc" id="L731">    assertEquals(originalColumns, newColumns);</span>
<span class="fc" id="L732">  }</span>

  @Test
  public void innerJoinInstructorStudentOnAge() {
<span class="fc" id="L736">    Table table1 = createINSTRUCTOR();</span>
<span class="fc" id="L737">    Table table2 = createSTUDENT();</span>
<span class="fc" id="L738">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2);</span>
<span class="pc bpc" id="L739" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L740">        .columnNames()</span>
<span class="pc bpc" id="L741" title="1 of 2 branches missed.">        .containsAll(Arrays.asList(&quot;T2.ID&quot;, &quot;T2.City&quot;, &quot;T2.State&quot;, &quot;T2.USID&quot;, &quot;T2.GradYear&quot;)));</span>
<span class="fc" id="L742">    assertEquals(16, joined.columnCount());</span>
<span class="fc" id="L743">    assertEquals(14, joined.rowCount());</span>
<span class="fc" id="L744">  }</span>

  @Test
  public void innerJoinStudentInstructorClassOnAge() {
<span class="fc" id="L748">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L749">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L750">    Table table3 = createCLASS();</span>
<span class="fc" id="L751">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2, table3);</span>
<span class="pc bpc" id="L752" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L753">        .columnNames()</span>
<span class="pc bpc" id="L754" title="1 of 2 branches missed.">        .containsAll(</span>
<span class="fc" id="L755">            Arrays.asList(&quot;T2.ID&quot;, &quot;T2.City&quot;, &quot;T2.State&quot;, &quot;T2.USID&quot;, &quot;T2.GradYear&quot;, &quot;T3.ID&quot;)));</span>
<span class="fc" id="L756">    assertEquals(24, joined.columnCount());</span>
<span class="fc" id="L757">    assertEquals(14, joined.rowCount());</span>
<span class="fc" id="L758">  }</span>

  @Test
  public void innerJoinStudentInstructorClassDeptHeadOnAge() {
<span class="fc" id="L762">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L763">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L764">    Table table3 = createCLASS();</span>
<span class="fc" id="L765">    Table table4 = createDEPTHEAD();</span>
<span class="fc" id="L766">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2, table3, table4);</span>
<span class="pc bpc" id="L767" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L768">        .columnNames()</span>
<span class="pc bpc" id="L769" title="1 of 2 branches missed.">        .containsAll(</span>
<span class="fc" id="L770">            Arrays.asList(</span>
                &quot;T2.ID&quot;,
                &quot;T2.City&quot;,
                &quot;T2.State&quot;,
                &quot;T2.USID&quot;,
                &quot;T2.GradYear&quot;,
                &quot;T3.ID&quot;,
                &quot;T4.ID&quot;,
                &quot;T4.First&quot;,
                &quot;T4.Last&quot;,
                &quot;T4.City&quot;,
                &quot;T4.State&quot;)));
<span class="fc" id="L782">    assertEquals(30, joined.columnCount());</span>
<span class="fc" id="L783">    assertEquals(14, joined.rowCount());</span>
<span class="fc" id="L784">  }</span>

  @Test
  public void innerJoinStudentInstructorDeptHeadOnStateAge() {
<span class="fc" id="L788">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L789">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L790">    Table table3 = createDEPTHEAD();</span>
<span class="fc" id="L791">    Table joined = table1.joinOn(&quot;State&quot;, &quot;Age&quot;).inner(true, table2, table3);</span>
<span class="pc bpc" id="L792" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L793">        .columnNames()</span>
<span class="pc bpc" id="L794" title="1 of 2 branches missed.">        .containsAll(</span>
<span class="fc" id="L795">            Arrays.asList(</span>
                &quot;T2.ID&quot;,
                &quot;T2.City&quot;,
                &quot;T2.USID&quot;,
                &quot;T2.GradYear&quot;,
                &quot;T3.ID&quot;,
                &quot;T3.First&quot;,
                &quot;T3.Last&quot;,
                &quot;T3.City&quot;)));
<span class="fc" id="L804">    assertEquals(20, joined.columnCount());</span>
<span class="fc" id="L805">    assertEquals(1, joined.rowCount());</span>
<span class="fc" id="L806">  }</span>

  @Test
  public void innerJoinStudentInstructorOnStateAge() {
<span class="fc" id="L810">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L811">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L812">    Table joined = table1.joinOn(&quot;State&quot;, &quot;Age&quot;).inner(true, table2);</span>
<span class="fc" id="L813">    assertEquals(15, joined.columnCount());</span>
<span class="fc" id="L814">    assertEquals(3, joined.rowCount());</span>
<span class="fc" id="L815">  }</span>

  @Test
  public void innerJoinStudentInstructorOnStateAgeGradYear() {
<span class="fc" id="L819">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L820">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L821">    Table joined = table1.joinOn(&quot;State&quot;, &quot;Age&quot;, &quot;GradYear&quot;).inner(true, table2);</span>
<span class="fc" id="L822">    assertEquals(14, joined.columnCount());</span>
<span class="fc" id="L823">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L824">  }</span>

  @Test
  public void leftJoinStudentInstructorOnStateAge() {
<span class="fc" id="L828">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L829">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L830">    Table joined = table1.joinOn(&quot;State&quot;, &quot;Age&quot;).leftOuter(true, table2);</span>
<span class="fc" id="L831">    assertEquals(15, joined.columnCount());</span>
<span class="fc" id="L832">    assertEquals(10, joined.rowCount());</span>
<span class="fc" id="L833">    assertEquals(10, joined.column(&quot;State&quot;).size());</span>
<span class="fc" id="L834">    assertEquals(10, joined.column(&quot;Age&quot;).size());</span>
<span class="fc" id="L835">  }</span>

  @Test
  public void innerJoinHouseBoatOnBedroomsOwner() {
<span class="fc" id="L839">    Table table1 = createHOUSE();</span>
<span class="fc" id="L840">    Table table2 = createBOAT();</span>
<span class="fc" id="L841">    Table joined =</span>
<span class="fc" id="L842">        table1.joinOn(&quot;Bedrooms&quot;, &quot;Owner&quot;).inner(table2, new String[] {&quot;Bedrooms&quot;, &quot;Owner&quot;});</span>
<span class="fc" id="L843">    assertEquals(6, joined.columnCount());</span>
<span class="fc" id="L844">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L845">    assertEquals(2, joined.column(&quot;Bedrooms&quot;).size());</span>
<span class="fc" id="L846">  }</span>

  @Test
  public void innerJoinHouseBoatOnStyleTypeBedroomsOwner() {
<span class="fc" id="L850">    Table table1 = createHOUSE();</span>
<span class="fc" id="L851">    Table table2 = createBOAT();</span>
<span class="fc" id="L852">    Table joined =</span>
        table1
<span class="fc" id="L854">            .joinOn(&quot;Style&quot;, &quot;Bedrooms&quot;, &quot;Owner&quot;)</span>
<span class="fc" id="L855">            .inner(table2, new String[] {&quot;Type&quot;, &quot;Bedrooms&quot;, &quot;Owner&quot;});</span>
<span class="fc" id="L856">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L857">    assertEquals(1, joined.rowCount());</span>
<span class="fc" id="L858">  }</span>

  @Test
  public void fullJoinHouseBoatOnBedroomsOwner() {
<span class="fc" id="L862">    Table table1 = createHOUSE();</span>
<span class="fc" id="L863">    Table table2 = createBOAT();</span>
<span class="fc" id="L864">    Table joined = table1.joinOn(&quot;Bedrooms&quot;, &quot;Owner&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L865">    assertEquals(6, joined.columnCount());</span>
<span class="fc" id="L866">    assertEquals(7, joined.rowCount());</span>
<span class="fc" id="L867">    assertEquals(7, joined.column(&quot;Style&quot;).size());</span>
<span class="fc" id="L868">    assertEquals(3, joined.column(&quot;Style&quot;).countMissing());</span>
<span class="fc" id="L869">    assertEquals(7, joined.column(&quot;Bedrooms&quot;).size());</span>
<span class="fc" id="L870">    assertEquals(0, joined.column(&quot;Bedrooms&quot;).countMissing());</span>
<span class="fc" id="L871">    assertEquals(7, joined.column(&quot;BuildDate&quot;).size());</span>
<span class="fc" id="L872">    assertEquals(3, joined.column(&quot;BuildDate&quot;).countMissing());</span>
<span class="fc" id="L873">    assertEquals(7, joined.column(&quot;Owner&quot;).size());</span>
<span class="fc" id="L874">    assertEquals(0, joined.column(&quot;Owner&quot;).countMissing());</span>
<span class="fc" id="L875">    assertEquals(7, joined.column(&quot;Type&quot;).size());</span>
<span class="fc" id="L876">    assertEquals(2, joined.column(&quot;Type&quot;).countMissing());</span>
<span class="fc" id="L877">    assertEquals(7, joined.column(&quot;SoldDate&quot;).size());</span>
<span class="fc" id="L878">    assertEquals(2, joined.column(&quot;SoldDate&quot;).countMissing());</span>
<span class="fc" id="L879">  }</span>

  @Test
  public void fullJoinHouse10Boat10OnBedroomsOwner() {
<span class="fc" id="L883">    Table table1 = createHOUSE10();</span>
<span class="fc" id="L884">    Table table2 = createBOAT10();</span>
<span class="fc" id="L885">    Table joined = table1.joinOn(&quot;Bedrooms&quot;, &quot;Owner&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L886">    assertEquals(6, joined.columnCount());</span>
<span class="fc" id="L887">    assertEquals(11, joined.rowCount());</span>
<span class="fc" id="L888">    assertEquals(11, joined.column(&quot;Bedrooms&quot;).size());</span>
<span class="fc" id="L889">    assertEquals(0, joined.column(&quot;Bedrooms&quot;).countMissing());</span>
<span class="fc" id="L890">    assertEquals(11, joined.column(&quot;Bedrooms&quot;).size());</span>
<span class="fc" id="L891">    assertEquals(0, joined.column(&quot;Bedrooms&quot;).countMissing());</span>
<span class="fc" id="L892">    assertEquals(11, joined.column(&quot;BuildDate&quot;).size());</span>
<span class="fc" id="L893">    assertEquals(3, joined.column(&quot;BuildDate&quot;).countMissing());</span>
<span class="fc" id="L894">    assertEquals(11, joined.column(&quot;Owner&quot;).size());</span>
<span class="fc" id="L895">    assertEquals(0, joined.column(&quot;Owner&quot;).countMissing());</span>
<span class="fc" id="L896">    assertEquals(11, joined.column(&quot;Type&quot;).size());</span>
<span class="fc" id="L897">    assertEquals(3, joined.column(&quot;Type&quot;).countMissing());</span>
<span class="fc" id="L898">    assertEquals(11, joined.column(&quot;SoldDate&quot;).size());</span>
<span class="fc" id="L899">    assertEquals(3, joined.column(&quot;SoldDate&quot;).countMissing());</span>
<span class="fc" id="L900">  }</span>

  @Test
  public void fullJoinBnBBoat10OnBedroomsOwner() {
<span class="fc" id="L904">    Table table1 = createBEDANDBREAKFAST();</span>
<span class="fc" id="L905">    Table table2 = createBOAT10();</span>
<span class="fc" id="L906">    Table joined = table1.joinOn(&quot;Bedrooms&quot;, &quot;SoldDate&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L907">    assertEquals(6, joined.columnCount());</span>
<span class="fc" id="L908">    assertEquals(11, joined.rowCount());</span>
<span class="fc" id="L909">    assertEquals(11, joined.column(&quot;Design&quot;).size());</span>
<span class="fc" id="L910">    assertEquals(6, joined.column(&quot;Design&quot;).countMissing());</span>
<span class="fc" id="L911">    assertEquals(11, joined.column(&quot;Bedrooms&quot;).size());</span>
<span class="fc" id="L912">    assertEquals(0, joined.column(&quot;Bedrooms&quot;).countMissing());</span>
<span class="fc" id="L913">    assertEquals(11, joined.column(&quot;SoldDate&quot;).size());</span>
<span class="fc" id="L914">    assertEquals(0, joined.column(&quot;SoldDate&quot;).countMissing());</span>
<span class="fc" id="L915">    assertEquals(11, joined.column(&quot;Owner&quot;).size());</span>
<span class="fc" id="L916">    assertEquals(6, joined.column(&quot;Owner&quot;).countMissing());</span>
<span class="fc" id="L917">    assertEquals(11, joined.column(&quot;Type&quot;).size());</span>
<span class="fc" id="L918">    assertEquals(3, joined.column(&quot;Type&quot;).countMissing());</span>
<span class="fc" id="L919">    assertEquals(11, joined.column(&quot;T2.Owner&quot;).size());</span>
<span class="fc" id="L920">    assertEquals(3, joined.column(&quot;T2.Owner&quot;).countMissing());</span>
<span class="fc" id="L921">  }</span>

  @Test
  public void leftJoinHouseBoatOnBedroomsOwner() {
<span class="fc" id="L925">    Table table1 = createHOUSE();</span>
<span class="fc" id="L926">    Table table2 = createBOAT();</span>
<span class="fc" id="L927">    Table joined =</span>
<span class="fc" id="L928">        table1.joinOn(&quot;Bedrooms&quot;, &quot;Owner&quot;).leftOuter(table2, new String[] {&quot;Bedrooms&quot;, &quot;Owner&quot;});</span>
<span class="fc" id="L929">    assertEquals(6, joined.columnCount());</span>
<span class="fc" id="L930">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L931">  }</span>

  @Test
  public void leftJoinHouseBoatBnBOnStyleTypeBedroomsOwner() {
<span class="fc" id="L935">    Table table1 = createHOUSE();</span>
<span class="fc" id="L936">    Table table2 = createBOAT();</span>
<span class="fc" id="L937">    Table joined =</span>
        table1
<span class="fc" id="L939">            .joinOn(&quot;Style&quot;, &quot;Bedrooms&quot;, &quot;Owner&quot;)</span>
<span class="fc" id="L940">            .leftOuter(table2, new String[] {&quot;Type&quot;, &quot;Bedrooms&quot;, &quot;Owner&quot;});</span>
<span class="fc" id="L941">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L942">    assertEquals(4, joined.rowCount());</span>
<span class="fc" id="L943">  }</span>

  @Test
  public void rightJoinHouseBoatOnBedroomsOwner() {
<span class="fc" id="L947">    Table table1 = createHOUSE();</span>
<span class="fc" id="L948">    Table table2 = createBOAT();</span>
<span class="fc" id="L949">    Table joined =</span>
<span class="fc" id="L950">        table1.joinOn(&quot;Bedrooms&quot;, &quot;Owner&quot;).rightOuter(table2, new String[] {&quot;Bedrooms&quot;, &quot;Owner&quot;});</span>
<span class="fc" id="L951">    assertEquals(6, joined.columnCount());</span>
<span class="fc" id="L952">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L953">  }</span>

  @Test
  public void rightJoinHouseBoatOnStyleTypeBedroomsOwner() {
<span class="fc" id="L957">    Table table1 = createHOUSE();</span>
<span class="fc" id="L958">    Table table2 = createBOAT();</span>
<span class="fc" id="L959">    Table joined =</span>
        table1
<span class="fc" id="L961">            .joinOn(&quot;Style&quot;, &quot;Bedrooms&quot;, &quot;Owner&quot;)</span>
<span class="fc" id="L962">            .rightOuter(table2, new String[] {&quot;Type&quot;, &quot;Bedrooms&quot;, &quot;Owner&quot;});</span>
<span class="fc" id="L963">    assertEquals(5, joined.columnCount());</span>
<span class="fc" id="L964">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L965">  }</span>

  @Test
  public void rightJoinStudentInstructorOnStateAge() {
<span class="fc" id="L969">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L970">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L971">    Table joined = table1.joinOn(&quot;State&quot;, &quot;Age&quot;).rightOuter(true, table2);</span>
<span class="fc" id="L972">    assertEquals(15, joined.columnCount());</span>
<span class="fc" id="L973">    assertEquals(10, joined.rowCount());</span>
<span class="fc" id="L974">  }</span>

  @Test
  public void innerJoinStudentInstructorOnStateName() {
<span class="fc" id="L978">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L979">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L980">    Table joined = table1.joinOn(&quot;State&quot;, &quot;FirstName&quot;).inner(table2, true, &quot;State&quot;, &quot;First&quot;);</span>
<span class="fc" id="L981">    assertEquals(15, joined.columnCount());</span>
<span class="fc" id="L982">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L983">  }</span>

  @Test
  public void leftJoinStudentInstructorOnStateName() {
<span class="fc" id="L987">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L988">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L989">    Table joined = table1.joinOn(&quot;State&quot;, &quot;FirstName&quot;).leftOuter(table2, true, &quot;State&quot;, &quot;First&quot;);</span>
<span class="fc" id="L990">    assertEquals(15, joined.columnCount());</span>
<span class="fc" id="L991">    assertEquals(10, joined.rowCount());</span>
<span class="fc" id="L992">  }</span>

  @Test
  public void rightJoinStudentInstructorOnStateName() {
<span class="fc" id="L996">    Table table1 = createSTUDENT();</span>
<span class="fc" id="L997">    Table table2 = createINSTRUCTOR();</span>
<span class="fc" id="L998">    Table joined = table1.joinOn(&quot;State&quot;, &quot;FirstName&quot;).rightOuter(table2, true, &quot;State&quot;, &quot;First&quot;);</span>
<span class="fc" id="L999">    assertEquals(15, joined.columnCount());</span>
<span class="fc" id="L1000">    assertEquals(10, joined.rowCount());</span>
<span class="fc" id="L1001">  }</span>

  @Test
  public void innerJoinOnAge() {
<span class="fc" id="L1005">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1006">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1007">    Table joined = table1.joinOn(&quot;Age&quot;).inner(table2, &quot;Age&quot;, true);</span>
<span class="fc" id="L1008">    assertEquals(9, joined.columnCount());</span>
<span class="fc" id="L1009">    assertEquals(18, joined.rowCount());</span>
<span class="fc" id="L1010">  }</span>

  @Test
  public void innerJoinAnimalPeopleOnAge() {
<span class="fc" id="L1014">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1015">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1016">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2);</span>
<span class="fc" id="L1017">    assertEquals(9, joined.columnCount());</span>
<span class="fc" id="L1018">    assertEquals(18, joined.rowCount());</span>
<span class="fc" id="L1019">  }</span>

  @Test
  public void innerJoinAnimalTreeOnAge() {
<span class="fc" id="L1023">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1024">    Table table2 = createTREE();</span>
<span class="fc" id="L1025">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2);</span>
<span class="fc" id="L1026">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1027">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L1028">  }</span>

  @Test
  public void innerJoinAnimalPeopleTreeOnAge() {
<span class="fc" id="L1032">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1033">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1034">    Table table3 = createTREE();</span>
<span class="fc" id="L1035">    Table table4 = createFLOWER();</span>
<span class="fc" id="L1036">    Table joined = table1.joinOn(&quot;Age&quot;).inner(true, table2, table3, table4);</span>
<span class="pc bpc" id="L1037" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L1038">        .columnNames()</span>
<span class="pc bpc" id="L1039" title="1 of 2 branches missed.">        .containsAll(</span>
<span class="fc" id="L1040">            Arrays.asList(</span>
                &quot;T2.Name&quot;,
                &quot;T2.HOME&quot;,
                &quot;T2.MoveInDate&quot;,
                &quot;T3.Name&quot;,
                &quot;T3.Home&quot;,
                &quot;T4.Name&quot;,
                &quot;T4.Home&quot;,
                &quot;Color&quot;)));
<span class="fc" id="L1049">    assertEquals(14, joined.columnCount());</span>
<span class="fc" id="L1050">    assertEquals(18, joined.rowCount());</span>
<span class="fc" id="L1051">  }</span>

  @Test
  public void innerJoinAnimalPeopleTreeOnAgeHome() {
<span class="fc" id="L1055">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1056">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1057">    Table table3 = createTREE();</span>
<span class="fc" id="L1058">    Table table4 = createFLOWER();</span>
<span class="fc" id="L1059">    Table joined = table1.joinOn(&quot;Age&quot;, &quot;Home&quot;).inner(true, table2, table3, table4);</span>
<span class="pc bpc" id="L1060" title="1 of 2 branches missed.">    assert (joined</span>
<span class="fc" id="L1061">        .columnNames()</span>
<span class="pc bpc" id="L1062" title="1 of 2 branches missed.">        .containsAll(</span>
<span class="fc" id="L1063">            Arrays.asList(</span>
                &quot;Animal&quot;,
                &quot;Name&quot;,
                &quot;Home&quot;,
                &quot;Age&quot;,
                &quot;MoveInDate&quot;,
                &quot;ID&quot;,
                &quot;T2.Name&quot;,
                &quot;T2.MoveInDate&quot;,
                &quot;T3.Name&quot;,
                &quot;T4.Name&quot;,
                &quot;Color&quot;)));
<span class="fc" id="L1075">    assertEquals(11, joined.columnCount());</span>
<span class="fc" id="L1076">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L1077">  }</span>

  @Test
  public void innerJoinOnNameHomeAge() {
<span class="fc" id="L1081">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1082">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1083">    Table joined = table1.joinOn(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;).inner(true, table2);</span>
<span class="fc" id="L1084">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1085">    assertEquals(1, joined.rowCount());</span>
<span class="fc" id="L1086">  }</span>

  @Test
  public void innerJoinOnAllMismatchedColNames() {
<span class="fc" id="L1090">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1091">    Table table2 = createDOUBLEINDEXEDPEOPLENicknameDwellingYearsMoveInDate();</span>
<span class="fc" id="L1092">    Table joined =</span>
<span class="fc" id="L1093">        table1.joinOn(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;).inner(table2, true, &quot;Nickname&quot;, &quot;Dwelling&quot;, &quot;Years&quot;);</span>
<span class="fc" id="L1094">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1095">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L1096">  }</span>

  @Test
  public void innerJoinOnPartiallyMismatchedColNames() {
<span class="fc" id="L1100">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1101">    Table table2 = createDOUBLEINDEXEDPEOPLENameDwellingYearsMoveInDate();</span>
<span class="fc" id="L1102">    Table joined =</span>
<span class="fc" id="L1103">        table1.joinOn(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;).inner(table2, true, &quot;Name&quot;, &quot;Dwelling&quot;, &quot;Years&quot;);</span>
<span class="pc bpc" id="L1104" title="2 of 4 branches missed.">    assert (joined.columnNames().containsAll(Arrays.asList(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;)));</span>
<span class="fc" id="L1105">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1106">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L1107">  }</span>

  @Test
  public void leftOuterJoinOnPartiallyMismatchedColNames() {
<span class="fc" id="L1111">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1112">    Table table2 = createDOUBLEINDEXEDPEOPLENameDwellingYearsMoveInDate();</span>
<span class="fc" id="L1113">    Table joined =</span>
<span class="fc" id="L1114">        table1.joinOn(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;).leftOuter(table2, true, &quot;Name&quot;, &quot;Dwelling&quot;, &quot;Years&quot;);</span>
<span class="pc bpc" id="L1115" title="2 of 4 branches missed.">    assert (joined.columnNames().containsAll(Arrays.asList(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;)));</span>
<span class="fc" id="L1116">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1117">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L1118">  }</span>

  @Test
  public void rightOuterJoinOnPartiallyMismatchedColNames() {
<span class="fc" id="L1122">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1123">    Table table2 = createDOUBLEINDEXEDPEOPLENameDwellingYearsMoveInDate();</span>
<span class="fc" id="L1124">    Table joined =</span>
<span class="fc" id="L1125">        table1.joinOn(&quot;Name&quot;, &quot;Home&quot;, &quot;Age&quot;).rightOuter(table2, true, &quot;Name&quot;, &quot;Dwelling&quot;, &quot;Years&quot;);</span>
<span class="pc bpc" id="L1126" title="2 of 4 branches missed.">    assert (joined.columnNames().containsAll(Arrays.asList(&quot;Name&quot;, &quot;Dwelling&quot;, &quot;Years&quot;)));</span>
<span class="fc" id="L1127">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1128">    assertEquals(6, joined.rowCount());</span>
<span class="fc" id="L1129">  }</span>

  @Test
  public void innerJoinOnAgeMoveInDate() {
<span class="fc" id="L1133">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1134">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1135">    Table joined = table1.joinOn(&quot;Age&quot;, &quot;MoveInDate&quot;).inner(true, table2);</span>
<span class="fc" id="L1136">    assertEquals(8, joined.columnCount());</span>
<span class="fc" id="L1137">    assertEquals(3, joined.rowCount());</span>
<span class="fc" id="L1138">  }</span>

  @Test
  public void leftOuterJoinOnAgeMoveInDate() {
<span class="fc" id="L1142">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1143">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1144">    Table joined = table1.joinOn(&quot;Age&quot;, &quot;MoveInDate&quot;).leftOuter(true, table2);</span>
<span class="fc" id="L1145">    assertEquals(8, joined.columnCount());</span>
<span class="fc" id="L1146">    assertEquals(9, joined.rowCount());</span>
<span class="fc" id="L1147">  }</span>

  @Test
  public void rightOuterJoinOnAgeMoveInDate() {
<span class="fc" id="L1151">    Table table1 = createANIMALHOMES();</span>
<span class="fc" id="L1152">    Table table2 = createDOUBLEINDEXEDPEOPLENameHomeAgeMoveInDate();</span>
<span class="fc" id="L1153">    Table joined = table1.joinOn(&quot;Age&quot;, &quot;MoveInDate&quot;).rightOuter(true, table2);</span>
<span class="fc" id="L1154">    assertEquals(8, joined.columnCount());</span>
<span class="fc" id="L1155">    assertEquals(6, joined.rowCount());</span>
<span class="fc" id="L1156">  }</span>

  @Test
  public void innerJoinFootballSoccerOnPlayDate() {
<span class="fc" id="L1160">    Table table1 = createFOOTBALLSCHEDULE();</span>
<span class="fc" id="L1161">    Table table2 = createSOCCERSCHEDULE();</span>
<span class="fc" id="L1162">    Table joined = table1.joinOn(&quot;PlayDate&quot;).inner(true, table2);</span>
<span class="fc" id="L1163">    assertEquals(8, joined.columnCount());</span>
<span class="fc" id="L1164">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L1165">  }</span>

  @Test
  public void innerJoinFootballSoccerOnPlayTime() {
<span class="fc" id="L1169">    Table table1 = createFOOTBALLSCHEDULE();</span>
<span class="fc" id="L1170">    Table table2 = createSOCCERSCHEDULE();</span>
<span class="fc" id="L1171">    Table joined = table1.joinOn(&quot;PlayTime&quot;).inner(true, table2);</span>
<span class="fc" id="L1172">    assertEquals(8, joined.columnCount());</span>
<span class="fc" id="L1173">    assertEquals(3, joined.rowCount());</span>
<span class="fc" id="L1174">  }</span>

  @Test
  public void innerJoinFootballSoccerOnPlayDatePlayTime() {
<span class="fc" id="L1178">    Table table1 = createFOOTBALLSCHEDULE();</span>
<span class="fc" id="L1179">    Table table2 = createSOCCERSCHEDULE();</span>
<span class="fc" id="L1180">    Table joined = table1.joinOn(&quot;PlayDate&quot;, &quot;PlayTime&quot;).inner(true, table2);</span>
<span class="fc" id="L1181">    assertEquals(7, joined.columnCount());</span>
<span class="fc" id="L1182">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L1183">  }</span>

  @Test
  public void fullOuterJoinFootballSoccerOnPlayTime() {
<span class="fc" id="L1187">    Table table1 = createFOOTBALLSCHEDULE();</span>
<span class="fc" id="L1188">    Table table2 = createSOCCERSCHEDULE();</span>
<span class="fc" id="L1189">    Table joined = table1.joinOn(&quot;PlayTime&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L1190">    assertEquals(8, joined.columnCount());</span>
<span class="fc" id="L1191">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L1192">  }</span>

  @Test
  public void innerJoinFootballSoccerOnPlayDatePlayDateTime() {
<span class="fc" id="L1196">    Table table1 = createFOOTBALLSCHEDULEDateTime();</span>
<span class="fc" id="L1197">    Table table2 = createSOCCERSCHEDULEDateTime();</span>
<span class="fc" id="L1198">    Table joined = table1.joinOn(&quot;PlayDateTime&quot;).inner(true, table2);</span>
<span class="fc" id="L1199">    assertEquals(10, joined.columnCount());</span>
<span class="fc" id="L1200">    assertEquals(2, joined.rowCount());</span>
<span class="fc" id="L1201">  }</span>

  @Test
  public void innerJoinFootballSoccerOnSeasonRevenue() {
<span class="fc" id="L1205">    Table table1 = createFOOTBALLSCHEDULEDateTime();</span>
<span class="fc" id="L1206">    Table table2 = createSOCCERSCHEDULEDateTime();</span>
<span class="fc" id="L1207">    Table joined = table1.joinOn(&quot;SeasonRevenue&quot;, &quot;AllTimeRevenue&quot;).inner(true, table2);</span>
<span class="fc" id="L1208">    assertEquals(9, joined.columnCount());</span>
<span class="fc" id="L1209">    assertEquals(1, joined.rowCount());</span>
<span class="fc" id="L1210">  }</span>

  @Test
  public void fullOuterJoinFootballSoccerOnPlayDateTimeSeasonRevenue() {
<span class="fc" id="L1214">    Table table1 = createFOOTBALLSCHEDULEDateTime();</span>
<span class="fc" id="L1215">    Table table2 = createSOCCERSCHEDULEDateTime();</span>
<span class="fc" id="L1216">    Table joined = table1.joinOn(&quot;PlayDateTime&quot;, &quot;SeasonRevenue&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L1217">    assertEquals(9, joined.columnCount());</span>
<span class="fc" id="L1218">    assertEquals(6, joined.rowCount());</span>
<span class="fc" id="L1219">    assertEquals(6, joined.column(&quot;TeamName&quot;).size());</span>
<span class="fc" id="L1220">    assertEquals(2, joined.column(&quot;TeamName&quot;).countMissing());</span>
<span class="fc" id="L1221">    assertEquals(6, joined.column(&quot;PlayDateTime&quot;).size());</span>
<span class="fc" id="L1222">    assertEquals(0, joined.column(&quot;PlayDateTime&quot;).countMissing());</span>
<span class="fc" id="L1223">    assertEquals(6, joined.column(&quot;Location&quot;).size());</span>
<span class="fc" id="L1224">    assertEquals(2, joined.column(&quot;Location&quot;).countMissing());</span>
<span class="fc" id="L1225">    assertEquals(6, joined.column(&quot;HomeGame&quot;).size());</span>
<span class="fc" id="L1226">    assertEquals(2, joined.column(&quot;HomeGame&quot;).countMissing());</span>
<span class="fc" id="L1227">    assertEquals(6, joined.column(&quot;SeasonRevenue&quot;).size());</span>
<span class="fc" id="L1228">    assertEquals(0, joined.column(&quot;SeasonRevenue&quot;).countMissing());</span>
<span class="fc" id="L1229">    assertEquals(6, joined.column(&quot;Mascot&quot;).size());</span>
<span class="fc" id="L1230">    assertEquals(2, joined.column(&quot;Mascot&quot;).countMissing());</span>
<span class="fc" id="L1231">    assertEquals(6, joined.column(&quot;Place&quot;).size());</span>
<span class="fc" id="L1232">    assertEquals(2, joined.column(&quot;Place&quot;).countMissing());</span>
<span class="fc" id="L1233">  }</span>

  @Test
  public void fullOuterJoinFootballSoccerOnPlayDateTimeAllTimeRevenue() {
<span class="fc" id="L1237">    Table table1 = createFOOTBALLSCHEDULEDateTime();</span>
<span class="fc" id="L1238">    Table table2 = createSOCCERSCHEDULEDateTime();</span>
<span class="fc" id="L1239">    Table joined = table1.joinOn(&quot;AllTimeRevenue&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L1240">    assertEquals(10, joined.columnCount());</span>
<span class="fc" id="L1241">    assertEquals(5, joined.rowCount());</span>
<span class="fc" id="L1242">    assertEquals(5, joined.column(&quot;TeamName&quot;).size());</span>
<span class="fc" id="L1243">    assertEquals(1, joined.column(&quot;TeamName&quot;).countMissing());</span>
<span class="fc" id="L1244">    assertEquals(5, joined.column(&quot;PlayDateTime&quot;).size());</span>
<span class="fc" id="L1245">    assertEquals(1, joined.column(&quot;PlayDateTime&quot;).countMissing());</span>
<span class="fc" id="L1246">    assertEquals(5, joined.column(&quot;Location&quot;).size());</span>
<span class="fc" id="L1247">    assertEquals(1, joined.column(&quot;Location&quot;).countMissing());</span>
<span class="fc" id="L1248">    assertEquals(5, joined.column(&quot;HomeGame&quot;).size());</span>
<span class="fc" id="L1249">    assertEquals(1, joined.column(&quot;HomeGame&quot;).countMissing());</span>
<span class="fc" id="L1250">    assertEquals(5, joined.column(&quot;SeasonRevenue&quot;).size());</span>
<span class="fc" id="L1251">    assertEquals(1, joined.column(&quot;SeasonRevenue&quot;).countMissing());</span>
<span class="fc" id="L1252">    assertEquals(5, joined.column(&quot;AllTimeRevenue&quot;).size());</span>
<span class="fc" id="L1253">    assertEquals(0, joined.column(&quot;AllTimeRevenue&quot;).countMissing());</span>
<span class="fc" id="L1254">    assertEquals(5, joined.column(&quot;Mascot&quot;).size());</span>
<span class="fc" id="L1255">    assertEquals(1, joined.column(&quot;Mascot&quot;).countMissing());</span>
<span class="fc" id="L1256">    assertEquals(5, joined.column(&quot;T2.PlayDateTime&quot;).size());</span>
<span class="fc" id="L1257">    assertEquals(1, joined.column(&quot;T2.PlayDateTime&quot;).countMissing());</span>
<span class="fc" id="L1258">    assertEquals(5, joined.column(&quot;Place&quot;).size());</span>
<span class="fc" id="L1259">    assertEquals(1, joined.column(&quot;Place&quot;).countMissing());</span>
<span class="fc" id="L1260">    assertEquals(5, joined.column(&quot;T2.SeasonRevenue&quot;).size());</span>
<span class="fc" id="L1261">    assertEquals(1, joined.column(&quot;T2.SeasonRevenue&quot;).countMissing());</span>
<span class="fc" id="L1262">  }</span>

  @Test
  public void fullOuterJoinFootballBaseballBoolean() {
<span class="fc" id="L1266">    Table table1 = createFOOTBALLSCHEDULE();</span>
<span class="fc" id="L1267">    Table table2 = createBASEBALLSCHEDULEDateTime();</span>
<span class="fc" id="L1268">    Table joined = table1.joinOn(&quot;HomeGame&quot;).fullOuter(true, table2);</span>
<span class="fc" id="L1269">    assertEquals(10, joined.columnCount());</span>
<span class="fc" id="L1270">    assertEquals(8, joined.rowCount());</span>
<span class="fc" id="L1271">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>