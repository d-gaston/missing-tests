<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>StringColumnTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">tablesaw_core$All_in_tablesaw_core.exec</a> &gt; <a href="index.source.html" class="el_package">tech.tablesaw.api</a> &gt; <span class="el_source">StringColumnTest.java</span></div><h1>StringColumnTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package tech.tablesaw.api;

import static org.junit.jupiter.api.Assertions.*;
import static tech.tablesaw.columns.strings.StringPredicates.isEqualToIgnoringCase;

import java.util.Arrays;
import java.util.List;
import java.util.function.Function;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import tech.tablesaw.TestDataUtil;
import tech.tablesaw.columns.strings.StringColumnFormatter;
import tech.tablesaw.selection.Selection;

<span class="fc" id="L29">class StringColumnTest {</span>

<span class="fc" id="L31">  private final StringColumn column = StringColumn.create(&quot;testing&quot;);</span>

  @BeforeEach
  void setUp() {
<span class="fc" id="L35">    column.append(&quot;Value 1&quot;);</span>
<span class="fc" id="L36">    column.append(&quot;Value 2&quot;);</span>
<span class="fc" id="L37">    column.append(&quot;Value 3&quot;);</span>
<span class="fc" id="L38">    column.append(&quot;Value 4&quot;);</span>
<span class="fc" id="L39">  }</span>

  /*
  TODO: fix
      @Test
      void testSummarizeIf() {
          double result = column.summarizeIf(
                  column.endsWith(&quot;3&quot;).or(column.endsWith(&quot;4&quot;)),
                  count);
          assertEquals(2, result, 0.0);

          double result2 = column.summarizeIf(column.endsWith(&quot;3&quot;), count);
          assertEquals(1, result2, 0.0);
      }
  */

  @Test
  void testAppendObj2() {
<span class="fc" id="L57">    final StringColumn sc = StringColumn.create(&quot;sc&quot;, Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;));</span>
<span class="fc" id="L58">    assertArrayEquals(sc.asList().toArray(), sc.asObjectArray());</span>
<span class="fc" id="L59">  }</span>

  @Test
  void testForNulls() {
<span class="fc" id="L63">    String[] array1 = {&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, null};</span>
<span class="fc" id="L64">    Table table1 = Table.create(&quot;table1&quot;, StringColumn.create(&quot;id&quot;, array1));</span>
<span class="fc" id="L65">    assertEquals(&quot;&quot;, table1.stringColumn(&quot;id&quot;).get(4));</span>

<span class="fc" id="L67">    String[] array2 = {&quot;1&quot;, &quot;2&quot;, null, &quot;&quot;, &quot;5&quot;};</span>
<span class="fc" id="L68">    Table table2 = Table.create(&quot;table2&quot;, StringColumn.create(&quot;id&quot;, array2));</span>
<span class="fc" id="L69">    assertEquals(&quot;&quot;, table2.stringColumn(&quot;id&quot;).get(3));</span>
<span class="fc" id="L70">  }</span>

  @Test
  void testAppendObj() {
<span class="fc" id="L74">    StringColumn column = StringColumn.create(&quot;testing&quot;);</span>
<span class="fc" id="L75">    column.appendObj(&quot;Value 1&quot;);</span>
<span class="fc" id="L76">    column.appendObj(null);</span>
<span class="fc" id="L77">    column.appendObj(&quot;Value 2&quot;);</span>
<span class="fc" id="L78">    assertEquals(3, column.size());</span>
<span class="fc" id="L79">  }</span>

  @Test
  void testConditionalSet() {
<span class="fc" id="L83">    column.set(column.isEqualTo(&quot;Value 4&quot;), &quot;no Value&quot;);</span>
<span class="fc" id="L84">    assertTrue(column.contains(&quot;no Value&quot;));</span>
<span class="fc" id="L85">    assertFalse(column.contains(&quot;Value 4&quot;));</span>
<span class="fc" id="L86">  }</span>

  @Test
  void lag() {
<span class="fc" id="L90">    StringColumn c1 = column.lag(1);</span>
<span class="fc" id="L91">    Table t = Table.create(&quot;Test&quot;);</span>
<span class="fc" id="L92">    t.addColumns(column, c1);</span>
<span class="fc" id="L93">    assertEquals(&quot;&quot;, c1.get(0));</span>
<span class="fc" id="L94">    assertEquals(&quot;Value 1&quot;, c1.get(1));</span>
<span class="fc" id="L95">    assertEquals(&quot;Value 2&quot;, c1.get(2));</span>
<span class="fc" id="L96">  }</span>

  @Test
  void lag2() {
<span class="fc" id="L100">    StringColumn c1 = column.lag(-1);</span>
<span class="fc" id="L101">    Table t = Table.create(&quot;Test&quot;);</span>
<span class="fc" id="L102">    t.addColumns(column, c1);</span>
<span class="fc" id="L103">    assertEquals(&quot;Value 2&quot;, c1.get(0));</span>
<span class="fc" id="L104">    assertEquals(&quot;Value 3&quot;, c1.get(1));</span>
<span class="fc" id="L105">    assertEquals(&quot;&quot;, c1.get(3));</span>
<span class="fc" id="L106">  }</span>

  @Test
  void lead() {
<span class="fc" id="L110">    StringColumn c1 = column.lead(1);</span>
<span class="fc" id="L111">    Table t = Table.create(&quot;Test&quot;);</span>
<span class="fc" id="L112">    t.addColumns(column, c1);</span>
<span class="fc" id="L113">    assertEquals(&quot;Value 2&quot;, c1.get(0));</span>
<span class="fc" id="L114">    assertEquals(&quot;Value 3&quot;, c1.get(1));</span>
<span class="fc" id="L115">    assertEquals(&quot;&quot;, c1.get(3));</span>
<span class="fc" id="L116">  }</span>

  @Test
  void testSelectWhere() {
<span class="fc" id="L120">    StringColumn result = column.where(column.equalsIgnoreCase(&quot;VALUE 1&quot;));</span>
<span class="fc" id="L121">    assertEquals(1, result.size());</span>
<span class="fc" id="L122">  }</span>

  @Test
  void testDefaultReturnValue() {
<span class="fc" id="L126">    assertEquals(-1, column.firstIndexOf(&quot;test&quot;));</span>
<span class="fc" id="L127">  }</span>

  @Test
  void testType() {
<span class="fc" id="L131">    assertEquals(ColumnType.STRING, column.type());</span>
<span class="fc" id="L132">  }</span>

  @Test
  void testGetString() {
<span class="fc" id="L136">    assertEquals(&quot;Value 2&quot;, column.getString(1));</span>
<span class="fc" id="L137">  }</span>

  @Test
  void testSize() {
<span class="fc" id="L141">    assertEquals(4, column.size());</span>
<span class="fc" id="L142">  }</span>

  @Test
  void testGetDummies() {
<span class="fc" id="L146">    List&lt;BooleanColumn&gt; dummies = column.getDummies();</span>
<span class="fc" id="L147">    assertEquals(4, dummies.size());</span>
<span class="fc" id="L148">  }</span>

  @Test
  void testToString() {
<span class="fc" id="L152">    assertEquals(&quot;String column: testing&quot;, column.toString());</span>
<span class="fc" id="L153">  }</span>

  @Test
  void testMax() {
<span class="fc" id="L157">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L158">    stringColumn.addAll(TestDataUtil.usStates());</span>
<span class="fc" id="L159">    assertEquals(&quot;Wyoming&quot;, stringColumn.top(5).get(0));</span>
<span class="fc" id="L160">  }</span>

  @Test
  void testMin() {
<span class="fc" id="L164">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L165">    stringColumn.addAll(TestDataUtil.usStates());</span>
<span class="fc" id="L166">    assertEquals(&quot;Alabama&quot;, stringColumn.bottom(5).get(0));</span>
<span class="fc" id="L167">  }</span>

  @Test
  void testStartsWith() {
<span class="fc" id="L171">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L172">    stringColumn.addAll(TestDataUtil.usStates());</span>

<span class="fc" id="L174">    StringColumn selection = stringColumn.where(stringColumn.startsWith(&quot;A&quot;));</span>
<span class="fc" id="L175">    assertEquals(&quot;Alabama&quot;, selection.get(0));</span>
<span class="fc" id="L176">    assertEquals(&quot;Alaska&quot;, selection.get(1));</span>
<span class="fc" id="L177">    assertEquals(&quot;Arizona&quot;, selection.get(2));</span>
<span class="fc" id="L178">    assertEquals(&quot;Arkansas&quot;, selection.get(3));</span>

<span class="fc" id="L180">    selection = stringColumn.where(stringColumn.startsWith(&quot;T&quot;));</span>
<span class="fc" id="L181">    assertEquals(&quot;Tennessee&quot;, selection.get(0));</span>
<span class="fc" id="L182">    assertEquals(&quot;Texas&quot;, selection.get(1));</span>
<span class="fc" id="L183">  }</span>

  @Test
  void testFormattedPrinting() {
<span class="fc" id="L187">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L188">    stringColumn.addAll(TestDataUtil.usStates());</span>

<span class="fc" id="L190">    Function&lt;String, String&gt; formatter = s -&gt; String.format(&quot;[[%s]]&quot;, s);</span>

<span class="fc" id="L192">    stringColumn.setPrintFormatter(new StringColumnFormatter(formatter));</span>
<span class="fc" id="L193">    assertEquals(&quot;[[Alabama]]&quot;, stringColumn.getString(0));</span>
<span class="fc" id="L194">  }</span>

  @Test
  void testSelectWithFilter() {
<span class="fc" id="L198">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L199">    stringColumn.addAll(TestDataUtil.usStates());</span>

<span class="fc" id="L201">    StringColumn selection =</span>
<span class="fc" id="L202">        stringColumn.where(stringColumn.startsWith(&quot;A&quot;).and(stringColumn.containsString(&quot;kan&quot;)));</span>

<span class="fc" id="L204">    assertEquals(1, selection.size());</span>
<span class="fc" id="L205">    assertEquals(&quot;Arkansas&quot;, selection.getString(0));</span>
<span class="fc" id="L206">  }</span>

  @Test
  void testIsNotEqualTo() {
<span class="fc" id="L210">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L211">    stringColumn.addAll(TestDataUtil.usStates());</span>

<span class="fc" id="L213">    Selection selection = stringColumn.isNotEqualTo(&quot;Alabama&quot;);</span>
<span class="fc" id="L214">    StringColumn result = stringColumn.where(selection);</span>
<span class="fc" id="L215">    assertEquals(result.size(), stringColumn.size() - 1);</span>
<span class="fc" id="L216">    assertFalse(result.contains(&quot;Alabama&quot;));</span>
<span class="fc" id="L217">    assertEquals(stringColumn.size(), 51);</span>
<span class="fc" id="L218">  }</span>

  @Test
  void testColumnEqualIgnoringCase() {
<span class="fc" id="L222">    StringColumn other = column.copy();</span>
<span class="fc" id="L223">    other.set(1, &quot;Some other thing&quot;);</span>
<span class="fc" id="L224">    other.set(2, other.get(2).toUpperCase());</span>
<span class="fc" id="L225">    assertFalse(other.contains(&quot;Value 3&quot;));</span>
<span class="fc" id="L226">    assertTrue(other.contains(&quot;Value 1&quot;));</span>
<span class="fc" id="L227">    assertFalse(other.contains(&quot;Value 2&quot;));</span>
<span class="fc" id="L228">    assertTrue(other.contains(&quot;Some other thing&quot;));</span>
<span class="fc" id="L229">    assertTrue(other.contains(&quot;VALUE 3&quot;));</span>
<span class="fc" id="L230">    assertTrue(other.contains(&quot;Value 4&quot;));</span>
<span class="fc" id="L231">    assertEquals(4, other.size());</span>
<span class="fc" id="L232">    StringColumn result = column.where(column.eval(isEqualToIgnoringCase, other));</span>
<span class="fc" id="L233">    assertEquals(3, result.size());</span>
<span class="fc" id="L234">  }</span>

  @Test
  void testIsEqualTo() {
<span class="fc" id="L238">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L239">    stringColumn.addAll(TestDataUtil.usStates());</span>
<span class="fc" id="L240">    stringColumn.append(&quot;Alabama&quot;); // so we have two entries</span>
<span class="fc" id="L241">    Selection selection = stringColumn.isEqualTo(&quot;Alabama&quot;);</span>
<span class="fc" id="L242">    StringColumn result = stringColumn.where(selection);</span>

<span class="fc" id="L244">    assertEquals(2, result.size());</span>
<span class="fc" id="L245">    assertTrue(result.contains(&quot;Alabama&quot;));</span>

<span class="fc" id="L247">    Selection result2 = stringColumn.isEqualTo(&quot;Alabama&quot;);</span>
<span class="fc" id="L248">    assertEquals(2, result2.size());</span>
<span class="fc" id="L249">    stringColumn = stringColumn.where(result2);</span>
<span class="fc" id="L250">    assertTrue(stringColumn.contains(&quot;Alabama&quot;));</span>
<span class="fc" id="L251">  }</span>

  @Test
  void testIsNotEqualTo2() {
<span class="fc" id="L255">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L256">    stringColumn.addAll(TestDataUtil.usStates());</span>

<span class="fc" id="L258">    Selection selection2 = stringColumn.isNotEqualTo(&quot;Yugoslavia&quot;);</span>
<span class="fc" id="L259">    assertEquals(selection2.size(), 51);</span>
<span class="fc" id="L260">    StringColumn result2 = stringColumn.where(selection2);</span>
<span class="fc" id="L261">    assertEquals(result2.size(), stringColumn.size());</span>
<span class="fc" id="L262">  }</span>

  @Test
  void testIsIn() {
<span class="fc" id="L266">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L267">    stringColumn.addAll(TestDataUtil.usStates());</span>
<span class="fc" id="L268">    StringColumn selection = stringColumn.where(stringColumn.isIn(&quot;Alabama&quot;, &quot;Texas&quot;));</span>
<span class="fc" id="L269">    assertEquals(&quot;Alabama&quot;, selection.get(0));</span>
<span class="fc" id="L270">    assertEquals(&quot;Texas&quot;, selection.get(1));</span>
<span class="fc" id="L271">    assertEquals(2, selection.size());</span>
<span class="fc" id="L272">  }</span>

  @Test
  void testIsNotIn() {
<span class="fc" id="L276">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L277">    stringColumn.addAll(TestDataUtil.usStates());</span>
<span class="fc" id="L278">    StringColumn selection = stringColumn.where(stringColumn.isNotIn(&quot;Alabama&quot;, &quot;Texas&quot;));</span>
<span class="fc" id="L279">    assertEquals(&quot;Alaska&quot;, selection.get(0));</span>
<span class="fc" id="L280">    assertEquals(&quot;Arizona&quot;, selection.get(1));</span>
<span class="fc" id="L281">    assertEquals(&quot;Arkansas&quot;, selection.get(2));</span>
<span class="fc" id="L282">    assertEquals(49, selection.size());</span>
<span class="fc" id="L283">  }</span>

  @Test
  void testToList() {
<span class="fc" id="L287">    StringColumn stringColumn = StringColumn.create(&quot;US States&quot;);</span>
<span class="fc" id="L288">    stringColumn.addAll(TestDataUtil.usStates());</span>
<span class="fc" id="L289">    List&lt;String&gt; states = stringColumn.asList();</span>
<span class="fc" id="L290">    assertEquals(51, states.size()); // includes Wash. DC</span>
<span class="fc" id="L291">  }</span>

  @Test
  void testFormatting() {
<span class="fc" id="L295">    String[] names = {&quot;John White&quot;, &quot;George Victor&quot;};</span>
<span class="fc" id="L296">    StringColumn nameColumn = StringColumn.create(&quot;names&quot;, names);</span>
<span class="fc" id="L297">    StringColumn formatted = nameColumn.format(&quot;Name: %s&quot;);</span>
<span class="fc" id="L298">    assertEquals(&quot;Name: John White&quot;, formatted.get(0));</span>
<span class="fc" id="L299">  }</span>

  @Test
  void testDistance() {
<span class="fc" id="L303">    String[] words = {&quot;canary&quot;, &quot;banana&quot;, &quot;island&quot;, &quot;reggae&quot;};</span>
<span class="fc" id="L304">    String[] words2 = {&quot;cancel&quot;, &quot;bananas&quot;, &quot;islander&quot;, &quot;calypso&quot;};</span>
<span class="fc" id="L305">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L306">    StringColumn word2Column = StringColumn.create(&quot;words2&quot;, words2);</span>
<span class="fc" id="L307">    DoubleColumn distance = wordColumn.distance(word2Column);</span>
<span class="fc" id="L308">    assertEquals(distance.get(0), 3, 0.0001);</span>
<span class="fc" id="L309">    assertEquals(distance.get(3), 7, 0.0001);</span>
<span class="fc" id="L310">  }</span>

  @Test
  void testCommonSuffix() {
<span class="fc" id="L314">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;regular&quot;, &quot;reggae&quot;};</span>
<span class="fc" id="L315">    String[] words2 = {&quot;rowing&quot;, &quot;cube&quot;, &quot;premium&quot;, &quot;place&quot;};</span>
<span class="fc" id="L316">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L317">    StringColumn word2Column = StringColumn.create(&quot;words2&quot;, words2);</span>
<span class="fc" id="L318">    StringColumn suffix = wordColumn.commonSuffix(word2Column);</span>
<span class="fc" id="L319">    assertEquals(suffix.get(0), &quot;ing&quot;);</span>
<span class="fc" id="L320">    assertEquals(suffix.get(1), &quot;cube&quot;);</span>
<span class="fc" id="L321">    assertEquals(suffix.get(3), &quot;e&quot;);</span>
<span class="fc" id="L322">  }</span>

  @Test
  void testCommonPrefix() {
<span class="fc" id="L326">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L327">    String[] words2 = {&quot;rowing&quot;, &quot;iceland&quot;, &quot;backup&quot;};</span>
<span class="fc" id="L328">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L329">    StringColumn word2Column = StringColumn.create(&quot;words2&quot;, words2);</span>
<span class="fc" id="L330">    StringColumn result = wordColumn.commonPrefix(word2Column);</span>
<span class="fc" id="L331">    assertEquals(result.get(0), &quot;r&quot;);</span>
<span class="fc" id="L332">    assertEquals(result.get(1), &quot;ice&quot;);</span>
<span class="fc" id="L333">    assertEquals(result.get(2), &quot;back&quot;);</span>
<span class="fc" id="L334">  }</span>

  @Test
  void testPadStart() {
<span class="fc" id="L338">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L339">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L340">    StringColumn result = wordColumn.padStart(8, ' ');</span>
<span class="fc" id="L341">    assertEquals(result.get(0), &quot; running&quot;);</span>
<span class="fc" id="L342">    assertEquals(result.get(1), &quot; icecube&quot;);</span>
<span class="fc" id="L343">    assertEquals(result.get(2), &quot;    back&quot;);</span>
<span class="fc" id="L344">  }</span>

  @Test
  void testPadEnd() {
<span class="fc" id="L348">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L349">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L350">    StringColumn result = wordColumn.padEnd(8, 'X');</span>
<span class="fc" id="L351">    assertEquals(result.get(0), &quot;runningX&quot;);</span>
<span class="fc" id="L352">    assertEquals(result.get(1), &quot;icecubeX&quot;);</span>
<span class="fc" id="L353">    assertEquals(result.get(2), &quot;backXXXX&quot;);</span>
<span class="fc" id="L354">  }</span>

  @Test
  void testParseInt() {
<span class="fc" id="L358">    String[] values = {&quot;4&quot;, &quot;72&quot;, &quot;132&quot;};</span>
<span class="fc" id="L359">    StringColumn wordColumn = StringColumn.create(&quot;values&quot;, values);</span>
<span class="fc" id="L360">    IntColumn result = wordColumn.parseInt();</span>
<span class="fc" id="L361">    assertEquals(result.get(0), 4);</span>
<span class="fc" id="L362">    assertEquals(result.get(1), 72);</span>
<span class="fc" id="L363">    assertEquals(result.get(2), 132);</span>
<span class="fc" id="L364">  }</span>

  @Test
  void testParseDouble() {
<span class="fc" id="L368">    String[] values = {&quot;0.4&quot;, &quot;0.72&quot;, &quot;1.132&quot;};</span>
<span class="fc" id="L369">    StringColumn wordColumn = StringColumn.create(&quot;values&quot;, values);</span>
<span class="fc" id="L370">    DoubleColumn result = wordColumn.parseDouble();</span>
<span class="fc" id="L371">    assertEquals(result.get(0), 0.4);</span>
<span class="fc" id="L372">    assertEquals(result.get(1), 0.72);</span>
<span class="fc" id="L373">    assertEquals(result.get(2), 1.132);</span>
<span class="fc" id="L374">  }</span>

  @Test
  void testParseFloat() {
<span class="fc" id="L378">    String[] values = {&quot;0.4&quot;, &quot;0.72&quot;, &quot;1.132&quot;};</span>
<span class="fc" id="L379">    StringColumn wordColumn = StringColumn.create(&quot;values&quot;, values);</span>
<span class="fc" id="L380">    FloatColumn result = wordColumn.parseFloat();</span>
<span class="fc" id="L381">    assertEquals(result.get(0), 0.4f);</span>
<span class="fc" id="L382">    assertEquals(result.get(1), 0.72f);</span>
<span class="fc" id="L383">    assertEquals(result.get(2), 1.132f);</span>
<span class="fc" id="L384">  }</span>

  @Test
  void testSubstring() {
<span class="fc" id="L388">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L389">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L390">    StringColumn result = wordColumn.substring(3);</span>
<span class="fc" id="L391">    assertEquals(result.get(0), &quot;ning&quot;);</span>
<span class="fc" id="L392">    assertEquals(result.get(1), &quot;cube&quot;);</span>
<span class="fc" id="L393">    assertEquals(result.get(2), &quot;k&quot;);</span>
<span class="fc" id="L394">  }</span>

  @Test
  void testRepeat() {
<span class="fc" id="L398">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L399">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L400">    StringColumn result = wordColumn.repeat(3);</span>
<span class="fc" id="L401">    assertEquals(result.get(0), &quot;runningrunningrunning&quot;);</span>
<span class="fc" id="L402">  }</span>

  @Test
  void testCapitalize() {
<span class="fc" id="L406">    String[] words = {&quot;running&quot;, &quot;ice cube&quot;, &quot;stuff4us&quot;};</span>
<span class="fc" id="L407">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L408">    StringColumn result = wordColumn.capitalize();</span>
<span class="fc" id="L409">    assertEquals(result.get(0), &quot;Running&quot;);</span>
<span class="fc" id="L410">    assertEquals(result.get(1), &quot;Ice cube&quot;);</span>
<span class="fc" id="L411">    assertEquals(result.get(2), &quot;Stuff4us&quot;);</span>
<span class="fc" id="L412">  }</span>

  @Test
  void testConcatinate() {
<span class="fc" id="L416">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L417">    StringColumn wordColumn1 = StringColumn.create(&quot;words1&quot;, words);</span>
<span class="fc" id="L418">    StringColumn wordColumn2 = StringColumn.create(&quot;words2&quot;, words);</span>
<span class="fc" id="L419">    StringColumn result = wordColumn1.concatenate(wordColumn2);</span>
<span class="fc" id="L420">    assertEquals(result.get(0), &quot;runningrunning&quot;);</span>
<span class="fc" id="L421">  }</span>

  @Test
  void testSubstring2() {
<span class="fc" id="L425">    String[] words = {&quot;running&quot;, &quot;icecube&quot;, &quot;back&quot;};</span>
<span class="fc" id="L426">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L427">    StringColumn result = wordColumn.substring(1, 3);</span>
<span class="fc" id="L428">    assertEquals(result.get(0), &quot;un&quot;);</span>
<span class="fc" id="L429">    assertEquals(result.get(1), &quot;ce&quot;);</span>
<span class="fc" id="L430">    assertEquals(result.get(2), &quot;ac&quot;);</span>
<span class="fc" id="L431">  }</span>

  @Test
  void testReplaceFirst() {
<span class="fc" id="L435">    String[] words = {&quot;running&quot;, &quot;run run run&quot;};</span>
<span class="fc" id="L436">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L437">    StringColumn result = wordColumn.replaceFirst(&quot;run&quot;, &quot;walk&quot;);</span>
<span class="fc" id="L438">    assertEquals(result.get(0), &quot;walkning&quot;);</span>
<span class="fc" id="L439">    assertEquals(result.get(1), &quot;walk run run&quot;);</span>
<span class="fc" id="L440">  }</span>

  @Test
  void testReplaceAll() {
<span class="fc" id="L444">    String[] words = {&quot;running&quot;, &quot;run run run&quot;};</span>
<span class="fc" id="L445">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L446">    StringColumn result = wordColumn.replaceAll(&quot;run&quot;, &quot;walk&quot;);</span>
<span class="fc" id="L447">    assertEquals(result.get(0), &quot;walkning&quot;);</span>
<span class="fc" id="L448">    assertEquals(result.get(1), &quot;walk walk walk&quot;);</span>
<span class="fc" id="L449">  }</span>

  @Test
  void testReplaceAll2() {
<span class="fc" id="L453">    String[] words = {&quot;running&quot;, &quot;run run run&quot;};</span>
<span class="fc" id="L454">    String[] regex = {&quot;n&quot;, &quot;g&quot;};</span>
<span class="fc" id="L455">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L456">    StringColumn result = wordColumn.replaceAll(regex, &quot;XX&quot;);</span>
<span class="fc" id="L457">    assertEquals(result.get(0), &quot;ruXXXXiXXXX&quot;);</span>
<span class="fc" id="L458">    assertEquals(result.get(1), &quot;ruXX ruXX ruXX&quot;);</span>
<span class="fc" id="L459">  }</span>

  @Test
  void testJoin() {
<span class="fc" id="L463">    String[] words = {&quot;running&quot;, &quot;run&quot;};</span>
<span class="fc" id="L464">    String[] words2 = {&quot;walking&quot;, &quot;walk&quot;};</span>
<span class="fc" id="L465">    String[] words3 = {&quot;swimming&quot;, &quot;swim&quot;};</span>
<span class="fc" id="L466">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L467">    StringColumn wordColumn2 = StringColumn.create(&quot;words2&quot;, words2);</span>
<span class="fc" id="L468">    StringColumn wordColumn3 = StringColumn.create(&quot;words3&quot;, words3);</span>
<span class="fc" id="L469">    StringColumn result = wordColumn.join(&quot;--&quot;, wordColumn2, wordColumn3);</span>
<span class="fc" id="L470">    assertEquals(result.get(0), &quot;running--walking--swimming&quot;);</span>
<span class="fc" id="L471">    assertEquals(result.get(1), &quot;run--walk--swim&quot;);</span>
<span class="fc" id="L472">  }</span>

  @Test
  void testTrim() {
<span class="fc" id="L476">    String[] words = {&quot; running &quot;, &quot; run run run &quot;};</span>
<span class="fc" id="L477">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L478">    StringColumn result = wordColumn.trim();</span>
<span class="fc" id="L479">    assertEquals(result.get(0), &quot;running&quot;);</span>
<span class="fc" id="L480">    assertEquals(result.get(1), &quot;run run run&quot;);</span>
<span class="fc" id="L481">  }</span>

  @Test
  void testUpperCase() {
<span class="fc" id="L485">    String[] words = {&quot;running&quot;, &quot;run run run&quot;};</span>
<span class="fc" id="L486">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L487">    StringColumn result = wordColumn.upperCase();</span>
<span class="fc" id="L488">    assertEquals(result.get(0), &quot;RUNNING&quot;);</span>
<span class="fc" id="L489">    assertEquals(result.get(1), &quot;RUN RUN RUN&quot;);</span>
<span class="fc" id="L490">  }</span>

  @Test
  void testLowerCase() {
<span class="fc" id="L494">    String[] words = {&quot;RUNNING&quot;, &quot;RUN RUN RUN&quot;};</span>
<span class="fc" id="L495">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L496">    StringColumn result = wordColumn.lowerCase();</span>
<span class="fc" id="L497">    assertEquals(result.get(0), &quot;running&quot;);</span>
<span class="fc" id="L498">    assertEquals(result.get(1), &quot;run run run&quot;);</span>
<span class="fc" id="L499">  }</span>

  @Test
  void testAbbreviate() {
<span class="fc" id="L503">    String[] words = {&quot;running&quot;, &quot;Stop Breaking Down&quot;, &quot;Backwards Writing&quot;};</span>
<span class="fc" id="L504">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L505">    StringColumn result = wordColumn.abbreviate(10);</span>
<span class="fc" id="L506">    assertEquals(result.get(0), &quot;running&quot;);</span>
<span class="fc" id="L507">    assertEquals(result.get(1), &quot;Stop Br...&quot;);</span>
<span class="fc" id="L508">    assertEquals(result.get(2), &quot;Backwar...&quot;);</span>
<span class="fc" id="L509">  }</span>

  @Test
  void tokenizeAndSort() {
<span class="fc" id="L513">    String[] words = {&quot;Stop Breaking Down&quot;, &quot;Backwards Writing&quot;};</span>
<span class="fc" id="L514">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L515">    StringColumn result = wordColumn.tokenizeAndSort();</span>
<span class="fc" id="L516">    assertEquals(result.get(0), &quot;Breaking Down Stop&quot;);</span>
<span class="fc" id="L517">    assertEquals(result.get(1), &quot;Backwards Writing&quot;);</span>
<span class="fc" id="L518">  }</span>

  @Test
  void tokenizeAndSort1() {
<span class="fc" id="L522">    String[] words = {&quot;Stop,Breaking,Down&quot;, &quot;Writing Backwards&quot;};</span>
<span class="fc" id="L523">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L524">    StringColumn result = wordColumn.tokenizeAndSort(&quot;,&quot;);</span>
<span class="fc" id="L525">    assertEquals(result.get(0), &quot;Breaking,Down,Stop&quot;);</span>
<span class="fc" id="L526">    assertEquals(result.get(1), &quot;Writing Backwards&quot;);</span>
<span class="fc" id="L527">  }</span>

  @Test
  void tokenizeAndRemoveDuplicates() {
<span class="fc" id="L531">    String[] words = {&quot;Stop Breaking Stop Down&quot;, &quot;walk run run&quot;};</span>
<span class="fc" id="L532">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L533">    StringColumn result = wordColumn.tokenizeAndRemoveDuplicates(&quot; &quot;);</span>
<span class="fc" id="L534">    assertEquals(&quot;Stop Breaking Down&quot;, result.get(0));</span>
<span class="fc" id="L535">    assertEquals(&quot;walk run&quot;, result.get(1));</span>
<span class="fc" id="L536">  }</span>

  @Test
  void chainMaps() {
<span class="fc" id="L540">    String[] words = {&quot;Stop Breaking Stop Down&quot;, &quot;walk run run&quot;};</span>
<span class="fc" id="L541">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L542">    StringColumn result = wordColumn.tokenizeAndRemoveDuplicates(&quot; &quot;).tokenizeAndSort();</span>
<span class="fc" id="L543">    assertEquals(&quot;Breaking Down Stop&quot;, result.get(0));</span>
<span class="fc" id="L544">    assertEquals(&quot;run walk&quot;, result.get(1));</span>
<span class="fc" id="L545">  }</span>

  @Test
  void chainMaps1() {
<span class="fc" id="L549">    String[] words = {&quot;foo&quot;, &quot;bar&quot;};</span>
<span class="fc" id="L550">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L551">    StringColumn result = wordColumn.concatenate(&quot; bam&quot;);</span>
<span class="fc" id="L552">    assertEquals(&quot;foo bam&quot;, result.get(0));</span>
<span class="fc" id="L553">    assertEquals(&quot;bar bam&quot;, result.get(1));</span>
<span class="fc" id="L554">  }</span>

  @Test
  void asDoubleColumn() {
<span class="fc" id="L558">    String[] words = {&quot;foo&quot;, &quot;bar&quot;, &quot;larry&quot;, &quot;foo&quot;, &quot;lion&quot;, &quot;ben&quot;, &quot;tiger&quot;, &quot;bar&quot;};</span>
<span class="fc" id="L559">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L560">    DoubleColumn result = wordColumn.asDoubleColumn();</span>
<span class="fc" id="L561">    assertArrayEquals(</span>
<span class="fc" id="L562">        new double[] {0.0, 1.0, 2.0, 0.0, 3.0, 4.0, 5.0, 1.0}, result.asDoubleArray(), 0.000_000_1);</span>
<span class="fc" id="L563">  }</span>

  @Test
  void asDoubleArray() {
<span class="fc" id="L567">    String[] words = {&quot;foo&quot;, &quot;bar&quot;, &quot;larry&quot;, &quot;foo&quot;, &quot;lion&quot;, null, &quot;ben&quot;, &quot;tiger&quot;, &quot;bar&quot;};</span>
<span class="fc" id="L568">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L569">    double[] result = wordColumn.asDoubleArray();</span>
<span class="fc" id="L570">    assertArrayEquals(</span>
        new double[] {0.0, 1.0, 2.0, 0.0, 3.0, 4.0, 5.0, 6.0, 1.0}, result, 0.000_000_1);
<span class="fc" id="L572">  }</span>

  @Test
  void getDouble() {
<span class="fc" id="L576">    String[] words = {&quot;foo&quot;, &quot;bar&quot;, &quot;larry&quot;, &quot;foo&quot;, &quot;lion&quot;, null, &quot;ben&quot;, &quot;tiger&quot;, &quot;bar&quot;};</span>
<span class="fc" id="L577">    StringColumn wordColumn = StringColumn.create(&quot;words&quot;, words);</span>
<span class="fc" id="L578">    double[] expected = new double[] {0.0, 1.0, 2.0, 0.0, 3.0, 4.0, 5.0, 6.0, 1.0};</span>
<span class="fc" id="L579">    double[] result = new double[words.length];</span>
<span class="fc bfc" id="L580" title="All 2 branches covered.">    for (int i = 0; i &lt; words.length; i++) {</span>
<span class="fc" id="L581">      result[i] = wordColumn.getDouble(i);</span>
    }
<span class="fc" id="L583">    assertArrayEquals(expected, result, 0.000_000_1);</span>
<span class="fc" id="L584">  }</span>

  @Test
  void countUniqueSetAfterCreateByteDict() {
<span class="fc" id="L588">    StringColumn col = StringColumn.create(&quot;col1&quot;, 2);</span>
<span class="fc" id="L589">    assertEquals(1, col.countUnique(), &quot;Wrong number of unique values after StringColumn.create&quot;);</span>
<span class="fc" id="L590">    assertEquals(2, col.countMissing(), &quot;Wrong number of missing values after StringColumn.create&quot;);</span>
<span class="fc" id="L591">    col.set(0, &quot;A&quot;);</span>
<span class="fc" id="L592">    col.set(1, &quot;B&quot;);</span>
<span class="fc" id="L593">    assertEquals(2, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L594">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L595">    col.clear();</span>
<span class="fc" id="L596">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after Column.clear&quot;);</span>
<span class="fc" id="L597">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.clear&quot;);</span>
<span class="fc" id="L598">  }</span>

  @Test
  void countUniqueSetAfterAppendByteDict() {
<span class="fc" id="L602">    StringColumn col = StringColumn.create(&quot;col1&quot;);</span>
<span class="fc" id="L603">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after StringColumn.create&quot;);</span>
<span class="fc" id="L604">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after StringColumn.create&quot;);</span>
<span class="fc" id="L605">    col.append(&quot;A&quot;);</span>
<span class="fc" id="L606">    col.append(&quot;B&quot;);</span>
<span class="fc" id="L607">    assertEquals(2, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L608">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L609">    col.set(0, &quot;C&quot;);</span>
<span class="fc" id="L610">    col.set(1, &quot;D&quot;);</span>
<span class="fc" id="L611">    assertEquals(2, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L612">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L613">    col.clear();</span>
<span class="fc" id="L614">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after Column.clear&quot;);</span>
<span class="fc" id="L615">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.clear&quot;);</span>
<span class="fc" id="L616">  }</span>

  @Test
  void countUniqueSetAfterCreateShortDict() {
<span class="fc" id="L620">    int size = Byte.MAX_VALUE - Byte.MIN_VALUE + 1;</span>
<span class="fc" id="L621">    StringColumn col = StringColumn.create(&quot;col1&quot;, size);</span>
<span class="fc" id="L622">    assertEquals(1, col.countUnique(), &quot;Wrong number of unique values after StringColumn.create&quot;);</span>
<span class="fc" id="L623">    assertEquals(</span>
<span class="fc" id="L624">        size, col.countMissing(), &quot;Wrong number of missing values after StringColumn.create&quot;);</span>
<span class="fc bfc" id="L625" title="All 2 branches covered.">    for (int i = size; --i &gt;= 0; ) {</span>
<span class="fc" id="L626">      col.set(i, Integer.toString(i));</span>
    }
<span class="fc" id="L628">    assertEquals(size, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L629">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L630">    col.clear();</span>
<span class="fc" id="L631">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after Column.clear&quot;);</span>
<span class="fc" id="L632">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.clear&quot;);</span>
<span class="fc" id="L633">  }</span>

  @Test
  void countUniqueSetAfterAppendShortDict() {
<span class="fc" id="L637">    StringColumn col = StringColumn.create(&quot;col1&quot;);</span>
<span class="fc" id="L638">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after StringColumn.create&quot;);</span>
<span class="fc" id="L639">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after StringColumn.create&quot;);</span>
<span class="fc" id="L640">    int size = Byte.MAX_VALUE - Byte.MIN_VALUE + 1;</span>
<span class="fc bfc" id="L641" title="All 2 branches covered.">    for (int i = size; --i &gt;= 0; ) {</span>
<span class="fc" id="L642">      col.append(Integer.toString(i));</span>
    }
<span class="fc" id="L644">    assertEquals(size, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L645">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc bfc" id="L646" title="All 2 branches covered.">    for (int i = size; --i &gt;= 0; ) {</span>
<span class="fc" id="L647">      col.set(i, &quot;A&quot; + i);</span>
    }
<span class="fc" id="L649">    assertEquals(size, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L650">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L651">    col.clear();</span>
<span class="fc" id="L652">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after Column.clear&quot;);</span>
<span class="fc" id="L653">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.clear&quot;);</span>
<span class="fc" id="L654">  }</span>

  @Test
  void countUniqueSetAfterCreateIntDict() {
<span class="fc" id="L658">    int size = Short.MAX_VALUE - Short.MIN_VALUE + 1;</span>
<span class="fc" id="L659">    StringColumn col = StringColumn.create(&quot;col1&quot;, size);</span>
<span class="fc" id="L660">    assertEquals(1, col.countUnique(), &quot;Wrong number of unique values after StringColumn.create&quot;);</span>
<span class="fc" id="L661">    assertEquals(</span>
<span class="fc" id="L662">        size, col.countMissing(), &quot;Wrong number of missing values after StringColumn.create&quot;);</span>
<span class="fc bfc" id="L663" title="All 2 branches covered.">    for (int i = size; --i &gt;= 0; ) {</span>
<span class="fc" id="L664">      col.set(i, Integer.toString(i));</span>
    }
<span class="fc" id="L666">    assertEquals(size, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L667">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L668">    col.clear();</span>
<span class="fc" id="L669">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after Column.clear&quot;);</span>
<span class="fc" id="L670">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.clear&quot;);</span>
<span class="fc" id="L671">  }</span>

  @Test
  void countUniqueSetAfterAppendIntDict() {
<span class="fc" id="L675">    StringColumn col = StringColumn.create(&quot;col1&quot;);</span>
<span class="fc" id="L676">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after StringColumn.create&quot;);</span>
<span class="fc" id="L677">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after StringColumn.create&quot;);</span>
<span class="fc" id="L678">    int size = Short.MAX_VALUE - Short.MIN_VALUE + 1;</span>
<span class="fc bfc" id="L679" title="All 2 branches covered.">    for (int i = size; --i &gt;= 0; ) {</span>
<span class="fc" id="L680">      col.append(Integer.toString(i));</span>
    }
<span class="fc" id="L682">    assertEquals(size, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L683">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc bfc" id="L684" title="All 2 branches covered.">    for (int i = size; --i &gt;= 0; ) {</span>
<span class="fc" id="L685">      col.set(i, &quot;A&quot; + i);</span>
    }
<span class="fc" id="L687">    assertEquals(size, col.countUnique(), &quot;Wrong number of unique values after Column.set&quot;);</span>
<span class="fc" id="L688">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.set&quot;);</span>
<span class="fc" id="L689">    col.clear();</span>
<span class="fc" id="L690">    assertEquals(0, col.countUnique(), &quot;Wrong number of unique values after Column.clear&quot;);</span>
<span class="fc" id="L691">    assertEquals(0, col.countMissing(), &quot;Wrong number of missing values after Column.clear&quot;);</span>
<span class="fc" id="L692">  }</span>

  @Test
  public void countUniqueWithDuplicates() {
<span class="fc" id="L696">    StringColumn col = StringColumn.create(&quot;col1&quot;);</span>
<span class="fc" id="L697">    col.append(&quot;1&quot;);</span>
<span class="fc" id="L698">    col.append(&quot;1&quot;);</span>
<span class="fc" id="L699">    col.append(&quot;2&quot;);</span>
<span class="fc" id="L700">    col.append(&quot;2&quot;);</span>
<span class="fc" id="L701">    col.append(&quot;3&quot;);</span>

<span class="fc" id="L703">    assertEquals(3, col.countUnique());</span>
<span class="fc" id="L704">    assertEquals(3, col.unique().size());</span>
<span class="fc" id="L705">    assertEquals(3, col.asStringColumn().unique().size());</span>
<span class="fc" id="L706">  }</span>

  @Test
  public void countUniqueWithMissing() {
<span class="fc" id="L710">    StringColumn col1 = StringColumn.create(&quot;col1&quot;);</span>
<span class="fc" id="L711">    col1.append(&quot;1&quot;);</span>
<span class="fc" id="L712">    col1.append(&quot;1&quot;);</span>
<span class="fc" id="L713">    col1.append(&quot;2&quot;);</span>
<span class="fc" id="L714">    col1.appendMissing();</span>

<span class="fc" id="L716">    assertEquals(3, col1.countUnique());</span>
<span class="fc" id="L717">    assertEquals(3, col1.unique().size());</span>
<span class="fc" id="L718">  }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>