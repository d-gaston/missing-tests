<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ArcsSetTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_math4$All_in_commons_math4.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.math4.geometry.spherical.oned</a> &gt; <span class="el_source">ArcsSetTest.java</span></div><h1>ArcsSetTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.math4.geometry.spherical.oned;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;
import java.util.NoSuchElementException;

import org.apache.commons.math4.exception.NumberIsTooLargeException;
import org.apache.commons.math4.geometry.partitioning.BSPTree;
import org.apache.commons.math4.geometry.partitioning.Region;
import org.apache.commons.math4.geometry.partitioning.RegionFactory;
import org.apache.commons.math4.geometry.partitioning.Side;
import org.apache.commons.math4.geometry.partitioning.SubHyperplane;
import org.apache.commons.math4.geometry.partitioning.Region.Location;
import org.apache.commons.math4.geometry.spherical.oned.Arc;
import org.apache.commons.math4.geometry.spherical.oned.ArcsSet;
import org.apache.commons.math4.geometry.spherical.oned.LimitAngle;
import org.apache.commons.math4.geometry.spherical.oned.S1Point;
import org.apache.commons.math4.geometry.spherical.oned.Sphere1D;
import org.apache.commons.math4.geometry.spherical.oned.SubLimitAngle;
import org.apache.commons.math4.util.FastMath;
import org.apache.commons.math4.util.MathUtils;
import org.apache.commons.numbers.core.Precision;
import org.junit.Assert;
import org.junit.Test;

<span class="fc" id="L43">public class ArcsSetTest {</span>

    @Test
    public void testArc() {
<span class="fc" id="L47">        ArcsSet set = new ArcsSet(2.3, 5.7, 1.0e-10);</span>
<span class="fc" id="L48">        Assert.assertEquals(3.4, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L49">        Assert.assertEquals(1.0e-10, set.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L50">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(2.3)));</span>
<span class="fc" id="L51">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(5.7)));</span>
<span class="fc" id="L52">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(1.2)));</span>
<span class="fc" id="L53">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(8.5)));</span>
<span class="fc" id="L54">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new S1Point(8.7)));</span>
<span class="fc" id="L55">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new S1Point(3.0)));</span>
<span class="fc" id="L56">        Assert.assertEquals(1, set.asList().size());</span>
<span class="fc" id="L57">        Assert.assertEquals(2.3, set.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L58">        Assert.assertEquals(5.7, set.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L59">    }</span>

    @Test
    public void testWrapAround2PiArc() {
<span class="fc" id="L63">        ArcsSet set = new ArcsSet(5.7 - MathUtils.TWO_PI, 2.3, 1.0e-10);</span>
<span class="fc" id="L64">        Assert.assertEquals(MathUtils.TWO_PI - 3.4, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L65">        Assert.assertEquals(1.0e-10, set.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L66">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(2.3)));</span>
<span class="fc" id="L67">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(5.7)));</span>
<span class="fc" id="L68">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new S1Point(1.2)));</span>
<span class="fc" id="L69">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new S1Point(8.5)));</span>
<span class="fc" id="L70">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(8.7)));</span>
<span class="fc" id="L71">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(3.0)));</span>
<span class="fc" id="L72">        Assert.assertEquals(1, set.asList().size());</span>
<span class="fc" id="L73">        Assert.assertEquals(5.7, set.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L74">        Assert.assertEquals(2.3 + MathUtils.TWO_PI, set.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L75">    }</span>

    @Test
    public void testSplitOver2Pi() {
<span class="fc" id="L79">        ArcsSet set = new ArcsSet(1.0e-10);</span>
<span class="fc" id="L80">        Arc     arc = new Arc(1.5 * FastMath.PI, 2.5 * FastMath.PI, 1.0e-10);</span>
<span class="fc" id="L81">        ArcsSet.Split split = set.split(arc);</span>
<span class="fc bfc" id="L82" title="All 2 branches covered.">        for (double alpha = 0.0; alpha &lt;= MathUtils.TWO_PI; alpha += 0.01) {</span>
<span class="fc" id="L83">            S1Point p = new S1Point(alpha);</span>
<span class="fc bfc" id="L84" title="All 4 branches covered.">            if (alpha &lt; 0.5 * FastMath.PI || alpha &gt; 1.5 * FastMath.PI) {</span>
<span class="fc" id="L85">                Assert.assertEquals(Location.OUTSIDE, split.getPlus().checkPoint(p));</span>
<span class="fc" id="L86">                Assert.assertEquals(Location.INSIDE,  split.getMinus().checkPoint(p));</span>
            } else {
<span class="fc" id="L88">                Assert.assertEquals(Location.INSIDE,  split.getPlus().checkPoint(p));</span>
<span class="fc" id="L89">                Assert.assertEquals(Location.OUTSIDE, split.getMinus().checkPoint(p));</span>
            }
        }
<span class="fc" id="L92">    }</span>

    @Test
    public void testSplitAtEnd() {
<span class="fc" id="L96">        ArcsSet set = new ArcsSet(1.0e-10);</span>
<span class="fc" id="L97">        Arc     arc = new Arc(FastMath.PI, MathUtils.TWO_PI, 1.0e-10);</span>
<span class="fc" id="L98">        ArcsSet.Split split = set.split(arc);</span>
<span class="fc bfc" id="L99" title="All 2 branches covered.">        for (double alpha = 0.01; alpha &lt; MathUtils.TWO_PI; alpha += 0.01) {</span>
<span class="fc" id="L100">            S1Point p = new S1Point(alpha);</span>
<span class="fc bfc" id="L101" title="All 2 branches covered.">            if (alpha &gt; FastMath.PI) {</span>
<span class="fc" id="L102">                Assert.assertEquals(Location.OUTSIDE, split.getPlus().checkPoint(p));</span>
<span class="fc" id="L103">                Assert.assertEquals(Location.INSIDE,  split.getMinus().checkPoint(p));</span>
            } else {
<span class="fc" id="L105">                Assert.assertEquals(Location.INSIDE,  split.getPlus().checkPoint(p));</span>
<span class="fc" id="L106">                Assert.assertEquals(Location.OUTSIDE, split.getMinus().checkPoint(p));</span>
            }
        }

<span class="fc" id="L110">        S1Point zero = new S1Point(0.0);</span>
<span class="fc" id="L111">        Assert.assertEquals(Location.BOUNDARY,  split.getPlus().checkPoint(zero));</span>
<span class="fc" id="L112">        Assert.assertEquals(Location.BOUNDARY,  split.getMinus().checkPoint(zero));</span>

<span class="fc" id="L114">        S1Point pi = new S1Point(FastMath.PI);</span>
<span class="fc" id="L115">        Assert.assertEquals(Location.BOUNDARY,  split.getPlus().checkPoint(pi));</span>
<span class="fc" id="L116">        Assert.assertEquals(Location.BOUNDARY,  split.getMinus().checkPoint(pi));</span>

<span class="fc" id="L118">    }</span>

    @Test(expected=NumberIsTooLargeException.class)
    public void testWrongInterval() {
<span class="nc" id="L122">        new ArcsSet(1.2, 0.0, 1.0e-10);</span>
<span class="nc" id="L123">    }</span>

    @Test
    public void testFullEqualEndPoints() {
<span class="fc" id="L127">        ArcsSet set = new ArcsSet(1.0, 1.0, 1.0e-10);</span>
<span class="fc" id="L128">        Assert.assertEquals(1.0e-10, set.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L129">        Assert.assertEquals(Region.Location.INSIDE, set.checkPoint(new S1Point(9.0)));</span>
<span class="fc bfc" id="L130" title="All 2 branches covered.">        for (double alpha = -20.0; alpha &lt;= 20.0; alpha += 0.1) {</span>
<span class="fc" id="L131">            Assert.assertEquals(Region.Location.INSIDE, set.checkPoint(new S1Point(alpha)));</span>
        }
<span class="fc" id="L133">        Assert.assertEquals(1, set.asList().size());</span>
<span class="fc" id="L134">        Assert.assertEquals(0.0, set.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L135">        Assert.assertEquals(2 * FastMath.PI, set.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L136">        Assert.assertEquals(2 * FastMath.PI, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L137">    }</span>

    @Test
    public void testFullCircle() {
<span class="fc" id="L141">        ArcsSet set = new ArcsSet(1.0e-10);</span>
<span class="fc" id="L142">        Assert.assertEquals(1.0e-10, set.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L143">        Assert.assertEquals(Region.Location.INSIDE, set.checkPoint(new S1Point(9.0)));</span>
<span class="fc bfc" id="L144" title="All 2 branches covered.">        for (double alpha = -20.0; alpha &lt;= 20.0; alpha += 0.1) {</span>
<span class="fc" id="L145">            Assert.assertEquals(Region.Location.INSIDE, set.checkPoint(new S1Point(alpha)));</span>
        }
<span class="fc" id="L147">        Assert.assertEquals(1, set.asList().size());</span>
<span class="fc" id="L148">        Assert.assertEquals(0.0, set.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L149">        Assert.assertEquals(2 * FastMath.PI, set.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L150">        Assert.assertEquals(2 * FastMath.PI, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L151">    }</span>

    @Test
    public void testEmpty() {
<span class="fc" id="L155">        ArcsSet empty = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().getComplement(new ArcsSet(1.0e-10));</span>
<span class="fc" id="L156">        Assert.assertEquals(1.0e-10, empty.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L157">        Assert.assertEquals(0.0, empty.getSize(), 1.0e-10);</span>
<span class="fc" id="L158">        Assert.assertTrue(empty.asList().isEmpty());</span>
<span class="fc" id="L159">    }</span>

    @Test
    public void testTiny() {
<span class="fc" id="L163">        ArcsSet tiny = new ArcsSet(0.0, Precision.SAFE_MIN / 2, 1.0e-10);</span>
<span class="fc" id="L164">        Assert.assertEquals(1.0e-10, tiny.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L165">        Assert.assertEquals(Precision.SAFE_MIN / 2, tiny.getSize(), 1.0e-10);</span>
<span class="fc" id="L166">        Assert.assertEquals(1, tiny.asList().size());</span>
<span class="fc" id="L167">        Assert.assertEquals(0.0, tiny.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L168">        Assert.assertEquals(Precision.SAFE_MIN / 2, tiny.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L169">    }</span>

    @Test
    public void testSpecialConstruction() {
<span class="fc" id="L173">        List&lt;SubHyperplane&lt;Sphere1D&gt;&gt; boundary = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L174">        boundary.add(new LimitAngle(new S1Point(0.0), false, 1.0e-10).wholeHyperplane());</span>
<span class="fc" id="L175">        boundary.add(new LimitAngle(new S1Point(MathUtils.TWO_PI - 1.0e-11), true, 1.0e-10).wholeHyperplane());</span>
<span class="fc" id="L176">        ArcsSet set = new ArcsSet(boundary, 1.0e-10);</span>
<span class="fc" id="L177">        Assert.assertEquals(MathUtils.TWO_PI, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L178">        Assert.assertEquals(1.0e-10, set.getTolerance(), 1.0e-20);</span>
<span class="fc" id="L179">        Assert.assertEquals(1, set.asList().size());</span>
<span class="fc" id="L180">        Assert.assertEquals(0.0, set.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L181">        Assert.assertEquals(MathUtils.TWO_PI, set.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L182">    }</span>

    @Test
    public void testDifference() {

<span class="fc" id="L187">        ArcsSet a   = new ArcsSet(1.0, 6.0, 1.0e-10);</span>
<span class="fc" id="L188">        List&lt;Arc&gt; aList = a.asList();</span>
<span class="fc" id="L189">        Assert.assertEquals(1,   aList.size());</span>
<span class="fc" id="L190">        Assert.assertEquals(1.0, aList.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L191">        Assert.assertEquals(6.0, aList.get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L193">        ArcsSet b   = new ArcsSet(3.0, 5.0, 1.0e-10);</span>
<span class="fc" id="L194">        List&lt;Arc&gt; bList = b.asList();</span>
<span class="fc" id="L195">        Assert.assertEquals(1,   bList.size());</span>
<span class="fc" id="L196">        Assert.assertEquals(3.0, bList.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L197">        Assert.assertEquals(5.0, bList.get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L199">        ArcsSet aMb = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().difference(a, b);</span>
<span class="fc bfc" id="L200" title="All 2 branches covered.">        for (int k = -2; k &lt; 3; ++k) {</span>
<span class="fc" id="L201">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(0.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L202">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(0.9 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L203">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(1.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L204">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(1.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L205">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(2.9 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L206">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(3.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L207">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(3.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L208">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(4.9 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L209">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(5.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L210">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(5.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L211">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(5.9 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L212">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(6.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L213">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(6.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L214">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(6.2 + k * MathUtils.TWO_PI)));</span>
        }

<span class="fc" id="L217">        List&lt;Arc&gt; aMbList = aMb.asList();</span>
<span class="fc" id="L218">        Assert.assertEquals(2,   aMbList.size());</span>
<span class="fc" id="L219">        Assert.assertEquals(1.0, aMbList.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L220">        Assert.assertEquals(3.0, aMbList.get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L221">        Assert.assertEquals(5.0, aMbList.get(1).getInf(), 1.0e-10);</span>
<span class="fc" id="L222">        Assert.assertEquals(6.0, aMbList.get(1).getSup(), 1.0e-10);</span>


<span class="fc" id="L225">    }</span>

    @Test
    public void testIntersection() {

<span class="fc" id="L230">        ArcsSet a   = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().union(new ArcsSet(1.0, 3.0, 1.0e-10),</span>
                                                                    new ArcsSet(5.0, 6.0, 1.0e-10));
<span class="fc" id="L232">        List&lt;Arc&gt; aList = a.asList();</span>
<span class="fc" id="L233">        Assert.assertEquals(2,   aList.size());</span>
<span class="fc" id="L234">        Assert.assertEquals(1.0, aList.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L235">        Assert.assertEquals(3.0, aList.get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L236">        Assert.assertEquals(5.0, aList.get(1).getInf(), 1.0e-10);</span>
<span class="fc" id="L237">        Assert.assertEquals(6.0, aList.get(1).getSup(), 1.0e-10);</span>

<span class="fc" id="L239">        ArcsSet b   = new ArcsSet(0.0, 5.5, 1.0e-10);</span>
<span class="fc" id="L240">        List&lt;Arc&gt; bList = b.asList();</span>
<span class="fc" id="L241">        Assert.assertEquals(1,   bList.size());</span>
<span class="fc" id="L242">        Assert.assertEquals(0.0, bList.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L243">        Assert.assertEquals(5.5, bList.get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L245">        ArcsSet aMb = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().intersection(a, b);</span>
<span class="fc bfc" id="L246" title="All 2 branches covered.">        for (int k = -2; k &lt; 3; ++k) {</span>
<span class="fc" id="L247">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(0.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L248">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(1.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L249">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(1.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L250">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(2.9 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L251">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(3.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L252">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(3.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L253">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(4.9 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L254">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(5.0 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L255">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(5.1 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L256">            Assert.assertEquals(Location.INSIDE,   aMb.checkPoint(new S1Point(5.4 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L257">            Assert.assertEquals(Location.BOUNDARY, aMb.checkPoint(new S1Point(5.5 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L258">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(5.6 + k * MathUtils.TWO_PI)));</span>
<span class="fc" id="L259">            Assert.assertEquals(Location.OUTSIDE,  aMb.checkPoint(new S1Point(6.2 + k * MathUtils.TWO_PI)));</span>
        }

<span class="fc" id="L262">        List&lt;Arc&gt; aMbList = aMb.asList();</span>
<span class="fc" id="L263">        Assert.assertEquals(2,   aMbList.size());</span>
<span class="fc" id="L264">        Assert.assertEquals(1.0, aMbList.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L265">        Assert.assertEquals(3.0, aMbList.get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L266">        Assert.assertEquals(5.0, aMbList.get(1).getInf(), 1.0e-10);</span>
<span class="fc" id="L267">        Assert.assertEquals(5.5, aMbList.get(1).getSup(), 1.0e-10);</span>


<span class="fc" id="L270">    }</span>

    @Test
    public void testMultiple() {
<span class="fc" id="L274">        RegionFactory&lt;Sphere1D&gt; factory = new RegionFactory&lt;&gt;();</span>
<span class="fc" id="L275">        ArcsSet set = (ArcsSet)</span>
<span class="fc" id="L276">        factory.intersection(factory.union(factory.difference(new ArcsSet(1.0, 6.0, 1.0e-10),</span>
                                                              new ArcsSet(3.0, 5.0, 1.0e-10)),
                                                              new ArcsSet(0.5, 2.0, 1.0e-10)),
                                                              new ArcsSet(0.0, 5.5, 1.0e-10));
<span class="fc" id="L280">        Assert.assertEquals(3.0, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L281">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(0.0)));</span>
<span class="fc" id="L282">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(4.0)));</span>
<span class="fc" id="L283">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new S1Point(6.0)));</span>
<span class="fc" id="L284">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new S1Point(1.2)));</span>
<span class="fc" id="L285">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new S1Point(5.25)));</span>
<span class="fc" id="L286">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(0.5)));</span>
<span class="fc" id="L287">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(3.0)));</span>
<span class="fc" id="L288">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(5.0)));</span>
<span class="fc" id="L289">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new S1Point(5.5)));</span>

<span class="fc" id="L291">        List&lt;Arc&gt; list = set.asList();</span>
<span class="fc" id="L292">        Assert.assertEquals(2, list.size());</span>
<span class="fc" id="L293">        Assert.assertEquals( 0.5, list.get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L294">        Assert.assertEquals( 3.0, list.get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L295">        Assert.assertEquals( 5.0, list.get(1).getInf(), 1.0e-10);</span>
<span class="fc" id="L296">        Assert.assertEquals( 5.5, list.get(1).getSup(), 1.0e-10);</span>

<span class="fc" id="L298">    }</span>

    @Test
    public void testSinglePoint() {
<span class="fc" id="L302">        ArcsSet set = new ArcsSet(1.0, FastMath.nextAfter(1.0, Double.POSITIVE_INFINITY), 1.0e-10);</span>
<span class="fc" id="L303">        Assert.assertEquals(2 * Precision.EPSILON, set.getSize(), Precision.SAFE_MIN);</span>
<span class="fc" id="L304">    }</span>

    @Test
    public void testIteration() {
<span class="fc" id="L308">        ArcsSet set = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().difference(new ArcsSet(1.0, 6.0, 1.0e-10),</span>
                                                                         new ArcsSet(3.0, 5.0, 1.0e-10));
<span class="fc" id="L310">        Iterator&lt;double[]&gt; iterator = set.iterator();</span>
        try {
<span class="nc" id="L312">            iterator.remove();</span>
<span class="nc" id="L313">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L314">        } catch (UnsupportedOperationException uoe) {</span>
            // expected
<span class="nc" id="L316">        }</span>

<span class="fc" id="L318">        Assert.assertTrue(iterator.hasNext());</span>
<span class="fc" id="L319">        double[] a0 = iterator.next();</span>
<span class="fc" id="L320">        Assert.assertEquals(2, a0.length);</span>
<span class="fc" id="L321">        Assert.assertEquals(1.0, a0[0], 1.0e-10);</span>
<span class="fc" id="L322">        Assert.assertEquals(3.0, a0[1], 1.0e-10);</span>

<span class="fc" id="L324">        Assert.assertTrue(iterator.hasNext());</span>
<span class="fc" id="L325">        double[] a1 = iterator.next();</span>
<span class="fc" id="L326">        Assert.assertEquals(2, a1.length);</span>
<span class="fc" id="L327">        Assert.assertEquals(5.0, a1[0], 1.0e-10);</span>
<span class="fc" id="L328">        Assert.assertEquals(6.0, a1[1], 1.0e-10);</span>

<span class="fc" id="L330">        Assert.assertFalse(iterator.hasNext());</span>
        try {
<span class="nc" id="L332">            iterator.next();</span>
<span class="nc" id="L333">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L334">        } catch (NoSuchElementException nsee) {</span>
            // expected
<span class="nc" id="L336">        }</span>

<span class="fc" id="L338">    }</span>

    @Test
    public void testEmptyTree() {
<span class="fc" id="L342">        Assert.assertEquals(MathUtils.TWO_PI, new ArcsSet(new BSPTree&lt;Sphere1D&gt;(Boolean.TRUE), 1.0e-10).getSize(), 1.0e-10);</span>
<span class="fc" id="L343">    }</span>

    @Test
    public void testShiftedAngles() {
<span class="fc bfc" id="L347" title="All 2 branches covered.">        for (int k = -2; k &lt; 3; ++k) {</span>
<span class="fc" id="L348">            SubLimitAngle l1  = new LimitAngle(new S1Point(1.0 + k * MathUtils.TWO_PI), false, 1.0e-10).wholeHyperplane();</span>
<span class="fc" id="L349">            SubLimitAngle l2  = new LimitAngle(new S1Point(1.5 + k * MathUtils.TWO_PI), true,  1.0e-10).wholeHyperplane();</span>
<span class="fc" id="L350">            ArcsSet set = new ArcsSet(new BSPTree&lt;&gt;(l1,</span>
                                                            new BSPTree&lt;Sphere1D&gt;(Boolean.FALSE),
                                                            new BSPTree&lt;&gt;(l2,
                                                                                  new BSPTree&lt;Sphere1D&gt;(Boolean.FALSE),
                                                                                  new BSPTree&lt;Sphere1D&gt;(Boolean.TRUE),
                                                                                  null),
                                                            null),
                                      1.0e-10);
<span class="fc bfc" id="L358" title="All 2 branches covered.">            for (double alpha = 1.0e-6; alpha &lt; MathUtils.TWO_PI; alpha += 0.001) {</span>
<span class="fc bfc" id="L359" title="All 4 branches covered.">                if (alpha &lt; 1 || alpha &gt; 1.5) {</span>
<span class="fc" id="L360">                    Assert.assertEquals(Location.OUTSIDE, set.checkPoint(new S1Point(alpha)));</span>
                } else {
<span class="fc" id="L362">                    Assert.assertEquals(Location.INSIDE,  set.checkPoint(new S1Point(alpha)));</span>
                }
            }
        }

<span class="fc" id="L367">    }</span>

    @Test(expected=ArcsSet.InconsistentStateAt2PiWrapping.class)
    public void testInconsistentState() {
<span class="fc" id="L371">        SubLimitAngle l1 = new LimitAngle(new S1Point(1.0), false, 1.0e-10).wholeHyperplane();</span>
<span class="fc" id="L372">        SubLimitAngle l2 = new LimitAngle(new S1Point(2.0), true,  1.0e-10).wholeHyperplane();</span>
<span class="fc" id="L373">        SubLimitAngle l3 = new LimitAngle(new S1Point(3.0), false, 1.0e-10).wholeHyperplane();</span>
<span class="nc" id="L374">        new ArcsSet(new BSPTree&lt;&gt;(l1,</span>
                                          new BSPTree&lt;Sphere1D&gt;(Boolean.FALSE),
                                          new BSPTree&lt;&gt;(l2,
                                                                new BSPTree&lt;&gt;(l3,
                                                                                      new BSPTree&lt;Sphere1D&gt;(Boolean.FALSE),
                                                                                      new BSPTree&lt;Sphere1D&gt;(Boolean.TRUE),
                                                                                      null),
                                                                new BSPTree&lt;Sphere1D&gt;(Boolean.TRUE),
                                                                null),
                                          null),
                                          1.0e-10);
<span class="nc" id="L385">    }</span>

    @Test
    public void testSide() {
<span class="fc" id="L389">        ArcsSet set = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().difference(new ArcsSet(1.0, 6.0, 1.0e-10),</span>
                                                                         new ArcsSet(3.0, 5.0, 1.0e-10));
<span class="fc bfc" id="L391" title="All 2 branches covered.">        for (int k = -2; k &lt; 3; ++k) {</span>
<span class="fc" id="L392">            Assert.assertEquals(Side.MINUS, set.split(new Arc(0.5 + k * MathUtils.TWO_PI,</span>
                                                              6.1 + k * MathUtils.TWO_PI,
<span class="fc" id="L394">                                                              set.getTolerance())).getSide());</span>
<span class="fc" id="L395">            Assert.assertEquals(Side.PLUS,  set.split(new Arc(0.5 + k * MathUtils.TWO_PI,</span>
                                                              0.8 + k * MathUtils.TWO_PI,
<span class="fc" id="L397">                                                              set.getTolerance())).getSide());</span>
<span class="fc" id="L398">            Assert.assertEquals(Side.PLUS,  set.split(new Arc(6.2 + k * MathUtils.TWO_PI,</span>
                                                              6.3 + k * MathUtils.TWO_PI,
<span class="fc" id="L400">                                                              set.getTolerance())).getSide());</span>
<span class="fc" id="L401">            Assert.assertEquals(Side.PLUS,  set.split(new Arc(3.5 + k * MathUtils.TWO_PI,</span>
                                                              4.5 + k * MathUtils.TWO_PI,
<span class="fc" id="L403">                                                              set.getTolerance())).getSide());</span>
<span class="fc" id="L404">            Assert.assertEquals(Side.BOTH,  set.split(new Arc(2.9 + k * MathUtils.TWO_PI,</span>
                                                              4.5 + k * MathUtils.TWO_PI,
<span class="fc" id="L406">                                                              set.getTolerance())).getSide());</span>
<span class="fc" id="L407">            Assert.assertEquals(Side.BOTH,  set.split(new Arc(0.5 + k * MathUtils.TWO_PI,</span>
                                                              1.2 + k * MathUtils.TWO_PI,
<span class="fc" id="L409">                                                              set.getTolerance())).getSide());</span>
<span class="fc" id="L410">            Assert.assertEquals(Side.BOTH,  set.split(new Arc(0.5 + k * MathUtils.TWO_PI,</span>
                                                              5.9 + k * MathUtils.TWO_PI,
<span class="fc" id="L412">                                                              set.getTolerance())).getSide());</span>
        }
<span class="fc" id="L414">    }</span>

    @Test
    public void testSideEmbedded() {

<span class="fc" id="L419">        ArcsSet s35 = new ArcsSet(3.0, 5.0, 1.0e-10);</span>
<span class="fc" id="L420">        ArcsSet s16 = new ArcsSet(1.0, 6.0, 1.0e-10);</span>

<span class="fc" id="L422">        Assert.assertEquals(Side.BOTH,  s16.split(new Arc(3.0, 5.0, 1.0e-10)).getSide());</span>
<span class="fc" id="L423">        Assert.assertEquals(Side.BOTH,  s16.split(new Arc(5.0, 3.0 + MathUtils.TWO_PI, 1.0e-10)).getSide());</span>
<span class="fc" id="L424">        Assert.assertEquals(Side.MINUS, s35.split(new Arc(1.0, 6.0, 1.0e-10)).getSide());</span>
<span class="fc" id="L425">        Assert.assertEquals(Side.PLUS,  s35.split(new Arc(6.0, 1.0 + MathUtils.TWO_PI, 1.0e-10)).getSide());</span>

<span class="fc" id="L427">    }</span>

    @Test
    public void testSideOverlapping() {
<span class="fc" id="L431">        ArcsSet s35 = new ArcsSet(3.0, 5.0, 1.0e-10);</span>
<span class="fc" id="L432">        ArcsSet s46 = new ArcsSet(4.0, 6.0, 1.0e-10);</span>

<span class="fc" id="L434">        Assert.assertEquals(Side.BOTH,  s46.split(new Arc(3.0, 5.0, 1.0e-10)).getSide());</span>
<span class="fc" id="L435">        Assert.assertEquals(Side.BOTH,  s46.split(new Arc(5.0, 3.0 + MathUtils.TWO_PI, 1.0e-10)).getSide());</span>
<span class="fc" id="L436">        Assert.assertEquals(Side.BOTH, s35.split(new Arc(4.0, 6.0, 1.0e-10)).getSide());</span>
<span class="fc" id="L437">        Assert.assertEquals(Side.BOTH,  s35.split(new Arc(6.0, 4.0 + MathUtils.TWO_PI, 1.0e-10)).getSide());</span>
<span class="fc" id="L438">    }</span>

    @Test
    public void testSideHyper() {
<span class="fc" id="L442">        ArcsSet sub = (ArcsSet) new RegionFactory&lt;Sphere1D&gt;().getComplement(new ArcsSet(1.0e-10));</span>
<span class="fc" id="L443">        Assert.assertTrue(sub.isEmpty());</span>
<span class="fc" id="L444">        Assert.assertEquals(Side.HYPER,  sub.split(new Arc(2.0, 3.0, 1.0e-10)).getSide());</span>
<span class="fc" id="L445">    }</span>

    @Test
    public void testSplitEmbedded() {

<span class="fc" id="L450">        ArcsSet s35 = new ArcsSet(3.0, 5.0, 1.0e-10);</span>
<span class="fc" id="L451">        ArcsSet s16 = new ArcsSet(1.0, 6.0, 1.0e-10);</span>

<span class="fc" id="L453">        ArcsSet.Split split1 = s16.split(new Arc(3.0, 5.0, 1.0e-10));</span>
<span class="fc" id="L454">        ArcsSet split1Plus  = split1.getPlus();</span>
<span class="fc" id="L455">        ArcsSet split1Minus = split1.getMinus();</span>
<span class="fc" id="L456">        Assert.assertEquals(3.0, split1Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L457">        Assert.assertEquals(2,   split1Plus.asList().size());</span>
<span class="fc" id="L458">        Assert.assertEquals(1.0, split1Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L459">        Assert.assertEquals(3.0, split1Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L460">        Assert.assertEquals(5.0, split1Plus.asList().get(1).getInf(), 1.0e-10);</span>
<span class="fc" id="L461">        Assert.assertEquals(6.0, split1Plus.asList().get(1).getSup(), 1.0e-10);</span>
<span class="fc" id="L462">        Assert.assertEquals(2.0, split1Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L463">        Assert.assertEquals(1,   split1Minus.asList().size());</span>
<span class="fc" id="L464">        Assert.assertEquals(3.0, split1Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L465">        Assert.assertEquals(5.0, split1Minus.asList().get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L467">        ArcsSet.Split split2 = s16.split(new Arc(5.0, 3.0 + MathUtils.TWO_PI, 1.0e-10));</span>
<span class="fc" id="L468">        ArcsSet split2Plus  = split2.getPlus();</span>
<span class="fc" id="L469">        ArcsSet split2Minus = split2.getMinus();</span>
<span class="fc" id="L470">        Assert.assertEquals(2.0, split2Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L471">        Assert.assertEquals(1,   split2Plus.asList().size());</span>
<span class="fc" id="L472">        Assert.assertEquals(3.0, split2Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L473">        Assert.assertEquals(5.0, split2Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L474">        Assert.assertEquals(3.0, split2Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L475">        Assert.assertEquals(2,   split2Minus.asList().size());</span>
<span class="fc" id="L476">        Assert.assertEquals(1.0, split2Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L477">        Assert.assertEquals(3.0, split2Minus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L478">        Assert.assertEquals(5.0, split2Minus.asList().get(1).getInf(), 1.0e-10);</span>
<span class="fc" id="L479">        Assert.assertEquals(6.0, split2Minus.asList().get(1).getSup(), 1.0e-10);</span>

<span class="fc" id="L481">        ArcsSet.Split split3 = s35.split(new Arc(1.0, 6.0, 1.0e-10));</span>
<span class="fc" id="L482">        ArcsSet split3Plus  = split3.getPlus();</span>
<span class="fc" id="L483">        ArcsSet split3Minus = split3.getMinus();</span>
<span class="fc" id="L484">        Assert.assertNull(split3Plus);</span>
<span class="fc" id="L485">        Assert.assertEquals(2.0, split3Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L486">        Assert.assertEquals(1,   split3Minus.asList().size());</span>
<span class="fc" id="L487">        Assert.assertEquals(3.0, split3Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L488">        Assert.assertEquals(5.0, split3Minus.asList().get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L490">        ArcsSet.Split split4 = s35.split(new Arc(6.0, 1.0 + MathUtils.TWO_PI, 1.0e-10));</span>
<span class="fc" id="L491">        ArcsSet split4Plus  = split4.getPlus();</span>
<span class="fc" id="L492">        ArcsSet split4Minus = split4.getMinus();</span>
<span class="fc" id="L493">        Assert.assertEquals(2.0, split4Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L494">        Assert.assertEquals(1,   split4Plus.asList().size());</span>
<span class="fc" id="L495">        Assert.assertEquals(3.0, split4Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L496">        Assert.assertEquals(5.0, split4Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L497">        Assert.assertNull(split4Minus);</span>

<span class="fc" id="L499">    }</span>

    @Test
    public void testSplitOverlapping() {

<span class="fc" id="L504">        ArcsSet s35 = new ArcsSet(3.0, 5.0, 1.0e-10);</span>
<span class="fc" id="L505">        ArcsSet s46 = new ArcsSet(4.0, 6.0, 1.0e-10);</span>

<span class="fc" id="L507">        ArcsSet.Split split1 = s46.split(new Arc(3.0, 5.0, 1.0e-10));</span>
<span class="fc" id="L508">        ArcsSet split1Plus  = split1.getPlus();</span>
<span class="fc" id="L509">        ArcsSet split1Minus = split1.getMinus();</span>
<span class="fc" id="L510">        Assert.assertEquals(1.0, split1Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L511">        Assert.assertEquals(1,   split1Plus.asList().size());</span>
<span class="fc" id="L512">        Assert.assertEquals(5.0, split1Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L513">        Assert.assertEquals(6.0, split1Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L514">        Assert.assertEquals(1.0, split1Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L515">        Assert.assertEquals(1,   split1Minus.asList().size());</span>
<span class="fc" id="L516">        Assert.assertEquals(4.0, split1Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L517">        Assert.assertEquals(5.0, split1Minus.asList().get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L519">        ArcsSet.Split split2 = s46.split(new Arc(5.0, 3.0 + MathUtils.TWO_PI, 1.0e-10));</span>
<span class="fc" id="L520">        ArcsSet split2Plus  = split2.getPlus();</span>
<span class="fc" id="L521">        ArcsSet split2Minus = split2.getMinus();</span>
<span class="fc" id="L522">        Assert.assertEquals(1.0, split2Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L523">        Assert.assertEquals(1,   split2Plus.asList().size());</span>
<span class="fc" id="L524">        Assert.assertEquals(4.0, split2Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L525">        Assert.assertEquals(5.0, split2Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L526">        Assert.assertEquals(1.0, split2Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L527">        Assert.assertEquals(1,   split2Minus.asList().size());</span>
<span class="fc" id="L528">        Assert.assertEquals(5.0, split2Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L529">        Assert.assertEquals(6.0, split2Minus.asList().get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L531">        ArcsSet.Split split3 = s35.split(new Arc(4.0, 6.0, 1.0e-10));</span>
<span class="fc" id="L532">        ArcsSet split3Plus  = split3.getPlus();</span>
<span class="fc" id="L533">        ArcsSet split3Minus = split3.getMinus();</span>
<span class="fc" id="L534">        Assert.assertEquals(1.0, split3Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L535">        Assert.assertEquals(1,   split3Plus.asList().size());</span>
<span class="fc" id="L536">        Assert.assertEquals(3.0, split3Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L537">        Assert.assertEquals(4.0, split3Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L538">        Assert.assertEquals(1.0, split3Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L539">        Assert.assertEquals(1,   split3Minus.asList().size());</span>
<span class="fc" id="L540">        Assert.assertEquals(4.0, split3Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L541">        Assert.assertEquals(5.0, split3Minus.asList().get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L543">        ArcsSet.Split split4 = s35.split(new Arc(6.0, 4.0 + MathUtils.TWO_PI, 1.0e-10));</span>
<span class="fc" id="L544">        ArcsSet split4Plus  = split4.getPlus();</span>
<span class="fc" id="L545">        ArcsSet split4Minus = split4.getMinus();</span>
<span class="fc" id="L546">        Assert.assertEquals(1.0, split4Plus.getSize(), 1.0e-10);</span>
<span class="fc" id="L547">        Assert.assertEquals(1,   split4Plus.asList().size());</span>
<span class="fc" id="L548">        Assert.assertEquals(4.0, split4Plus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L549">        Assert.assertEquals(5.0, split4Plus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L550">        Assert.assertEquals(1.0, split4Minus.getSize(), 1.0e-10);</span>
<span class="fc" id="L551">        Assert.assertEquals(1,   split4Minus.asList().size());</span>
<span class="fc" id="L552">        Assert.assertEquals(3.0, split4Minus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L553">        Assert.assertEquals(4.0, split4Minus.asList().get(0).getSup(), 1.0e-10);</span>

<span class="fc" id="L555">    }</span>

    @Test
    public void testFarSplit() {
<span class="fc" id="L559">        ArcsSet set = new ArcsSet(FastMath.PI, 2.5 * FastMath.PI, 1.0e-10);</span>
<span class="fc" id="L560">        ArcsSet.Split split = set.split(new Arc(0.5 * FastMath.PI, 1.5 * FastMath.PI, 1.0e-10));</span>
<span class="fc" id="L561">        ArcsSet splitPlus  = split.getPlus();</span>
<span class="fc" id="L562">        ArcsSet splitMinus = split.getMinus();</span>
<span class="fc" id="L563">        Assert.assertEquals(1,   splitMinus.asList().size());</span>
<span class="fc" id="L564">        Assert.assertEquals(1.0 * FastMath.PI, splitMinus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L565">        Assert.assertEquals(1.5 * FastMath.PI, splitMinus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L566">        Assert.assertEquals(0.5 * FastMath.PI, splitMinus.getSize(), 1.0e-10);</span>
<span class="fc" id="L567">        Assert.assertEquals(1,   splitPlus.asList().size());</span>
<span class="fc" id="L568">        Assert.assertEquals(1.5 * FastMath.PI, splitPlus.asList().get(0).getInf(), 1.0e-10);</span>
<span class="fc" id="L569">        Assert.assertEquals(2.5 * FastMath.PI, splitPlus.asList().get(0).getSup(), 1.0e-10);</span>
<span class="fc" id="L570">        Assert.assertEquals(1.0 * FastMath.PI, splitPlus.getSize(), 1.0e-10);</span>

<span class="fc" id="L572">    }</span>

    @Test
    public void testSplitWithinEpsilon() {
<span class="fc" id="L576">        double epsilon = 1.0e-10;</span>
<span class="fc" id="L577">        double a = 6.25;</span>
<span class="fc" id="L578">        double b = a - 0.5 * epsilon;</span>
<span class="fc" id="L579">        ArcsSet set = new ArcsSet(a - 1, a, epsilon);</span>
<span class="fc" id="L580">        Arc arc = new Arc(b, b + FastMath.PI, epsilon);</span>
<span class="fc" id="L581">        ArcsSet.Split split = set.split(arc);</span>
<span class="fc" id="L582">        Assert.assertEquals(set.getSize(), split.getPlus().getSize(),  epsilon);</span>
<span class="fc" id="L583">        Assert.assertNull(split.getMinus());</span>
<span class="fc" id="L584">    }</span>

    @Test
    public void testSideSplitConsistency() {
<span class="fc" id="L588">        double  epsilon = 1.0e-6;</span>
<span class="fc" id="L589">        double  a       = 4.725;</span>
<span class="fc" id="L590">        ArcsSet set     = new ArcsSet(a, a + 0.5, epsilon);</span>
<span class="fc" id="L591">        Arc     arc     = new Arc(a + 0.5 * epsilon, a + 1, epsilon);</span>
<span class="fc" id="L592">        ArcsSet.Split split = set.split(arc);</span>
<span class="fc" id="L593">        Assert.assertNotNull(split.getMinus());</span>
<span class="fc" id="L594">        Assert.assertNull(split.getPlus());</span>
<span class="fc" id="L595">        Assert.assertEquals(Side.MINUS, set.split(arc).getSide());</span>
<span class="fc" id="L596">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>