<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>IntervalsSetTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_math4$All_in_commons_math4.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.math4.geometry.euclidean.oned</a> &gt; <span class="el_source">IntervalsSetTest.java</span></div><h1>IntervalsSetTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.math4.geometry.euclidean.oned;

import java.util.ArrayList;
import java.util.List;

import org.apache.commons.math4.geometry.GeometryTestUtils;
import org.apache.commons.math4.geometry.partitioning.BSPTree;
import org.apache.commons.math4.geometry.partitioning.BoundaryProjection;
import org.apache.commons.math4.geometry.partitioning.Region;
import org.apache.commons.math4.geometry.partitioning.RegionFactory;
import org.apache.commons.math4.geometry.partitioning.SubHyperplane;
import org.apache.commons.math4.util.FastMath;
import org.apache.commons.numbers.core.Precision;
import org.junit.Assert;
import org.junit.Test;

<span class="fc" id="L33">public class IntervalsSetTest {</span>

    private static final double TEST_TOLERANCE = 1e-15;

    @Test
    public void testInterval_wholeNumberLine() {
        // act
<span class="fc" id="L40">        IntervalsSet set = new IntervalsSet(TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L43">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L44">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L45">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L46">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L47">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L48">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L50">        BSPTree&lt;Euclidean1D&gt; tree = set.getTree(true);</span>
<span class="fc" id="L51">        Assert.assertEquals(Boolean.TRUE, tree.getAttribute());</span>
<span class="fc" id="L52">        Assert.assertNull(tree.getCut());</span>
<span class="fc" id="L53">        Assert.assertNull(tree.getMinus());</span>
<span class="fc" id="L54">        Assert.assertNull(tree.getPlus());</span>

<span class="fc" id="L56">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L57">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L58">        assertInterval(Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L60">        assertLocation(Region.Location.INSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L61">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L62">        assertLocation(Region.Location.INSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L63">    }</span>

    @Test
    public void testInterval_doubleOpenInterval() {
        // act
<span class="fc" id="L68">        IntervalsSet set = new IntervalsSet(Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L71">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L72">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L73">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L74">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L75">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L76">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L78">        BSPTree&lt;Euclidean1D&gt; tree = set.getTree(true);</span>
<span class="fc" id="L79">        Assert.assertEquals(Boolean.TRUE, tree.getAttribute());</span>
<span class="fc" id="L80">        Assert.assertNull(tree.getCut());</span>
<span class="fc" id="L81">        Assert.assertNull(tree.getMinus());</span>
<span class="fc" id="L82">        Assert.assertNull(tree.getPlus());</span>

<span class="fc" id="L84">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L85">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L86">        assertInterval(Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L88">        assertLocation(Region.Location.INSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L89">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L90">        assertLocation(Region.Location.INSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L91">    }</span>

    @Test
    public void testInterval_openInterval_positive() {
        // act
<span class="fc" id="L96">        IntervalsSet set = new IntervalsSet(9.0, Double.POSITIVE_INFINITY, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L99">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L100">        Assert.assertEquals(9.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L101">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L102">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L103">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L104">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L106">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L107">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L108">        assertInterval(9.0, Double.POSITIVE_INFINITY, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L110">        assertLocation(Region.Location.OUTSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L111">        assertLocation(Region.Location.OUTSIDE, set, 0.0);</span>
<span class="fc" id="L112">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L113">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L114">        assertLocation(Region.Location.INSIDE, set, 10.0);</span>
<span class="fc" id="L115">        assertLocation(Region.Location.INSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L116">    }</span>

    @Test
    public void testInterval_openInterval_negative() {
        // act
<span class="fc" id="L121">        IntervalsSet set = new IntervalsSet(Double.NEGATIVE_INFINITY, 9.0, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L124">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L125">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L126">        Assert.assertEquals(9.0, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L127">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L128">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L129">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L131">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L132">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L133">        assertInterval(Double.NEGATIVE_INFINITY, 9.0, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L135">        assertLocation(Region.Location.INSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L136">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L137">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L138">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L139">        assertLocation(Region.Location.OUTSIDE, set, 10.0);</span>
<span class="fc" id="L140">        assertLocation(Region.Location.OUTSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L141">    }</span>

    @Test
    public void testInterval_singleClosedInterval() {
        // act
<span class="fc" id="L146">        IntervalsSet set = new IntervalsSet(-1.0, 9.0, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L149">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L150">        Assert.assertEquals(-1.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L151">        Assert.assertEquals(9.0, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L152">        Assert.assertEquals(10.0, set.getSize(), TEST_TOLERANCE);</span>
<span class="fc" id="L153">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L154">        GeometryTestUtils.assertVectorEquals(new Cartesian1D(4.0), (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L156">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L157">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L158">        assertInterval(-1.0, 9.0, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L160">        assertLocation(Region.Location.OUTSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L161">        assertLocation(Region.Location.OUTSIDE, set, -2.0);</span>
<span class="fc" id="L162">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L163">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L164">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L165">        assertLocation(Region.Location.OUTSIDE, set, 10.0);</span>
<span class="fc" id="L166">        assertLocation(Region.Location.OUTSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L167">    }</span>

    @Test
    public void testInterval_singlePoint() {
        // act
<span class="fc" id="L172">        IntervalsSet set = new IntervalsSet(1.0, 1.0, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L175">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L176">        Assert.assertEquals(1.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L177">        Assert.assertEquals(1.0, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L178">        Assert.assertEquals(0.0, set.getSize(), TEST_TOLERANCE);</span>
<span class="fc" id="L179">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L180">        GeometryTestUtils.assertVectorEquals(new Cartesian1D(1.0), (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L182">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L183">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L184">        assertInterval(1.0, 1.0, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L186">        assertLocation(Region.Location.OUTSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L187">        assertLocation(Region.Location.OUTSIDE, set, 0.0);</span>
<span class="fc" id="L188">        assertLocation(Region.Location.BOUNDARY, set, 1.0);</span>
<span class="fc" id="L189">        assertLocation(Region.Location.OUTSIDE, set, 2.0);</span>
<span class="fc" id="L190">        assertLocation(Region.Location.OUTSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L191">    }</span>

    @Test
    public void testFromBoundaries_wholeNumberLine() {
        // arrange
<span class="fc" id="L196">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>

        // act
<span class="fc" id="L199">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L202">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L203">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L204">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L205">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L206">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L207">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L209">        BSPTree&lt;Euclidean1D&gt; tree = set.getTree(true);</span>
<span class="fc" id="L210">        Assert.assertEquals(Boolean.TRUE, tree.getAttribute());</span>
<span class="fc" id="L211">        Assert.assertNull(tree.getCut());</span>
<span class="fc" id="L212">        Assert.assertNull(tree.getMinus());</span>
<span class="fc" id="L213">        Assert.assertNull(tree.getPlus());</span>

<span class="fc" id="L215">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L216">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L217">        assertInterval(Double.NEGATIVE_INFINITY, Double.POSITIVE_INFINITY, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L219">        assertLocation(Region.Location.INSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L220">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L221">        assertLocation(Region.Location.INSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L222">    }</span>

    @Test
    public void testFromBoundaries_openInterval_positive() {
        // arrange
<span class="fc" id="L227">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L228">        boundaries.add(subOrientedPoint(9.0, false));</span>

        // act
<span class="fc" id="L231">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L234">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L235">        Assert.assertEquals(9.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L236">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L237">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L238">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L239">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L241">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L242">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L243">        assertInterval(9.0, Double.POSITIVE_INFINITY, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L245">        assertLocation(Region.Location.OUTSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L246">        assertLocation(Region.Location.OUTSIDE, set, 0.0);</span>
<span class="fc" id="L247">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L248">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L249">        assertLocation(Region.Location.INSIDE, set, 10.0);</span>
<span class="fc" id="L250">        assertLocation(Region.Location.INSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L251">    }</span>

    @Test
    public void testFromBoundaries_openInterval_negative() {
        // arrange
<span class="fc" id="L256">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L257">        boundaries.add(subOrientedPoint(9.0, true));</span>

        // act
<span class="fc" id="L260">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L263">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L264">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L265">        Assert.assertEquals(9.0, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L266">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L267">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L268">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L270">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L271">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L272">        assertInterval(Double.NEGATIVE_INFINITY, 9.0, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L274">        assertLocation(Region.Location.INSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L275">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L276">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L277">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L278">        assertLocation(Region.Location.OUTSIDE, set, 10.0);</span>
<span class="fc" id="L279">        assertLocation(Region.Location.OUTSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L280">    }</span>

    @Test
    public void testFromBoundaries_singleClosedInterval() {
        // arrange
<span class="fc" id="L285">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L286">        boundaries.add(subOrientedPoint(-1.0, false));</span>
<span class="fc" id="L287">        boundaries.add(subOrientedPoint(9.0, true));</span>

        // act
<span class="fc" id="L290">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L293">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L294">        Assert.assertEquals(-1.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L295">        Assert.assertEquals(9.0, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L296">        Assert.assertEquals(10.0, set.getSize(), TEST_TOLERANCE);</span>
<span class="fc" id="L297">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L298">        GeometryTestUtils.assertVectorEquals(new Cartesian1D(4.0), (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L300">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L301">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L302">        assertInterval(-1.0, 9.0, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L304">        assertLocation(Region.Location.OUTSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L305">        assertLocation(Region.Location.OUTSIDE, set, -2.0);</span>
<span class="fc" id="L306">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L307">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L308">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L309">        assertLocation(Region.Location.OUTSIDE, set, 10.0);</span>
<span class="fc" id="L310">        assertLocation(Region.Location.OUTSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L311">    }</span>

    @Test
    public void testFromBoundaries_multipleClosedIntervals() {
        // arrange
<span class="fc" id="L316">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L317">        boundaries.add(subOrientedPoint(-1.0, false));</span>
<span class="fc" id="L318">        boundaries.add(subOrientedPoint(2.0, true));</span>
<span class="fc" id="L319">        boundaries.add(subOrientedPoint(5.0, false));</span>
<span class="fc" id="L320">        boundaries.add(subOrientedPoint(9.0, true));</span>

        // act
<span class="fc" id="L323">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L326">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L327">        Assert.assertEquals(-1.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L328">        Assert.assertEquals(9.0, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L329">        Assert.assertEquals(7.0, set.getSize(), TEST_TOLERANCE);</span>
<span class="fc" id="L330">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L331">        GeometryTestUtils.assertVectorEquals(new Cartesian1D(29.5 / 7.0), (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L333">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L334">        Assert.assertEquals(2, intervals.size());</span>
<span class="fc" id="L335">        assertInterval(-1.0, 2.0, intervals.get(0), TEST_TOLERANCE);</span>
<span class="fc" id="L336">        assertInterval(5.0, 9.0, intervals.get(1), TEST_TOLERANCE);</span>

<span class="fc" id="L338">        assertLocation(Region.Location.OUTSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L339">        assertLocation(Region.Location.OUTSIDE, set, -2.0);</span>
<span class="fc" id="L340">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L341">        assertLocation(Region.Location.OUTSIDE, set, 3.0);</span>
<span class="fc" id="L342">        assertLocation(Region.Location.INSIDE, set, 6.0);</span>
<span class="fc" id="L343">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L344">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L345">        assertLocation(Region.Location.OUTSIDE, set, 10.0);</span>
<span class="fc" id="L346">        assertLocation(Region.Location.OUTSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L347">    }</span>

    @Test
    public void testFromBoundaries_mixedOpenAndClosedIntervals() {
        // arrange
<span class="fc" id="L352">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L353">        boundaries.add(subOrientedPoint(-2.0, true));</span>
<span class="fc" id="L354">        boundaries.add(subOrientedPoint(-1.0, false));</span>
<span class="fc" id="L355">        boundaries.add(subOrientedPoint(2.0, true));</span>
<span class="fc" id="L356">        boundaries.add(subOrientedPoint(5.0, false));</span>
<span class="fc" id="L357">        boundaries.add(subOrientedPoint(9.0, true));</span>
<span class="fc" id="L358">        boundaries.add(subOrientedPoint(10.0, false));</span>

        // act
<span class="fc" id="L361">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // assert
<span class="fc" id="L364">        Assert.assertEquals(TEST_TOLERANCE, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L365">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L366">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L367">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L368">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L369">        GeometryTestUtils.assertVectorEquals(new Cartesian1D(Double.NaN), (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L371">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L372">        Assert.assertEquals(4, intervals.size());</span>
<span class="fc" id="L373">        assertInterval(Double.NEGATIVE_INFINITY, -2.0, intervals.get(0), TEST_TOLERANCE);</span>
<span class="fc" id="L374">        assertInterval(-1.0, 2.0, intervals.get(1), TEST_TOLERANCE);</span>
<span class="fc" id="L375">        assertInterval(5.0, 9.0, intervals.get(2), TEST_TOLERANCE);</span>
<span class="fc" id="L376">        assertInterval(10.0, Double.POSITIVE_INFINITY, intervals.get(3), TEST_TOLERANCE);</span>

<span class="fc" id="L378">        assertLocation(Region.Location.INSIDE, set, Double.NEGATIVE_INFINITY);</span>
<span class="fc" id="L379">        assertLocation(Region.Location.INSIDE, set, -3);</span>
<span class="fc" id="L380">        assertLocation(Region.Location.OUTSIDE, set, -1.5);</span>
<span class="fc" id="L381">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L382">        assertLocation(Region.Location.OUTSIDE, set, 3.0);</span>
<span class="fc" id="L383">        assertLocation(Region.Location.INSIDE, set, 6.0);</span>
<span class="fc" id="L384">        assertLocation(Region.Location.BOUNDARY, set, 9.0 - 1e-16);</span>
<span class="fc" id="L385">        assertLocation(Region.Location.BOUNDARY, set, 9.0 + 1e-16);</span>
<span class="fc" id="L386">        assertLocation(Region.Location.OUTSIDE, set, 9.5);</span>
<span class="fc" id="L387">        assertLocation(Region.Location.INSIDE, set, 11.0);</span>
<span class="fc" id="L388">        assertLocation(Region.Location.INSIDE, set, Double.POSITIVE_INFINITY);</span>
<span class="fc" id="L389">    }</span>

    @Test
    public void testFromBoundaries_intervalEqualToTolerance_onlyFirstBoundaryUsed() {
        // arrange
<span class="fc" id="L394">        double tolerance = 1e-3;</span>
<span class="fc" id="L395">        double first = 1.0;</span>
<span class="fc" id="L396">        double second = 1.0 + tolerance;</span>
<span class="fc" id="L397">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L398">        boundaries.add(subOrientedPoint(first, true, tolerance));</span>
<span class="fc" id="L399">        boundaries.add(subOrientedPoint(second, false, tolerance));</span>

        // act
<span class="fc" id="L402">        IntervalsSet set = new IntervalsSet(boundaries, tolerance);</span>

        // assert
<span class="fc" id="L405">        Assert.assertEquals(tolerance, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L406">        GeometryTestUtils.assertNegativeInfinity(set.getInf());</span>
<span class="fc" id="L407">        Assert.assertEquals(first, set.getSup(), TEST_TOLERANCE);</span>
<span class="fc" id="L408">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L409">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L410">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L412">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L413">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L414">        assertInterval(Double.NEGATIVE_INFINITY, first, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L416">        assertLocation(Region.Location.INSIDE, set, 0.0);</span>
<span class="fc" id="L417">        assertLocation(Region.Location.BOUNDARY, set, 1.0);</span>
<span class="fc" id="L418">        assertLocation(Region.Location.OUTSIDE, set, 2.0);</span>
<span class="fc" id="L419">    }</span>

    @Test
    public void testFromBoundaries_intervalSmallerThanTolerance_onlyFirstBoundaryUsed() {
        // arrange
<span class="fc" id="L424">        double tolerance = 1e-3;</span>
<span class="fc" id="L425">        double first = 1.0;</span>
<span class="fc" id="L426">        double second = 1.0 - 1e-4;</span>
<span class="fc" id="L427">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L428">        boundaries.add(subOrientedPoint(first, false, tolerance));</span>
<span class="fc" id="L429">        boundaries.add(subOrientedPoint(second, true, tolerance));</span>

        // act
<span class="fc" id="L432">        IntervalsSet set = new IntervalsSet(boundaries, tolerance);</span>

        // assert
<span class="fc" id="L435">        Assert.assertEquals(tolerance, set.getTolerance(), Precision.SAFE_MIN);</span>
<span class="fc" id="L436">        Assert.assertEquals(first, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L437">        GeometryTestUtils.assertPositiveInfinity(set.getSup());</span>
<span class="fc" id="L438">        GeometryTestUtils.assertPositiveInfinity(set.getSize());</span>
<span class="fc" id="L439">        Assert.assertEquals(0.0, set.getBoundarySize(), TEST_TOLERANCE);</span>
<span class="fc" id="L440">        GeometryTestUtils.assertVectorEquals(Cartesian1D.NaN, (Cartesian1D) set.getBarycenter(), TEST_TOLERANCE);</span>

<span class="fc" id="L442">        List&lt;Interval&gt; intervals = set.asList();</span>
<span class="fc" id="L443">        Assert.assertEquals(1, intervals.size());</span>
<span class="fc" id="L444">        assertInterval(first, Double.POSITIVE_INFINITY, intervals.get(0), TEST_TOLERANCE);</span>

<span class="fc" id="L446">        assertLocation(Region.Location.OUTSIDE, set, 0.0);</span>
<span class="fc" id="L447">        assertLocation(Region.Location.BOUNDARY, set, 1.0);</span>
<span class="fc" id="L448">        assertLocation(Region.Location.INSIDE, set, 2.0);</span>
<span class="fc" id="L449">    }</span>

    @Test
    public void testProjectToBoundary() {
        // arrange
<span class="fc" id="L454">        List&lt;SubHyperplane&lt;Euclidean1D&gt;&gt; boundaries = new ArrayList&lt;&gt;();</span>
<span class="fc" id="L455">        boundaries.add(subOrientedPoint(-2.0, true));</span>
<span class="fc" id="L456">        boundaries.add(subOrientedPoint(-1.0, false));</span>
<span class="fc" id="L457">        boundaries.add(subOrientedPoint(2.0, true));</span>
<span class="fc" id="L458">        boundaries.add(subOrientedPoint(5.0, false));</span>
<span class="fc" id="L459">        boundaries.add(subOrientedPoint(9.0, true));</span>
<span class="fc" id="L460">        boundaries.add(subOrientedPoint(10.0, false));</span>

<span class="fc" id="L462">        IntervalsSet set = new IntervalsSet(boundaries, TEST_TOLERANCE);</span>

        // act/assert
<span class="fc" id="L465">        assertProjection(new Cartesian1D(-2), -1, set, new Cartesian1D(-3));</span>
<span class="fc" id="L466">        assertProjection(new Cartesian1D(-2), 0, set, new Cartesian1D(-2));</span>
<span class="fc" id="L467">        assertProjection(new Cartesian1D(-2), 0.1, set, new Cartesian1D(-1.9));</span>

<span class="fc" id="L469">        assertProjection(new Cartesian1D(-1), 0.5, set, new Cartesian1D(-1.5));</span>
<span class="fc" id="L470">        assertProjection(new Cartesian1D(-1), 0.1, set, new Cartesian1D(-1.1));</span>
<span class="fc" id="L471">        assertProjection(new Cartesian1D(-1), 0, set, new Cartesian1D(-1));</span>
<span class="fc" id="L472">        assertProjection(new Cartesian1D(-1), -1, set, new Cartesian1D(0));</span>

<span class="fc" id="L474">        assertProjection(new Cartesian1D(2), -1, set, new Cartesian1D(1));</span>
<span class="fc" id="L475">        assertProjection(new Cartesian1D(2), 0, set, new Cartesian1D(2));</span>
<span class="fc" id="L476">        assertProjection(new Cartesian1D(2), 1, set, new Cartesian1D(3));</span>

<span class="fc" id="L478">        assertProjection(new Cartesian1D(5), 1, set, new Cartesian1D(4));</span>
<span class="fc" id="L479">        assertProjection(new Cartesian1D(5), 0, set, new Cartesian1D(5));</span>

<span class="fc" id="L481">        assertProjection(new Cartesian1D(5), -1, set, new Cartesian1D(6));</span>
<span class="fc" id="L482">        assertProjection(new Cartesian1D(5), -2, set, new Cartesian1D(7));</span>

<span class="fc" id="L484">        assertProjection(new Cartesian1D(9), -1, set, new Cartesian1D(8));</span>
<span class="fc" id="L485">        assertProjection(new Cartesian1D(9), 0, set, new Cartesian1D(9));</span>
<span class="fc" id="L486">        assertProjection(new Cartesian1D(9), 0.1, set, new Cartesian1D(9.1));</span>

<span class="fc" id="L488">        assertProjection(new Cartesian1D(10), 0, set, new Cartesian1D(10));</span>
<span class="fc" id="L489">        assertProjection(new Cartesian1D(10), -1, set, new Cartesian1D(11));</span>
<span class="fc" id="L490">    }</span>

    @Test
    public void testInterval() {
<span class="fc" id="L494">        IntervalsSet set = new IntervalsSet(2.3, 5.7, 1.0e-10);</span>
<span class="fc" id="L495">        Assert.assertEquals(3.4, set.getSize(), 1.0e-10);</span>
<span class="fc" id="L496">        Assert.assertEquals(4.0, ((Cartesian1D) set.getBarycenter()).getX(), 1.0e-10);</span>
<span class="fc" id="L497">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new Cartesian1D(2.3)));</span>
<span class="fc" id="L498">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new Cartesian1D(5.7)));</span>
<span class="fc" id="L499">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new Cartesian1D(1.2)));</span>
<span class="fc" id="L500">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new Cartesian1D(8.7)));</span>
<span class="fc" id="L501">        Assert.assertEquals(Region.Location.INSIDE,   set.checkPoint(new Cartesian1D(3.0)));</span>
<span class="fc" id="L502">        Assert.assertEquals(2.3, set.getInf(), 1.0e-10);</span>
<span class="fc" id="L503">        Assert.assertEquals(5.7, set.getSup(), 1.0e-10);</span>
<span class="fc" id="L504">    }</span>

    @Test
    public void testInfinite() {
<span class="fc" id="L508">        IntervalsSet set = new IntervalsSet(9.0, Double.POSITIVE_INFINITY, 1.0e-10);</span>
<span class="fc" id="L509">        Assert.assertEquals(Region.Location.BOUNDARY, set.checkPoint(new Cartesian1D(9.0)));</span>
<span class="fc" id="L510">        Assert.assertEquals(Region.Location.OUTSIDE,  set.checkPoint(new Cartesian1D(8.4)));</span>
<span class="fc bfc" id="L511" title="All 2 branches covered.">        for (double e = 1.0; e &lt;= 6.0; e += 1.0) {</span>
<span class="fc" id="L512">            Assert.assertEquals(Region.Location.INSIDE,</span>
<span class="fc" id="L513">                                set.checkPoint(new Cartesian1D(FastMath.pow(10.0, e))));</span>
        }
<span class="fc" id="L515">        Assert.assertTrue(Double.isInfinite(set.getSize()));</span>
<span class="fc" id="L516">        Assert.assertEquals(9.0, set.getInf(), 1.0e-10);</span>
<span class="fc" id="L517">        Assert.assertTrue(Double.isInfinite(set.getSup()));</span>

<span class="fc" id="L519">        set = (IntervalsSet) new RegionFactory&lt;Euclidean1D&gt;().getComplement(set);</span>
<span class="fc" id="L520">        Assert.assertEquals(9.0, set.getSup(), 1.0e-10);</span>
<span class="fc" id="L521">        Assert.assertTrue(Double.isInfinite(set.getInf()));</span>

<span class="fc" id="L523">    }</span>

    @Test
    public void testBooleanOperations() {
        // arrange
<span class="fc" id="L528">        RegionFactory&lt;Euclidean1D&gt; factory = new RegionFactory&lt;&gt;();</span>

        // act
<span class="fc" id="L531">        IntervalsSet set = (IntervalsSet)</span>
<span class="fc" id="L532">        factory.intersection(factory.union(factory.difference(new IntervalsSet(1.0, 6.0, TEST_TOLERANCE),</span>
                                                              new IntervalsSet(3.0, 5.0, TEST_TOLERANCE)),
                                                              new IntervalsSet(9.0, Double.POSITIVE_INFINITY, TEST_TOLERANCE)),
                                                              new IntervalsSet(Double.NEGATIVE_INFINITY, 11.0, TEST_TOLERANCE));

        // arrange
<span class="fc" id="L538">        Assert.assertEquals(1.0, set.getInf(), TEST_TOLERANCE);</span>
<span class="fc" id="L539">        Assert.assertEquals(11.0, set.getSup(), TEST_TOLERANCE);</span>

<span class="fc" id="L541">        Assert.assertEquals(5.0, set.getSize(), TEST_TOLERANCE);</span>
<span class="fc" id="L542">        Assert.assertEquals(5.9, ((Cartesian1D) set.getBarycenter()).getX(), TEST_TOLERANCE);</span>

<span class="fc" id="L544">        assertLocation(Region.Location.OUTSIDE, set, 0.0);</span>
<span class="fc" id="L545">        assertLocation(Region.Location.OUTSIDE, set, 4.0);</span>
<span class="fc" id="L546">        assertLocation(Region.Location.OUTSIDE, set, 8.0);</span>
<span class="fc" id="L547">        assertLocation(Region.Location.OUTSIDE, set, 12.0);</span>
<span class="fc" id="L548">        assertLocation(Region.Location.INSIDE, set, 1.2);</span>
<span class="fc" id="L549">        assertLocation(Region.Location.INSIDE, set, 5.9);</span>
<span class="fc" id="L550">        assertLocation(Region.Location.INSIDE, set, 9.01);</span>
<span class="fc" id="L551">        assertLocation(Region.Location.BOUNDARY, set, 5.0);</span>
<span class="fc" id="L552">        assertLocation(Region.Location.BOUNDARY, set, 11.0);</span>

<span class="fc" id="L554">        List&lt;Interval&gt; list = set.asList();</span>
<span class="fc" id="L555">        Assert.assertEquals(3, list.size());</span>
<span class="fc" id="L556">        assertInterval(1.0, 3.0, list.get(0), TEST_TOLERANCE);</span>
<span class="fc" id="L557">        assertInterval(5.0, 6.0, list.get(1), TEST_TOLERANCE);</span>
<span class="fc" id="L558">        assertInterval(9.0, 11.0, list.get(2), TEST_TOLERANCE);</span>
<span class="fc" id="L559">    }</span>

    private void assertLocation(Region.Location location, IntervalsSet set, double pt) {
<span class="fc" id="L562">        Assert.assertEquals(location, set.checkPoint(new Cartesian1D(pt)));</span>
<span class="fc" id="L563">    }</span>

    private void assertInterval(double expectedInf, double expectedSup, Interval actual, double tolerance) {
<span class="fc" id="L566">        Assert.assertEquals(expectedInf, actual.getInf(), tolerance);</span>
<span class="fc" id="L567">        Assert.assertEquals(expectedSup, actual.getSup(), tolerance);</span>
<span class="fc" id="L568">    }</span>

    private void assertProjection(Cartesian1D expectedProjection, double expectedOffset,
            IntervalsSet set, Cartesian1D toProject) {
<span class="fc" id="L572">        BoundaryProjection&lt;Euclidean1D&gt; proj = set.projectToBoundary(toProject);</span>

<span class="fc" id="L574">        GeometryTestUtils.assertVectorEquals(toProject, (Cartesian1D) proj.getOriginal(), TEST_TOLERANCE);</span>
<span class="fc" id="L575">        GeometryTestUtils.assertVectorEquals(expectedProjection, (Cartesian1D) proj.getProjected(), TEST_TOLERANCE);</span>
<span class="fc" id="L576">        Assert.assertEquals(expectedOffset, proj.getOffset(), TEST_TOLERANCE);</span>
<span class="fc" id="L577">    }</span>

    private SubOrientedPoint subOrientedPoint(double location, boolean direct) {
<span class="fc" id="L580">        return subOrientedPoint(location, direct, TEST_TOLERANCE);</span>
    }

    private SubOrientedPoint subOrientedPoint(double location, boolean direct, double tolerance) {
        // the remaining region isn't necessary for creating 1D boundaries so we can set it to null here
<span class="fc" id="L585">        return new SubOrientedPoint(new OrientedPoint(new Cartesian1D(location), direct, tolerance), null);</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>