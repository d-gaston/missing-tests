<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MathArraysTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_math4$All_in_commons_math4.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.math4.util</a> &gt; <span class="el_source">MathArraysTest.java</span></div><h1>MathArraysTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements. See the NOTICE file distributed with this
 * work for additional information regarding copyright ownership. The ASF
 * licenses this file to You under the Apache License, Version 2.0 (the
 * &quot;License&quot;); you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0 Unless required by applicable law
 * or agreed to in writing, software distributed under the License is
 * distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied. See the License for the specific language
 * governing permissions and limitations under the License.
 */
package org.apache.commons.math4.util;

import java.util.Arrays;

import org.apache.commons.math4.TestUtils;
import org.apache.commons.math4.exception.DimensionMismatchException;
import org.apache.commons.math4.exception.MathArithmeticException;
import org.apache.commons.math4.exception.MathIllegalArgumentException;
import org.apache.commons.math4.exception.NoDataException;
import org.apache.commons.math4.exception.NonMonotonicSequenceException;
import org.apache.commons.math4.exception.NotANumberException;
import org.apache.commons.math4.exception.NotPositiveException;
import org.apache.commons.math4.exception.NotStrictlyPositiveException;
import org.apache.commons.math4.exception.NullArgumentException;
import org.apache.commons.rng.UniformRandomProvider;
import org.apache.commons.rng.simple.RandomSource;
import org.apache.commons.math4.util.FastMath;
import org.apache.commons.math4.util.MathArrays;
import org.apache.commons.numbers.core.Precision;
import org.junit.Assert;
import org.junit.Test;

/**
 * Test cases for the {@link MathArrays} class.
 *
 */
<span class="fc" id="L40">public class MathArraysTest {</span>

<span class="fc" id="L42">    private double[] testArray = {0, 1, 2, 3, 4, 5};</span>
<span class="fc" id="L43">    private double[] testWeightsArray = {0.3, 0.2, 1.3, 1.1, 1.0, 1.8};</span>
<span class="fc" id="L44">    private double[] testNegativeWeightsArray = {-0.3, 0.2, -1.3, 1.1, 1.0, 1.8};</span>
<span class="fc" id="L45">    private double[] nullArray = null;</span>
<span class="fc" id="L46">    private double[] singletonArray = {0};</span>

    @Test
    public void testScale() {
<span class="fc" id="L50">        final double[] test = new double[] { -2.5, -1, 0, 1, 2.5 };</span>
<span class="fc" id="L51">        final double[] correctTest = MathArrays.copyOf(test);</span>
<span class="fc" id="L52">        final double[] correctScaled = new double[]{5.25, 2.1, 0, -2.1, -5.25};</span>

<span class="fc" id="L54">        final double[] scaled = MathArrays.scale(-2.1, test);</span>

        // Make sure test has not changed
<span class="fc bfc" id="L57" title="All 2 branches covered.">        for (int i = 0; i &lt; test.length; i++) {</span>
<span class="fc" id="L58">            Assert.assertEquals(correctTest[i], test[i], 0);</span>
        }

        // Test scaled values
<span class="fc bfc" id="L62" title="All 2 branches covered.">        for (int i = 0; i &lt; scaled.length; i++) {</span>
<span class="fc" id="L63">            Assert.assertEquals(correctScaled[i], scaled[i], 0);</span>
        }
<span class="fc" id="L65">    }</span>

    @Test
    public void testScaleInPlace() {
<span class="fc" id="L69">        final double[] test = new double[] { -2.5, -1, 0, 1, 2.5 };</span>
<span class="fc" id="L70">        final double[] correctScaled = new double[]{5.25, 2.1, 0, -2.1, -5.25};</span>
<span class="fc" id="L71">        MathArrays.scaleInPlace(-2.1, test);</span>

        // Make sure test has changed
<span class="fc bfc" id="L74" title="All 2 branches covered.">        for (int i = 0; i &lt; test.length; i++) {</span>
<span class="fc" id="L75">            Assert.assertEquals(correctScaled[i], test[i], 0);</span>
        }
<span class="fc" id="L77">    }</span>

    @Test(expected=DimensionMismatchException.class)
    public void testEbeAddPrecondition() {
<span class="nc" id="L81">        MathArrays.ebeAdd(new double[3], new double[4]);</span>
<span class="nc" id="L82">    }</span>
    @Test(expected=DimensionMismatchException.class)
    public void testEbeSubtractPrecondition() {
<span class="nc" id="L85">        MathArrays.ebeSubtract(new double[3], new double[4]);</span>
<span class="nc" id="L86">    }</span>
    @Test(expected=DimensionMismatchException.class)
    public void testEbeMultiplyPrecondition() {
<span class="nc" id="L89">        MathArrays.ebeMultiply(new double[3], new double[4]);</span>
<span class="nc" id="L90">    }</span>
    @Test(expected=DimensionMismatchException.class)
    public void testEbeDividePrecondition() {
<span class="nc" id="L93">        MathArrays.ebeDivide(new double[3], new double[4]);</span>
<span class="nc" id="L94">    }</span>

    @Test
    public void testEbeAdd() {
<span class="fc" id="L98">        final double[] a = { 0, 1, 2 };</span>
<span class="fc" id="L99">        final double[] b = { 3, 5, 7 };</span>
<span class="fc" id="L100">        final double[] r = MathArrays.ebeAdd(a, b);</span>

<span class="fc bfc" id="L102" title="All 2 branches covered.">        for (int i = 0; i &lt; a.length; i++) {</span>
<span class="fc" id="L103">            Assert.assertEquals(a[i] + b[i], r[i], 0);</span>
        }
<span class="fc" id="L105">    }</span>
    @Test
    public void testEbeSubtract() {
<span class="fc" id="L108">        final double[] a = { 0, 1, 2 };</span>
<span class="fc" id="L109">        final double[] b = { 3, 5, 7 };</span>
<span class="fc" id="L110">        final double[] r = MathArrays.ebeSubtract(a, b);</span>

<span class="fc bfc" id="L112" title="All 2 branches covered.">        for (int i = 0; i &lt; a.length; i++) {</span>
<span class="fc" id="L113">            Assert.assertEquals(a[i] - b[i], r[i], 0);</span>
        }
<span class="fc" id="L115">    }</span>
    @Test
    public void testEbeMultiply() {
<span class="fc" id="L118">        final double[] a = { 0, 1, 2 };</span>
<span class="fc" id="L119">        final double[] b = { 3, 5, 7 };</span>
<span class="fc" id="L120">        final double[] r = MathArrays.ebeMultiply(a, b);</span>

<span class="fc bfc" id="L122" title="All 2 branches covered.">        for (int i = 0; i &lt; a.length; i++) {</span>
<span class="fc" id="L123">            Assert.assertEquals(a[i] * b[i], r[i], 0);</span>
        }
<span class="fc" id="L125">    }</span>
    @Test
    public void testEbeDivide() {
<span class="fc" id="L128">        final double[] a = { 0, 1, 2 };</span>
<span class="fc" id="L129">        final double[] b = { 3, 5, 7 };</span>
<span class="fc" id="L130">        final double[] r = MathArrays.ebeDivide(a, b);</span>

<span class="fc bfc" id="L132" title="All 2 branches covered.">        for (int i = 0; i &lt; a.length; i++) {</span>
<span class="fc" id="L133">            Assert.assertEquals(a[i] / b[i], r[i], 0);</span>
        }
<span class="fc" id="L135">    }</span>

    @Test
    public void testL1DistanceDouble() {
<span class="fc" id="L139">        double[] p1 = { 2.5,  0.0 };</span>
<span class="fc" id="L140">        double[] p2 = { -0.5, 4.0 };</span>
<span class="fc" id="L141">        Assert.assertTrue(Precision.equals(7.0, MathArrays.distance1(p1, p2), 1));</span>
<span class="fc" id="L142">    }</span>

    @Test
    public void testL1DistanceInt() {
<span class="fc" id="L146">        int[] p1 = { 3, 0 };</span>
<span class="fc" id="L147">        int[] p2 = { 0, 4 };</span>
<span class="fc" id="L148">        Assert.assertEquals(7, MathArrays.distance1(p1, p2));</span>
<span class="fc" id="L149">    }</span>

    @Test
    public void testL2DistanceDouble() {
<span class="fc" id="L153">        double[] p1 = { 2.5,  0.0 };</span>
<span class="fc" id="L154">        double[] p2 = { -0.5, 4.0 };</span>
<span class="fc" id="L155">        Assert.assertTrue(Precision.equals(5.0, MathArrays.distance(p1, p2), 1));</span>
<span class="fc" id="L156">    }</span>

    @Test
    public void testL2DistanceInt() {
<span class="fc" id="L160">        int[] p1 = { 3, 0 };</span>
<span class="fc" id="L161">        int[] p2 = { 0, 4 };</span>
<span class="fc" id="L162">        Assert.assertTrue(Precision.equals(5, MathArrays.distance(p1, p2), 1));</span>
<span class="fc" id="L163">    }</span>

    @Test
    public void testLInfDistanceDouble() {
<span class="fc" id="L167">        double[] p1 = { 2.5,  0.0 };</span>
<span class="fc" id="L168">        double[] p2 = { -0.5, 4.0 };</span>
<span class="fc" id="L169">        Assert.assertTrue(Precision.equals(4.0, MathArrays.distanceInf(p1, p2), 1));</span>
<span class="fc" id="L170">    }</span>

    @Test
    public void testLInfDistanceInt() {
<span class="fc" id="L174">        int[] p1 = { 3, 0 };</span>
<span class="fc" id="L175">        int[] p2 = { 0, 4 };</span>
<span class="fc" id="L176">        Assert.assertEquals(4, MathArrays.distanceInf(p1, p2));</span>
<span class="fc" id="L177">    }</span>

    @Test
    public void testCheckOrder() {
<span class="fc" id="L181">        MathArrays.checkOrder(new double[] {-15, -5.5, -1, 2, 15},</span>
                             MathArrays.OrderDirection.INCREASING, true);
<span class="fc" id="L183">        MathArrays.checkOrder(new double[] {-15, -5.5, -1, 2, 2},</span>
                             MathArrays.OrderDirection.INCREASING, false);
<span class="fc" id="L185">        MathArrays.checkOrder(new double[] {3, -5.5, -11, -27.5},</span>
                             MathArrays.OrderDirection.DECREASING, true);
<span class="fc" id="L187">        MathArrays.checkOrder(new double[] {3, 0, 0, -5.5, -11, -27.5},</span>
                             MathArrays.OrderDirection.DECREASING, false);

        try {
<span class="nc" id="L191">            MathArrays.checkOrder(new double[] {-15, -5.5, -1, -1, 2, 15},</span>
                                 MathArrays.OrderDirection.INCREASING, true);
<span class="nc" id="L193">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L194">        } catch (NonMonotonicSequenceException e) {</span>
            // Expected
<span class="nc" id="L196">        }</span>
        try {
<span class="nc" id="L198">            MathArrays.checkOrder(new double[] {-15, -5.5, -1, -2, 2},</span>
                                 MathArrays.OrderDirection.INCREASING, false);
<span class="nc" id="L200">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L201">        } catch (NonMonotonicSequenceException e) {</span>
            // Expected
<span class="nc" id="L203">        }</span>
        try {
<span class="nc" id="L205">            MathArrays.checkOrder(new double[] {3, 3, -5.5, -11, -27.5},</span>
                                 MathArrays.OrderDirection.DECREASING, true);
<span class="nc" id="L207">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L208">        } catch (NonMonotonicSequenceException e) {</span>
            // Expected
<span class="nc" id="L210">        }</span>
        try {
<span class="nc" id="L212">            MathArrays.checkOrder(new double[] {3, -1, 0, -5.5, -11, -27.5},</span>
                                 MathArrays.OrderDirection.DECREASING, false);
<span class="nc" id="L214">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L215">        } catch (NonMonotonicSequenceException e) {</span>
            // Expected
<span class="nc" id="L217">        }</span>
        try {
<span class="nc" id="L219">            MathArrays.checkOrder(new double[] {3, 0, -5.5, -11, -10},</span>
                                 MathArrays.OrderDirection.DECREASING, false);
<span class="nc" id="L221">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L222">        } catch (NonMonotonicSequenceException e) {</span>
            // Expected
<span class="nc" id="L224">        }</span>
<span class="fc" id="L225">    }</span>

    @Test
    public void testIsMonotonic() {
<span class="fc" id="L229">        Assert.assertFalse(MathArrays.isMonotonic(new double[] { -15, -5.5, -1, -1, 2, 15 },</span>
                                                  MathArrays.OrderDirection.INCREASING, true));
<span class="fc" id="L231">        Assert.assertTrue(MathArrays.isMonotonic(new double[] { -15, -5.5, -1, 0, 2, 15 },</span>
                                                 MathArrays.OrderDirection.INCREASING, true));
<span class="fc" id="L233">        Assert.assertFalse(MathArrays.isMonotonic(new double[] { -15, -5.5, -1, -2, 2 },</span>
                                                  MathArrays.OrderDirection.INCREASING, false));
<span class="fc" id="L235">        Assert.assertTrue(MathArrays.isMonotonic(new double[] { -15, -5.5, -1, -1, 2 },</span>
                                                 MathArrays.OrderDirection.INCREASING, false));
<span class="fc" id="L237">        Assert.assertFalse(MathArrays.isMonotonic(new double[] { 3, 3, -5.5, -11, -27.5 },</span>
                                                  MathArrays.OrderDirection.DECREASING, true));
<span class="fc" id="L239">        Assert.assertTrue(MathArrays.isMonotonic(new double[] { 3, 2, -5.5, -11, -27.5 },</span>
                                                 MathArrays.OrderDirection.DECREASING, true));
<span class="fc" id="L241">        Assert.assertFalse(MathArrays.isMonotonic(new double[] { 3, -1, 0, -5.5, -11, -27.5 },</span>
                                                  MathArrays.OrderDirection.DECREASING, false));
<span class="fc" id="L243">        Assert.assertTrue(MathArrays.isMonotonic(new double[] { 3, 0, 0, -5.5, -11, -27.5 },</span>
                                                 MathArrays.OrderDirection.DECREASING, false));
<span class="fc" id="L245">    }</span>

    @Test
    public void testIsMonotonicComparable() {
<span class="fc" id="L249">        Assert.assertFalse(MathArrays.isMonotonic(new Double[] { new Double(-15),</span>
                                                                 new Double(-5.5),
                                                                 new Double(-1),
                                                                 new Double(-1),
                                                                 new Double(2),
                                                                 new Double(15) },
                MathArrays.OrderDirection.INCREASING, true));
<span class="fc" id="L256">        Assert.assertTrue(MathArrays.isMonotonic(new Double[] { new Double(-15),</span>
                                                                new Double(-5.5),
                                                                new Double(-1),
                                                                new Double(0),
                                                                new Double(2),
                                                                new Double(15) },
                MathArrays.OrderDirection.INCREASING, true));
<span class="fc" id="L263">        Assert.assertFalse(MathArrays.isMonotonic(new Double[] { new Double(-15),</span>
                                                                 new Double(-5.5),
                                                                 new Double(-1),
                                                                 new Double(-2),
                                                                 new Double(2) },
                MathArrays.OrderDirection.INCREASING, false));
<span class="fc" id="L269">        Assert.assertTrue(MathArrays.isMonotonic(new Double[] { new Double(-15),</span>
                                                                new Double(-5.5),
                                                                new Double(-1),
                                                                new Double(-1),
                                                                new Double(2) },
                MathArrays.OrderDirection.INCREASING, false));
<span class="fc" id="L275">        Assert.assertFalse(MathArrays.isMonotonic(new Double[] { new Double(3),</span>
                                                                 new Double(3),
                                                                 new Double(-5.5),
                                                                 new Double(-11),
                                                                 new Double(-27.5) },
                MathArrays.OrderDirection.DECREASING, true));
<span class="fc" id="L281">        Assert.assertTrue(MathArrays.isMonotonic(new Double[] { new Double(3),</span>
                                                                new Double(2),
                                                                new Double(-5.5),
                                                                new Double(-11),
                                                                new Double(-27.5) },
                MathArrays.OrderDirection.DECREASING, true));
<span class="fc" id="L287">        Assert.assertFalse(MathArrays.isMonotonic(new Double[] { new Double(3),</span>
                                                                 new Double(-1),
                                                                 new Double(0),
                                                                 new Double(-5.5),
                                                                 new Double(-11),
                                                                 new Double(-27.5) },
                MathArrays.OrderDirection.DECREASING, false));
<span class="fc" id="L294">        Assert.assertTrue(MathArrays.isMonotonic(new Double[] { new Double(3),</span>
                                                                new Double(0),
                                                                new Double(0),
                                                                new Double(-5.5),
                                                                new Double(-11),
                                                                new Double(-27.5) },
                MathArrays.OrderDirection.DECREASING, false));
<span class="fc" id="L301">    }</span>

    @Test
    public void testCheckRectangular() {
<span class="fc" id="L305">        final long[][] rect = new long[][] {{0, 1}, {2, 3}};</span>
<span class="fc" id="L306">        final long[][] ragged = new long[][] {{0, 1}, {2}};</span>
<span class="fc" id="L307">        final long[][] nullArray = null;</span>
<span class="fc" id="L308">        final long[][] empty = new long[][] {};</span>
<span class="fc" id="L309">        MathArrays.checkRectangular(rect);</span>
<span class="fc" id="L310">        MathArrays.checkRectangular(empty);</span>
        try {
<span class="nc" id="L312">            MathArrays.checkRectangular(ragged);</span>
<span class="nc" id="L313">            Assert.fail(&quot;Expecting DimensionMismatchException&quot;);</span>
<span class="fc" id="L314">        } catch (DimensionMismatchException ex) {</span>
            // Expected
<span class="nc" id="L316">        }</span>
        try {
<span class="nc" id="L318">            MathArrays.checkRectangular(nullArray);</span>
<span class="nc" id="L319">            Assert.fail(&quot;Expecting NullArgumentException&quot;);</span>
<span class="fc" id="L320">        } catch (NullArgumentException ex) {</span>
            // Expected
<span class="nc" id="L322">        }</span>
<span class="fc" id="L323">    }</span>

    @Test
    public void testCheckPositive() {
<span class="fc" id="L327">        final double[] positive = new double[] {1, 2, 3};</span>
<span class="fc" id="L328">        final double[] nonNegative = new double[] {0, 1, 2};</span>
<span class="fc" id="L329">        final double[] nullArray = null;</span>
<span class="fc" id="L330">        final double[] empty = new double[] {};</span>
<span class="fc" id="L331">        MathArrays.checkPositive(positive);</span>
<span class="fc" id="L332">        MathArrays.checkPositive(empty);</span>
        try {
<span class="nc" id="L334">            MathArrays.checkPositive(nullArray);</span>
<span class="nc" id="L335">            Assert.fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="fc" id="L336">        } catch (NullPointerException ex) {</span>
            // Expected
<span class="nc" id="L338">        }</span>
        try {
<span class="nc" id="L340">            MathArrays.checkPositive(nonNegative);</span>
<span class="nc" id="L341">            Assert.fail(&quot;Expecting NotStrictlyPositiveException&quot;);</span>
<span class="fc" id="L342">        } catch (NotStrictlyPositiveException ex) {</span>
            // Expected
<span class="nc" id="L344">        }</span>
<span class="fc" id="L345">    }</span>

    @Test
    public void testCheckNonNegative() {
<span class="fc" id="L349">        final long[] nonNegative = new long[] {0, 1};</span>
<span class="fc" id="L350">        final long[] hasNegative = new long[] {-1};</span>
<span class="fc" id="L351">        final long[] nullArray = null;</span>
<span class="fc" id="L352">        final long[] empty = new long[] {};</span>
<span class="fc" id="L353">        MathArrays.checkNonNegative(nonNegative);</span>
<span class="fc" id="L354">        MathArrays.checkNonNegative(empty);</span>
        try {
<span class="nc" id="L356">            MathArrays.checkNonNegative(nullArray);</span>
<span class="nc" id="L357">            Assert.fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="fc" id="L358">        } catch (NullPointerException ex) {</span>
            // Expected
<span class="nc" id="L360">        }</span>
        try {
<span class="nc" id="L362">            MathArrays.checkNonNegative(hasNegative);</span>
<span class="nc" id="L363">            Assert.fail(&quot;Expecting NotPositiveException&quot;);</span>
<span class="fc" id="L364">        } catch (NotPositiveException ex) {</span>
            // Expected
<span class="nc" id="L366">        }</span>
<span class="fc" id="L367">    }</span>

    @Test
    public void testCheckNonNegative2D() {
<span class="fc" id="L371">        final long[][] nonNegative = new long[][] {{0, 1}, {1, 0}};</span>
<span class="fc" id="L372">        final long[][] hasNegative = new long[][] {{-1}, {0}};</span>
<span class="fc" id="L373">        final long[][] nullArray = null;</span>
<span class="fc" id="L374">        final long[][] empty = new long[][] {};</span>
<span class="fc" id="L375">        MathArrays.checkNonNegative(nonNegative);</span>
<span class="fc" id="L376">        MathArrays.checkNonNegative(empty);</span>
        try {
<span class="nc" id="L378">            MathArrays.checkNonNegative(nullArray);</span>
<span class="nc" id="L379">            Assert.fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="fc" id="L380">        } catch (NullPointerException ex) {</span>
            // Expected
<span class="nc" id="L382">        }</span>
        try {
<span class="nc" id="L384">            MathArrays.checkNonNegative(hasNegative);</span>
<span class="nc" id="L385">            Assert.fail(&quot;Expecting NotPositiveException&quot;);</span>
<span class="fc" id="L386">        } catch (NotPositiveException ex) {</span>
            // Expected
<span class="nc" id="L388">        }</span>
<span class="fc" id="L389">    }</span>

    @Test
    public void testCheckNotNaN() {
<span class="fc" id="L393">        final double[] withoutNaN = { Double.NEGATIVE_INFINITY,</span>
                                      -Double.MAX_VALUE,
                                      -1, 0,
                                      Double.MIN_VALUE,
<span class="fc" id="L397">                                      FastMath.ulp(1d),</span>
                                      1, 3, 113, 4769,
                                      Double.MAX_VALUE,
                                      Double.POSITIVE_INFINITY };

<span class="fc" id="L402">        final double[] withNaN = { Double.NEGATIVE_INFINITY,</span>
                                   -Double.MAX_VALUE,
                                   -1, 0,
                                   Double.MIN_VALUE,
<span class="fc" id="L406">                                   FastMath.ulp(1d),</span>
                                   1, 3, 113, 4769,
                                   Double.MAX_VALUE,
                                   Double.POSITIVE_INFINITY,
                                   Double.NaN };


<span class="fc" id="L413">        final double[] nullArray = null;</span>
<span class="fc" id="L414">        final double[] empty = new double[] {};</span>
<span class="fc" id="L415">        MathArrays.checkNotNaN(withoutNaN);</span>
<span class="fc" id="L416">        MathArrays.checkNotNaN(empty);</span>
        try {
<span class="nc" id="L418">            MathArrays.checkNotNaN(nullArray);</span>
<span class="nc" id="L419">            Assert.fail(&quot;Expecting NullPointerException&quot;);</span>
<span class="fc" id="L420">        } catch (NullPointerException ex) {</span>
            // Expected
<span class="nc" id="L422">        }</span>
        try {
<span class="nc" id="L424">            MathArrays.checkNotNaN(withNaN);</span>
<span class="nc" id="L425">            Assert.fail(&quot;Expecting NotANumberException&quot;);</span>
<span class="fc" id="L426">        } catch (NotANumberException ex) {</span>
            // Expected
<span class="nc" id="L428">        }</span>
<span class="fc" id="L429">    }</span>

    @Test(expected=DimensionMismatchException.class)
    public void testCheckEqualLength1() {
<span class="nc" id="L433">        MathArrays.checkEqualLength(new double[] {1, 2, 3},</span>
                                    new double[] {1, 2, 3, 4});
<span class="nc" id="L435">    }</span>

    @Test
    public void testCheckEqualLength2() {
<span class="fc" id="L439">        final double[] a = new double[] {-1, -12, -23, -34};</span>
<span class="fc" id="L440">        final double[] b = new double[] {56, 67, 78, 89};</span>
<span class="fc" id="L441">        Assert.assertTrue(MathArrays.checkEqualLength(a, b, false));</span>
<span class="fc" id="L442">    }</span>

    @Test
    public void testSortInPlace() {
<span class="fc" id="L446">        final double[] x1 = {2,   5,  -3, 1,  4};</span>
<span class="fc" id="L447">        final double[] x2 = {4,  25,   9, 1, 16};</span>
<span class="fc" id="L448">        final double[] x3 = {8, 125, -27, 1, 64};</span>

<span class="fc" id="L450">        MathArrays.sortInPlace(x1, x2, x3);</span>

<span class="fc" id="L452">        Assert.assertEquals(-3,  x1[0], FastMath.ulp(1d));</span>
<span class="fc" id="L453">        Assert.assertEquals(9,   x2[0], FastMath.ulp(1d));</span>
<span class="fc" id="L454">        Assert.assertEquals(-27, x3[0], FastMath.ulp(1d));</span>

<span class="fc" id="L456">        Assert.assertEquals(1, x1[1], FastMath.ulp(1d));</span>
<span class="fc" id="L457">        Assert.assertEquals(1, x2[1], FastMath.ulp(1d));</span>
<span class="fc" id="L458">        Assert.assertEquals(1, x3[1], FastMath.ulp(1d));</span>

<span class="fc" id="L460">        Assert.assertEquals(2, x1[2], FastMath.ulp(1d));</span>
<span class="fc" id="L461">        Assert.assertEquals(4, x2[2], FastMath.ulp(1d));</span>
<span class="fc" id="L462">        Assert.assertEquals(8, x3[2], FastMath.ulp(1d));</span>

<span class="fc" id="L464">        Assert.assertEquals(4,  x1[3], FastMath.ulp(1d));</span>
<span class="fc" id="L465">        Assert.assertEquals(16, x2[3], FastMath.ulp(1d));</span>
<span class="fc" id="L466">        Assert.assertEquals(64, x3[3], FastMath.ulp(1d));</span>

<span class="fc" id="L468">        Assert.assertEquals(5,   x1[4], FastMath.ulp(1d));</span>
<span class="fc" id="L469">        Assert.assertEquals(25,  x2[4], FastMath.ulp(1d));</span>
<span class="fc" id="L470">        Assert.assertEquals(125, x3[4], FastMath.ulp(1d));</span>
<span class="fc" id="L471">    }</span>

    @Test
    public void testSortInPlaceDecresasingOrder() {
<span class="fc" id="L475">        final double[] x1 = {2,   5,  -3, 1,  4};</span>
<span class="fc" id="L476">        final double[] x2 = {4,  25,   9, 1, 16};</span>
<span class="fc" id="L477">        final double[] x3 = {8, 125, -27, 1, 64};</span>

<span class="fc" id="L479">        MathArrays.sortInPlace(x1,</span>
                               MathArrays.OrderDirection.DECREASING,
                               x2, x3);

<span class="fc" id="L483">        Assert.assertEquals(-3,  x1[4], FastMath.ulp(1d));</span>
<span class="fc" id="L484">        Assert.assertEquals(9,   x2[4], FastMath.ulp(1d));</span>
<span class="fc" id="L485">        Assert.assertEquals(-27, x3[4], FastMath.ulp(1d));</span>

<span class="fc" id="L487">        Assert.assertEquals(1, x1[3], FastMath.ulp(1d));</span>
<span class="fc" id="L488">        Assert.assertEquals(1, x2[3], FastMath.ulp(1d));</span>
<span class="fc" id="L489">        Assert.assertEquals(1, x3[3], FastMath.ulp(1d));</span>

<span class="fc" id="L491">        Assert.assertEquals(2, x1[2], FastMath.ulp(1d));</span>
<span class="fc" id="L492">        Assert.assertEquals(4, x2[2], FastMath.ulp(1d));</span>
<span class="fc" id="L493">        Assert.assertEquals(8, x3[2], FastMath.ulp(1d));</span>

<span class="fc" id="L495">        Assert.assertEquals(4,  x1[1], FastMath.ulp(1d));</span>
<span class="fc" id="L496">        Assert.assertEquals(16, x2[1], FastMath.ulp(1d));</span>
<span class="fc" id="L497">        Assert.assertEquals(64, x3[1], FastMath.ulp(1d));</span>

<span class="fc" id="L499">        Assert.assertEquals(5,   x1[0], FastMath.ulp(1d));</span>
<span class="fc" id="L500">        Assert.assertEquals(25,  x2[0], FastMath.ulp(1d));</span>
<span class="fc" id="L501">        Assert.assertEquals(125, x3[0], FastMath.ulp(1d));</span>
<span class="fc" id="L502">    }</span>

    @Test
    /** Example in javadoc */
    public void testSortInPlaceExample() {
<span class="fc" id="L507">        final double[] x = {3, 1, 2};</span>
<span class="fc" id="L508">        final double[] y = {1, 2, 3};</span>
<span class="fc" id="L509">        final double[] z = {0, 5, 7};</span>
<span class="fc" id="L510">        MathArrays.sortInPlace(x, y, z);</span>
<span class="fc" id="L511">        final double[] sx = {1, 2, 3};</span>
<span class="fc" id="L512">        final double[] sy = {2, 3, 1};</span>
<span class="fc" id="L513">        final double[] sz = {5, 7, 0};</span>
<span class="fc" id="L514">        Assert.assertTrue(Arrays.equals(sx, x));</span>
<span class="fc" id="L515">        Assert.assertTrue(Arrays.equals(sy, y));</span>
<span class="fc" id="L516">        Assert.assertTrue(Arrays.equals(sz, z));</span>
<span class="fc" id="L517">    }</span>

    @Test
    public void testSortInPlaceFailures() {
<span class="fc" id="L521">        final double[] nullArray = null;</span>
<span class="fc" id="L522">        final double[] one = {1};</span>
<span class="fc" id="L523">        final double[] two = {1, 2};</span>
<span class="fc" id="L524">        final double[] onep = {2};</span>
        try {
<span class="nc" id="L526">            MathArrays.sortInPlace(one, two);</span>
<span class="nc" id="L527">            Assert.fail(&quot;Expecting DimensionMismatchException&quot;);</span>
<span class="fc" id="L528">        } catch (DimensionMismatchException ex) {</span>
            // expected
<span class="nc" id="L530">        }</span>
        try {
<span class="nc" id="L532">            MathArrays.sortInPlace(one, nullArray);</span>
<span class="nc" id="L533">            Assert.fail(&quot;Expecting NullArgumentException&quot;);</span>
<span class="fc" id="L534">        } catch (NullArgumentException ex) {</span>
            // expected
<span class="nc" id="L536">        }</span>
        try {
<span class="nc" id="L538">            MathArrays.sortInPlace(one, onep, nullArray);</span>
<span class="nc" id="L539">            Assert.fail(&quot;Expecting NullArgumentException&quot;);</span>
<span class="fc" id="L540">        } catch (NullArgumentException ex) {</span>
            // expected
<span class="nc" id="L542">        }</span>
<span class="fc" id="L543">    }</span>

    @Test
    public void testCopyOfInt() {
<span class="fc" id="L547">        final int[] source = { Integer.MIN_VALUE,</span>
                               -1, 0, 1, 3, 113, 4769,
                               Integer.MAX_VALUE };
<span class="fc" id="L550">        final int[] dest = MathArrays.copyOf(source);</span>

<span class="fc" id="L552">        Assert.assertEquals(dest.length, source.length);</span>
<span class="fc bfc" id="L553" title="All 2 branches covered.">        for (int i = 0; i &lt; source.length; i++) {</span>
<span class="fc" id="L554">            Assert.assertEquals(source[i], dest[i]);</span>
        }
<span class="fc" id="L556">    }</span>

    @Test
    public void testCopyOfInt2() {
<span class="fc" id="L560">        final int[] source = { Integer.MIN_VALUE,</span>
                               -1, 0, 1, 3, 113, 4769,
                               Integer.MAX_VALUE };
<span class="fc" id="L563">        final int offset = 3;</span>
<span class="fc" id="L564">        final int[] dest = MathArrays.copyOf(source, source.length - offset);</span>

<span class="fc" id="L566">        Assert.assertEquals(dest.length, source.length - offset);</span>
<span class="fc bfc" id="L567" title="All 2 branches covered.">        for (int i = 0; i &lt; source.length - offset; i++) {</span>
<span class="fc" id="L568">            Assert.assertEquals(source[i], dest[i]);</span>
        }
<span class="fc" id="L570">    }</span>

    @Test
    public void testCopyOfInt3() {
<span class="fc" id="L574">        final int[] source = { Integer.MIN_VALUE,</span>
                               -1, 0, 1, 3, 113, 4769,
                               Integer.MAX_VALUE };
<span class="fc" id="L577">        final int offset = 3;</span>
<span class="fc" id="L578">        final int[] dest = MathArrays.copyOf(source, source.length + offset);</span>

<span class="fc" id="L580">        Assert.assertEquals(dest.length, source.length + offset);</span>
<span class="fc bfc" id="L581" title="All 2 branches covered.">        for (int i = 0; i &lt; source.length; i++) {</span>
<span class="fc" id="L582">            Assert.assertEquals(source[i], dest[i]);</span>
        }
<span class="fc bfc" id="L584" title="All 2 branches covered.">        for (int i = source.length; i &lt; source.length + offset; i++) {</span>
<span class="fc" id="L585">            Assert.assertEquals(0, dest[i], 0);</span>
        }
<span class="fc" id="L587">    }</span>

    @Test
    public void testCopyOfDouble() {
<span class="fc" id="L591">        final double[] source = { Double.NEGATIVE_INFINITY,</span>
                                  -Double.MAX_VALUE,
                                  -1, 0,
                                  Double.MIN_VALUE,
<span class="fc" id="L595">                                  FastMath.ulp(1d),</span>
                                  1, 3, 113, 4769,
                                  Double.MAX_VALUE,
                                  Double.POSITIVE_INFINITY };
<span class="fc" id="L599">        final double[] dest = MathArrays.copyOf(source);</span>

<span class="fc" id="L601">        Assert.assertEquals(dest.length, source.length);</span>
<span class="fc bfc" id="L602" title="All 2 branches covered.">        for (int i = 0; i &lt; source.length; i++) {</span>
<span class="fc" id="L603">            Assert.assertEquals(source[i], dest[i], 0);</span>
        }
<span class="fc" id="L605">    }</span>

    @Test
    public void testCopyOfDouble2() {
<span class="fc" id="L609">        final double[] source = { Double.NEGATIVE_INFINITY,</span>
                                  -Double.MAX_VALUE,
                                  -1, 0,
                                  Double.MIN_VALUE,
<span class="fc" id="L613">                                  FastMath.ulp(1d),</span>
                                  1, 3, 113, 4769,
                                  Double.MAX_VALUE,
                                  Double.POSITIVE_INFINITY };
<span class="fc" id="L617">        final int offset = 3;</span>
<span class="fc" id="L618">        final double[] dest = MathArrays.copyOf(source, source.length - offset);</span>

<span class="fc" id="L620">        Assert.assertEquals(dest.length, source.length - offset);</span>
<span class="fc bfc" id="L621" title="All 2 branches covered.">        for (int i = 0; i &lt; source.length - offset; i++) {</span>
<span class="fc" id="L622">            Assert.assertEquals(source[i], dest[i], 0);</span>
        }
<span class="fc" id="L624">    }</span>

    @Test
    public void testCopyOfDouble3() {
<span class="fc" id="L628">        final double[] source = { Double.NEGATIVE_INFINITY,</span>
                                  -Double.MAX_VALUE,
                                  -1, 0,
                                  Double.MIN_VALUE,
<span class="fc" id="L632">                                  FastMath.ulp(1d),</span>
                                  1, 3, 113, 4769,
                                  Double.MAX_VALUE,
                                  Double.POSITIVE_INFINITY };
<span class="fc" id="L636">        final int offset = 3;</span>
<span class="fc" id="L637">        final double[] dest = MathArrays.copyOf(source, source.length + offset);</span>

<span class="fc" id="L639">        Assert.assertEquals(dest.length, source.length + offset);</span>
<span class="fc bfc" id="L640" title="All 2 branches covered.">        for (int i = 0; i &lt; source.length; i++) {</span>
<span class="fc" id="L641">            Assert.assertEquals(source[i], dest[i], 0);</span>
        }
<span class="fc bfc" id="L643" title="All 2 branches covered.">        for (int i = source.length; i &lt; source.length + offset; i++) {</span>
<span class="fc" id="L644">            Assert.assertEquals(0, dest[i], 0);</span>
        }
<span class="fc" id="L646">    }</span>

    @Test
    public void testCopyOfRange() {
<span class="fc" id="L650">        final double[] source = { Double.NEGATIVE_INFINITY,</span>
                                  -Double.MAX_VALUE,
                                  -1, 0,
                                  Double.MIN_VALUE,
<span class="fc" id="L654">                                  FastMath.ulp(1d),</span>
                                  1, 3, 113, 4769,
                                  Double.MAX_VALUE,
                                  Double.POSITIVE_INFINITY };
<span class="fc" id="L658">        final int from = 3;</span>
<span class="fc" id="L659">        final int to = source.length + 14;</span>
<span class="fc" id="L660">        final double[] dest = MathArrays.copyOfRange(source, from, to);</span>

<span class="fc" id="L662">        Assert.assertEquals(dest.length, to - from);</span>
<span class="fc bfc" id="L663" title="All 2 branches covered.">        for (int i = from; i &lt; source.length; i++) {</span>
<span class="fc" id="L664">            Assert.assertEquals(source[i], dest[i - from], 0);</span>
        }
<span class="fc bfc" id="L666" title="All 2 branches covered.">        for (int i = source.length; i &lt; dest.length; i++) {</span>
<span class="fc" id="L667">            Assert.assertEquals(0, dest[i - from], 0);</span>
        }
<span class="fc" id="L669">    }</span>

    @Test
    public void testArrayEquals() {
<span class="fc" id="L673">        Assert.assertFalse(MathArrays.equals(new double[] { 1d }, null));</span>
<span class="fc" id="L674">        Assert.assertFalse(MathArrays.equals(null, new double[] { 1d }));</span>
<span class="fc" id="L675">        Assert.assertTrue(MathArrays.equals((double[]) null, (double[]) null));</span>

<span class="fc" id="L677">        Assert.assertFalse(MathArrays.equals(new double[] { 1d }, new double[0]));</span>
<span class="fc" id="L678">        Assert.assertTrue(MathArrays.equals(new double[] { 1d }, new double[] { 1d }));</span>
<span class="fc" id="L679">        Assert.assertTrue(MathArrays.equals(new double[] { Double.POSITIVE_INFINITY,</span>
                                                           Double.NEGATIVE_INFINITY, 1d, 0d },
                                            new double[] { Double.POSITIVE_INFINITY,
                                                           Double.NEGATIVE_INFINITY, 1d, 0d }));
<span class="fc" id="L683">        Assert.assertFalse(MathArrays.equals(new double[] { Double.NaN },</span>
                                             new double[] { Double.NaN }));
<span class="fc" id="L685">        Assert.assertFalse(MathArrays.equals(new double[] { Double.POSITIVE_INFINITY },</span>
                                             new double[] { Double.NEGATIVE_INFINITY }));
<span class="fc" id="L687">        Assert.assertFalse(MathArrays.equals(new double[] { 1d },</span>
<span class="fc" id="L688">                                             new double[] { FastMath.nextAfter(FastMath.nextAfter(1d, 2d), 2d) }));</span>

<span class="fc" id="L690">    }</span>

    @Test
    public void testArrayEqualsIncludingNaN() {
<span class="fc" id="L694">        Assert.assertFalse(MathArrays.equalsIncludingNaN(new double[] { 1d }, null));</span>
<span class="fc" id="L695">        Assert.assertFalse(MathArrays.equalsIncludingNaN(null, new double[] { 1d }));</span>
<span class="fc" id="L696">        Assert.assertTrue(MathArrays.equalsIncludingNaN((double[]) null, (double[]) null));</span>

<span class="fc" id="L698">        Assert.assertFalse(MathArrays.equalsIncludingNaN(new double[] { 1d }, new double[0]));</span>
<span class="fc" id="L699">        Assert.assertTrue(MathArrays.equalsIncludingNaN(new double[] { 1d }, new double[] { 1d }));</span>
<span class="fc" id="L700">        Assert.assertTrue(MathArrays.equalsIncludingNaN(new double[] { Double.NaN, Double.POSITIVE_INFINITY,</span>
                                                                       Double.NEGATIVE_INFINITY, 1d, 0d },
                                                        new double[] { Double.NaN, Double.POSITIVE_INFINITY,
                                                                       Double.NEGATIVE_INFINITY, 1d, 0d }));
<span class="fc" id="L704">        Assert.assertFalse(MathArrays.equalsIncludingNaN(new double[] { Double.POSITIVE_INFINITY },</span>
                                                         new double[] { Double.NEGATIVE_INFINITY }));
<span class="fc" id="L706">        Assert.assertFalse(MathArrays.equalsIncludingNaN(new double[] { 1d },</span>
<span class="fc" id="L707">                                                         new double[] { FastMath.nextAfter(FastMath.nextAfter(1d, 2d), 2d) }));</span>
<span class="fc" id="L708">    }</span>

    @Test
    public void testNormalizeArray() {
<span class="fc" id="L712">        double[] testValues1 = new double[] {1, 1, 2};</span>
<span class="fc" id="L713">        TestUtils.assertEquals( new double[] {.25, .25, .5},</span>
<span class="fc" id="L714">                                MathArrays.normalizeArray(testValues1, 1),</span>
                                Double.MIN_VALUE);

<span class="fc" id="L717">        double[] testValues2 = new double[] {-1, -1, 1};</span>
<span class="fc" id="L718">        TestUtils.assertEquals( new double[] {1, 1, -1},</span>
<span class="fc" id="L719">                                MathArrays.normalizeArray(testValues2, 1),</span>
                                Double.MIN_VALUE);

        // Ignore NaNs
<span class="fc" id="L723">        double[] testValues3 = new double[] {-1, -1, Double.NaN, 1, Double.NaN};</span>
<span class="fc" id="L724">        TestUtils.assertEquals( new double[] {1, 1,Double.NaN, -1, Double.NaN},</span>
<span class="fc" id="L725">                                MathArrays.normalizeArray(testValues3, 1),</span>
                                Double.MIN_VALUE);

        // Zero sum -&gt; MathArithmeticException
<span class="fc" id="L729">        double[] zeroSum = new double[] {-1, 1};</span>
        try {
<span class="nc" id="L731">            MathArrays.normalizeArray(zeroSum, 1);</span>
<span class="nc" id="L732">            Assert.fail(&quot;expecting MathArithmeticException&quot;);</span>
<span class="pc" id="L733">        } catch (MathArithmeticException ex) {}</span>

        // Infinite elements -&gt; MathArithmeticException
<span class="fc" id="L736">        double[] hasInf = new double[] {1, 2, 1, Double.NEGATIVE_INFINITY};</span>
        try {
<span class="nc" id="L738">            MathArrays.normalizeArray(hasInf, 1);</span>
<span class="nc" id="L739">            Assert.fail(&quot;expecting MathIllegalArgumentException&quot;);</span>
<span class="pc" id="L740">        } catch (MathIllegalArgumentException ex) {}</span>

        // Infinite target -&gt; MathIllegalArgumentException
        try {
<span class="nc" id="L744">            MathArrays.normalizeArray(testValues1, Double.POSITIVE_INFINITY);</span>
<span class="nc" id="L745">            Assert.fail(&quot;expecting MathIllegalArgumentException&quot;);</span>
<span class="pc" id="L746">        } catch (MathIllegalArgumentException ex) {}</span>

        // NaN target -&gt; MathIllegalArgumentException
        try {
<span class="nc" id="L750">            MathArrays.normalizeArray(testValues1, Double.NaN);</span>
<span class="nc" id="L751">            Assert.fail(&quot;expecting MathIllegalArgumentException&quot;);</span>
<span class="pc" id="L752">        } catch (MathIllegalArgumentException ex) {}</span>
<span class="fc" id="L753">    }</span>

    @Test
    public void testConvolve() {
        /* Test Case (obtained via SciPy)
         * x=[1.2,-1.8,1.4]
         * h=[1,0.8,0.5,0.3]
         * convolve(x,h) -&gt; array([ 1.2 , -0.84,  0.56,  0.58,  0.16,  0.42])
         */
<span class="fc" id="L762">        double[] x1 = { 1.2, -1.8, 1.4 };</span>
<span class="fc" id="L763">        double[] h1 = { 1, 0.8, 0.5, 0.3 };</span>
<span class="fc" id="L764">        double[] y1 = { 1.2, -0.84, 0.56, 0.58, 0.16, 0.42 };</span>
<span class="fc" id="L765">        double tolerance = 1e-13;</span>

<span class="fc" id="L767">        double[] yActual = MathArrays.convolve(x1, h1);</span>
<span class="fc" id="L768">        Assert.assertArrayEquals(y1, yActual, tolerance);</span>

<span class="fc" id="L770">        double[] x2 = { 1, 2, 3 };</span>
<span class="fc" id="L771">        double[] h2 = { 0, 1, 0.5 };</span>
<span class="fc" id="L772">        double[] y2 = { 0, 1, 2.5, 4, 1.5 };</span>

<span class="fc" id="L774">        yActual = MathArrays.convolve(x2, h2);</span>
<span class="fc" id="L775">        Assert.assertArrayEquals(y2, yActual, tolerance);</span>

        try {
<span class="nc" id="L778">            MathArrays.convolve(new double[]{1, 2}, null);</span>
<span class="nc" id="L779">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L780">        } catch (NullArgumentException e) {</span>
            // expected behavior
<span class="nc" id="L782">        }</span>

        try {
<span class="nc" id="L785">            MathArrays.convolve(null, new double[]{1, 2});</span>
<span class="nc" id="L786">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L787">        } catch (NullArgumentException e) {</span>
            // expected behavior
<span class="nc" id="L789">        }</span>

        try {
<span class="nc" id="L792">            MathArrays.convolve(new double[]{1, 2}, new double[]{});</span>
<span class="nc" id="L793">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L794">        } catch (NoDataException e) {</span>
            // expected behavior
<span class="nc" id="L796">        }</span>

        try {
<span class="nc" id="L799">            MathArrays.convolve(new double[]{}, new double[]{1, 2});</span>
<span class="nc" id="L800">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L801">        } catch (NoDataException e) {</span>
            // expected behavior
<span class="nc" id="L803">        }</span>

        try {
<span class="nc" id="L806">            MathArrays.convolve(new double[]{}, new double[]{});</span>
<span class="nc" id="L807">            Assert.fail(&quot;an exception should have been thrown&quot;);</span>
<span class="fc" id="L808">        } catch (NoDataException e) {</span>
            // expected behavior
<span class="nc" id="L810">        }</span>
<span class="fc" id="L811">    }</span>

    @Test
    public void testNatural() {
<span class="fc" id="L815">        final int n = 4;</span>
<span class="fc" id="L816">        final int[] expected = {0, 1, 2, 3};</span>

<span class="fc" id="L818">        final int[] natural = MathArrays.natural(n);</span>
<span class="fc bfc" id="L819" title="All 2 branches covered.">        for (int i = 0; i &lt; n; i++) {</span>
<span class="fc" id="L820">            Assert.assertEquals(expected[i], natural[i]);</span>
        }
<span class="fc" id="L822">    }</span>

    @Test
    public void testNaturalZero() {
<span class="fc" id="L826">        final int[] natural = MathArrays.natural(0);</span>
<span class="fc" id="L827">        Assert.assertEquals(0, natural.length);</span>
<span class="fc" id="L828">    }</span>

    @Test
    public void testSequence() {
<span class="fc" id="L832">        final int size = 4;</span>
<span class="fc" id="L833">        final int start = 5;</span>
<span class="fc" id="L834">        final int stride = 2;</span>
<span class="fc" id="L835">        final int[] expected = {5, 7, 9, 11};</span>

<span class="fc" id="L837">        final int[] seq = MathArrays.sequence(size, start, stride);</span>
<span class="fc bfc" id="L838" title="All 2 branches covered.">        for (int i = 0; i &lt; size; i++) {</span>
<span class="fc" id="L839">            Assert.assertEquals(expected[i], seq[i]);</span>
        }
<span class="fc" id="L841">    }</span>

    @Test
    public void testSequenceZero() {
<span class="fc" id="L845">        final int[] seq = MathArrays.sequence(0, 12345, 6789);</span>
<span class="fc" id="L846">        Assert.assertEquals(0, seq.length);</span>
<span class="fc" id="L847">    }</span>

    @Test
    public void testVerifyValuesPositive() {
<span class="fc bfc" id="L851" title="All 2 branches covered.">        for (int j = 0; j &lt; 6; j++) {</span>
<span class="fc bfc" id="L852" title="All 2 branches covered.">            for (int i = 1; i &lt; (7 - j); i++) {</span>
<span class="fc" id="L853">                Assert.assertTrue(MathArrays.verifyValues(testArray, 0, i));</span>
            }
        }
<span class="fc" id="L856">        Assert.assertTrue(MathArrays.verifyValues(singletonArray, 0, 1));</span>
<span class="fc" id="L857">        Assert.assertTrue(MathArrays.verifyValues(singletonArray, 0, 0, true));</span>
<span class="fc" id="L858">    }</span>

    @Test
    public void testVerifyValuesNegative() {
<span class="fc" id="L862">        Assert.assertFalse(MathArrays.verifyValues(singletonArray, 0, 0));</span>
<span class="fc" id="L863">        Assert.assertFalse(MathArrays.verifyValues(testArray, 0, 0));</span>
        try {
<span class="nc" id="L865">            MathArrays.verifyValues(singletonArray, 2, 1);  // start past end</span>
<span class="nc" id="L866">            Assert.fail(&quot;Expecting MathIllegalArgumentException&quot;);</span>
<span class="fc" id="L867">        } catch (MathIllegalArgumentException ex) {</span>
            // expected
<span class="nc" id="L869">        }</span>
        try {
<span class="nc" id="L871">            MathArrays.verifyValues(testArray, 0, 7);  // end past end</span>
<span class="nc" id="L872">            Assert.fail(&quot;Expecting MathIllegalArgumentException&quot;);</span>
<span class="fc" id="L873">        } catch (MathIllegalArgumentException ex) {</span>
            // expected
<span class="nc" id="L875">        }</span>
        try {
<span class="nc" id="L877">            MathArrays.verifyValues(testArray, -1, 1);  // start negative</span>
<span class="nc" id="L878">            Assert.fail(&quot;Expecting MathIllegalArgumentException&quot;);</span>
<span class="fc" id="L879">        } catch (MathIllegalArgumentException ex) {</span>
            // expected
<span class="nc" id="L881">        }</span>
        try {
<span class="nc" id="L883">            MathArrays.verifyValues(testArray, 0, -1);  // length negative</span>
<span class="nc" id="L884">            Assert.fail(&quot;Expecting MathIllegalArgumentException&quot;);</span>
<span class="fc" id="L885">        } catch (MathIllegalArgumentException ex) {</span>
            // expected
<span class="nc" id="L887">        }</span>
        try {
<span class="nc" id="L889">            MathArrays.verifyValues(nullArray, 0, 1);  // null array</span>
<span class="nc" id="L890">            Assert.fail(&quot;Expecting NullArgumentException&quot;);</span>
<span class="fc" id="L891">        } catch (NullArgumentException ex) {</span>
            // expected
<span class="nc" id="L893">        }</span>
        try {
<span class="nc" id="L895">            MathArrays.verifyValues(testArray, nullArray, 0, 1);  // null weights array</span>
<span class="nc" id="L896">            Assert.fail(&quot;Expecting NullArgumentException&quot;);</span>
<span class="fc" id="L897">        } catch (NullArgumentException ex) {</span>
            // expected
<span class="nc" id="L899">        }</span>
        try {
<span class="nc" id="L901">            MathArrays.verifyValues(singletonArray, testWeightsArray, 0, 1);  // weights.length != value.length</span>
<span class="nc" id="L902">            Assert.fail(&quot;Expecting MathIllegalArgumentException&quot;);</span>
<span class="fc" id="L903">        } catch (MathIllegalArgumentException ex) {</span>
            // expected
<span class="nc" id="L905">        }</span>
        try {
<span class="nc" id="L907">            MathArrays.verifyValues(testArray, testNegativeWeightsArray, 0, 6);  // can't have negative weights</span>
<span class="nc" id="L908">            Assert.fail(&quot;Expecting MathIllegalArgumentException&quot;);</span>
<span class="fc" id="L909">        } catch (MathIllegalArgumentException ex) {</span>
            // expected
<span class="nc" id="L911">        }</span>
<span class="fc" id="L912">    }</span>

    @Test
    public void testConcatenate() {
<span class="fc" id="L916">        final double[] u = new double[] {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};</span>
<span class="fc" id="L917">        final double[] x = new double[] {0, 1, 2};</span>
<span class="fc" id="L918">        final double[] y = new double[] {3, 4, 5, 6, 7, 8};</span>
<span class="fc" id="L919">        final double[] z = new double[] {9};</span>
<span class="fc" id="L920">        Assert.assertArrayEquals(u, MathArrays.concatenate(x, y, z), 0);</span>
<span class="fc" id="L921">    }</span>

    @Test
    public void testConcatentateSingle() {
<span class="fc" id="L925">        final double[] x = new double[] {0, 1, 2};</span>
<span class="fc" id="L926">        Assert.assertArrayEquals(x, MathArrays.concatenate(x), 0);</span>
<span class="fc" id="L927">    }</span>

    public void testConcatenateEmptyArguments() {
<span class="nc" id="L930">        final double[] x = new double[] {0, 1, 2};</span>
<span class="nc" id="L931">        final double[] y = new double[] {3};</span>
<span class="nc" id="L932">        final double[] z = new double[] {};</span>
<span class="nc" id="L933">        final double[] u = new double[] {0, 1, 2, 3};</span>
<span class="nc" id="L934">        Assert.assertArrayEquals(u,  MathArrays.concatenate(x, z, y), 0);</span>
<span class="nc" id="L935">        Assert.assertArrayEquals(u,  MathArrays.concatenate(x, y, z), 0);</span>
<span class="nc" id="L936">        Assert.assertArrayEquals(u,  MathArrays.concatenate(z, x, y), 0);</span>
<span class="nc" id="L937">        Assert.assertEquals(0,  MathArrays.concatenate(z, z, z).length);</span>
<span class="nc" id="L938">    }</span>

    @Test(expected=NullPointerException.class)
    public void testConcatenateNullArguments() {
<span class="fc" id="L942">        final double[] x = new double[] {0, 1, 2};</span>
<span class="nc" id="L943">        MathArrays.concatenate(x, null);</span>
<span class="nc" id="L944">    }</span>

    @Test
    public void testUnique() {
<span class="fc" id="L948">        final double[] x = {0, 9, 3, 0, 11, 7, 3, 5, -1, -2};</span>
<span class="fc" id="L949">        final double[] values = {11, 9, 7, 5, 3, 0, -1, -2};</span>
<span class="fc" id="L950">        Assert.assertArrayEquals(values, MathArrays.unique(x), 0);</span>
<span class="fc" id="L951">    }</span>

    @Test
    public void testUniqueInfiniteValues() {
<span class="fc" id="L955">        final double [] x = {0, Double.NEGATIVE_INFINITY, 3, Double.NEGATIVE_INFINITY,</span>
            3, Double.POSITIVE_INFINITY, Double.POSITIVE_INFINITY};
<span class="fc" id="L957">        final double[] u = {Double.POSITIVE_INFINITY, 3, 0, Double.NEGATIVE_INFINITY};</span>
<span class="fc" id="L958">        Assert.assertArrayEquals(u , MathArrays.unique(x), 0);</span>
<span class="fc" id="L959">    }</span>

    @Test
    public void testUniqueNaNValues() {
<span class="fc" id="L963">        final double[] x = new double[] {10, 2, Double.NaN, Double.NaN, Double.NaN,</span>
            Double.POSITIVE_INFINITY, Double.POSITIVE_INFINITY, Double.NEGATIVE_INFINITY};
<span class="fc" id="L965">        final double[] u = MathArrays.unique(x);</span>
<span class="fc" id="L966">        Assert.assertEquals(5, u.length);</span>
<span class="fc" id="L967">        Assert.assertTrue(Double.isNaN(u[0]));</span>
<span class="fc" id="L968">        Assert.assertEquals(Double.POSITIVE_INFINITY, u[1], 0);</span>
<span class="fc" id="L969">        Assert.assertEquals(10, u[2], 0);</span>
<span class="fc" id="L970">        Assert.assertEquals(2, u[3], 0);</span>
<span class="fc" id="L971">        Assert.assertEquals(Double.NEGATIVE_INFINITY, u[4], 0);</span>
<span class="fc" id="L972">    }</span>

    @Test(expected=NullPointerException.class)
    public void testUniqueNullArgument() {
<span class="nc" id="L976">        MathArrays.unique(null);</span>
<span class="nc" id="L977">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>