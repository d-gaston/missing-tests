<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MultidimensionalCounterTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_math4$All_in_commons_math4.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.math4.util</a> &gt; <span class="el_source">MultidimensionalCounterTest.java</span></div><h1>MultidimensionalCounterTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.commons.math4.util;

import java.util.NoSuchElementException;

import org.apache.commons.math4.exception.DimensionMismatchException;
import org.apache.commons.math4.exception.NotStrictlyPositiveException;
import org.apache.commons.math4.exception.OutOfRangeException;
import org.apache.commons.math4.util.MultidimensionalCounter;
import org.junit.Assert;
import org.junit.Test;

/**
 * Test cases for the {@link MultidimensionalCounter} class.
 *
 */
<span class="fc" id="L33">public class MultidimensionalCounterTest {</span>
    @Test
    public void testPreconditions() {
        MultidimensionalCounter c;

        try {
<span class="nc" id="L39">            c = new MultidimensionalCounter(0, 1);</span>
<span class="nc" id="L40">            Assert.fail(&quot;NotStrictlyPositiveException expected&quot;);</span>
<span class="fc" id="L41">        } catch (NotStrictlyPositiveException e) {</span>
            // Expected.
<span class="nc" id="L43">        }</span>
        try {
<span class="nc" id="L45">            c = new MultidimensionalCounter(2, 0);</span>
<span class="nc" id="L46">            Assert.fail(&quot;NotStrictlyPositiveException expected&quot;);</span>
<span class="fc" id="L47">        } catch (NotStrictlyPositiveException e) {</span>
            // Expected.
<span class="nc" id="L49">        }</span>
        try {
<span class="nc" id="L51">            c = new MultidimensionalCounter(-1, 1);</span>
<span class="nc" id="L52">            Assert.fail(&quot;NotStrictlyPositiveException expected&quot;);</span>
<span class="fc" id="L53">        } catch (NotStrictlyPositiveException e) {</span>
            // Expected.
<span class="nc" id="L55">        }</span>

<span class="fc" id="L57">        c = new MultidimensionalCounter(2, 3);</span>
        try {
<span class="nc" id="L59">            c.getCount(1, 1, 1);</span>
<span class="nc" id="L60">            Assert.fail(&quot;DimensionMismatchException expected&quot;);</span>
<span class="fc" id="L61">        } catch (DimensionMismatchException e) {</span>
            // Expected.
<span class="nc" id="L63">        }</span>
        try {
<span class="nc" id="L65">            c.getCount(3, 1);</span>
<span class="nc" id="L66">            Assert.fail(&quot;OutOfRangeException expected&quot;);</span>
<span class="fc" id="L67">        } catch (OutOfRangeException e) {</span>
            // Expected.
<span class="nc" id="L69">        }</span>
        try {
<span class="nc" id="L71">            c.getCount(0, -1);</span>
<span class="nc" id="L72">            Assert.fail(&quot;OutOfRangeException expected&quot;);</span>
<span class="fc" id="L73">        } catch (OutOfRangeException e) {</span>
            // Expected.
<span class="nc" id="L75">        }</span>
        try {
<span class="nc" id="L77">            c.getCounts(-1);</span>
<span class="nc" id="L78">            Assert.fail(&quot;OutOfRangeException expected&quot;);</span>
<span class="fc" id="L79">        } catch (OutOfRangeException e) {</span>
            // Expected.
<span class="nc" id="L81">        }</span>
        try {
<span class="nc" id="L83">            c.getCounts(6);</span>
<span class="nc" id="L84">            Assert.fail(&quot;OutOfRangeException expected&quot;);</span>
<span class="fc" id="L85">        } catch (OutOfRangeException e) {</span>
            // Expected.
<span class="nc" id="L87">        }</span>
<span class="fc" id="L88">    }</span>

    @Test
    public void testIteratorPreconditions() {
<span class="fc" id="L92">        MultidimensionalCounter.Iterator iter = (new MultidimensionalCounter(2, 3)).iterator();</span>
        try {
<span class="nc" id="L94">            iter.getCount(-1);</span>
<span class="nc" id="L95">            Assert.fail(&quot;IndexOutOfBoundsException expected&quot;);</span>
<span class="fc" id="L96">        } catch (IndexOutOfBoundsException e) {</span>
            // Expected.
<span class="nc" id="L98">        }</span>
        try {
<span class="nc" id="L100">            iter.getCount(2);</span>
<span class="nc" id="L101">            Assert.fail(&quot;IndexOutOfBoundsException expected&quot;);</span>
<span class="fc" id="L102">        } catch (IndexOutOfBoundsException e) {</span>
            // Expected.
<span class="nc" id="L104">        }</span>
<span class="fc" id="L105">    }</span>

    @Test
    public void testIterator() {
<span class="fc" id="L109">        final int dim1 = 3;</span>
<span class="fc" id="L110">        final int dim2 = 4;</span>

<span class="fc" id="L112">        final MultidimensionalCounter.Iterator iter</span>
<span class="fc" id="L113">            = new MultidimensionalCounter(dim1, dim2).iterator();</span>

<span class="fc" id="L115">        final int max = dim1 * dim2;</span>
<span class="fc bfc" id="L116" title="All 2 branches covered.">        for (int i = 0; i &lt; max; i++) {</span>
<span class="fc" id="L117">            Assert.assertTrue(iter.hasNext());</span>

            // Should not throw.
<span class="fc" id="L120">            iter.next();</span>
        }

<span class="fc" id="L123">        Assert.assertFalse(iter.hasNext());</span>
<span class="fc" id="L124">    }</span>

    @Test(expected=NoSuchElementException.class)
    public void testIteratorNoMoreElements() {
<span class="fc" id="L128">        final MultidimensionalCounter.Iterator iter</span>
<span class="fc" id="L129">            = new MultidimensionalCounter(4, 2).iterator();</span>

<span class="pc bpc" id="L131" title="1 of 2 branches missed.">        while (iter.hasNext()) {</span>
<span class="fc" id="L132">            iter.next();</span>
        }

        // No more elements: should throw.
<span class="nc" id="L136">        iter.next();</span>
<span class="nc" id="L137">    }</span>

    @Test
    public void testMulti2UniConversion() {
<span class="fc" id="L141">        final MultidimensionalCounter c = new MultidimensionalCounter(2, 4, 5);</span>
<span class="fc" id="L142">        Assert.assertEquals(c.getCount(1, 2, 3), 33);</span>
<span class="fc" id="L143">    }</span>

    @Test
    public void testAccessors() {
<span class="fc" id="L147">        final int[] originalSize = new int[] {2, 6, 5};</span>
<span class="fc" id="L148">        final MultidimensionalCounter c = new MultidimensionalCounter(originalSize);</span>
<span class="fc" id="L149">        final int nDim = c.getDimension();</span>
<span class="fc" id="L150">        Assert.assertEquals(nDim, originalSize.length);</span>

<span class="fc" id="L152">        final int[] size = c.getSizes();</span>
<span class="fc bfc" id="L153" title="All 2 branches covered.">        for (int i = 0; i &lt; nDim; i++) {</span>
<span class="fc" id="L154">            Assert.assertEquals(originalSize[i], size[i]);</span>
        }
<span class="fc" id="L156">    }</span>

    @Test
    public void testIterationConsistency() {
<span class="fc" id="L160">        final MultidimensionalCounter c = new MultidimensionalCounter(2, 3, 4);</span>
<span class="fc" id="L161">        final int[][] expected = new int[][] {</span>
            { 0, 0, 0 },
            { 0, 0, 1 },
            { 0, 0, 2 },
            { 0, 0, 3 },
            { 0, 1, 0 },
            { 0, 1, 1 },
            { 0, 1, 2 },
            { 0, 1, 3 },
            { 0, 2, 0 },
            { 0, 2, 1 },
            { 0, 2, 2 },
            { 0, 2, 3 },
            { 1, 0, 0 },
            { 1, 0, 1 },
            { 1, 0, 2 },
            { 1, 0, 3 },
            { 1, 1, 0 },
            { 1, 1, 1 },
            { 1, 1, 2 },
            { 1, 1, 3 },
            { 1, 2, 0 },
            { 1, 2, 1 },
            { 1, 2, 2 },
            { 1, 2, 3 }
        };

<span class="fc" id="L188">        final int totalSize = c.getSize();</span>
<span class="fc" id="L189">        Assert.assertEquals(expected.length, totalSize);</span>

<span class="fc" id="L191">        final int nDim = c.getDimension();</span>
<span class="fc" id="L192">        final MultidimensionalCounter.Iterator iter = c.iterator();</span>
<span class="fc bfc" id="L193" title="All 2 branches covered.">        for (int i = 0; i &lt; totalSize; i++) {</span>
<span class="pc bpc" id="L194" title="1 of 2 branches missed.">            if (!iter.hasNext()) {</span>
<span class="nc" id="L195">                Assert.fail(&quot;Too short&quot;);</span>
            }
<span class="fc" id="L197">            final int uniDimIndex = iter.next().intValue();</span>
<span class="fc" id="L198">            Assert.assertEquals(&quot;Wrong iteration at &quot; + i, i, uniDimIndex);</span>

<span class="fc bfc" id="L200" title="All 2 branches covered.">            for (int dimIndex = 0; dimIndex &lt; nDim; dimIndex++) {</span>
<span class="fc" id="L201">                Assert.assertEquals(&quot;Wrong multidimensional index for [&quot; + i + &quot;][&quot; + dimIndex + &quot;]&quot;,</span>
<span class="fc" id="L202">                                    expected[i][dimIndex], iter.getCount(dimIndex));</span>
            }

<span class="fc" id="L205">            Assert.assertEquals(&quot;Wrong unidimensional index for [&quot; + i + &quot;]&quot;,</span>
<span class="fc" id="L206">                                c.getCount(expected[i]), uniDimIndex);</span>

<span class="fc" id="L208">            final int[] indices = c.getCounts(uniDimIndex);</span>
<span class="fc bfc" id="L209" title="All 2 branches covered.">            for (int dimIndex = 0; dimIndex &lt; nDim; dimIndex++) {</span>
<span class="fc" id="L210">                Assert.assertEquals(&quot;Wrong multidimensional index for [&quot; + i + &quot;][&quot; + dimIndex + &quot;]&quot;,</span>
                                    expected[i][dimIndex], indices[dimIndex]);
            }
        }

<span class="pc bpc" id="L215" title="1 of 2 branches missed.">        if (iter.hasNext()) {</span>
<span class="nc" id="L216">            Assert.fail(&quot;Too long&quot;);</span>
        }
<span class="fc" id="L218">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.1.201803210924</span></div></body></html>